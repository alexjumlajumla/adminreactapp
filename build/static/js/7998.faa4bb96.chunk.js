"use strict";(self.webpackChunkjumlajumla_dashboard=self.webpackChunkjumlajumla_dashboard||[]).push([[7998],{12158:(e,l,s)=>{s.d(l,{A:()=>d});var i=s(59051),n=s.n(i),a=s(70030);function d(e){const{t:l}=(0,a.B)();let s=n()(),i=n()(e),d=s.diff(i,"hours"),t=s.diff(i,"minutes");return d>23?n()(e).format("Do MMM, H:mm"):d>0?d+" "+l("hours.ago"):t+" "+l("minutes.ago")}},29597:(e,l,s)=>{s.d(l,{A:()=>i});s(63620);function i(e){if(null===e||void 0===e||!e.location)return{lat:47.4143302506288,lng:8.532059477976883};const l=e.location.split(", ");return{lat:Number(null===l||void 0===l?void 0:l[0]),lng:Number(null===l||void 0===l?void 0:l[1])}}},73737:(e,l,s)=>{s.d(l,{A:()=>t});s(9950);var i=s(12403),n=s(91854),a=s(63620),d=s(44414);function t(e){let{center:l,handleLoadMap:s,children:t}=e;const{google_map_key:o}=(0,n.d4)((e=>e.globalSettings.settings),n.bN);return(0,d.jsx)(i.Ay,{bootstrapURLKeys:{key:o||a.CJ},defaultZoom:12,center:l,options:{fullscreenControl:!1},yesIWantToUseGoogleMapApiInternals:!0,onGoogleApiLoaded:e=>{let{map:l,maps:i}=e;return s(l,i)},children:t})}},77998:(e,l,s)=>{s.r(l),s.d(l,{default:()=>E});var i=s(9950),n=s(14936),a=s(23263),d=s(99674),t=s(87094),o=s(41988),r=s(70030),v=s(91854),u=s(29597),c=s(63620),m=s(76372),h=s(74623),x=s(81446),j=s(88986),g=s(94118),p=s(29633),y=s(89627),_=s(12158),A=s(44414);const b=e=>{var l;let{data:s,handleClose:i}=e;const{t:a}=(0,r.B)(),d=(0,_.A)(null===s||void 0===s||null===(l=s.delivery_man_setting)||void 0===l?void 0:l.updated_at),v=null===s||void 0===s?void 0:s.assign_reviews_avg_rating,u=null===s||void 0===s?void 0:s.phone,m=null===s||void 0===s?void 0:s.delivery_man_orders_count,h=null===s||void 0===s?void 0:s.delivery_man_orders_sum_total_price;return(0,A.jsxs)(t.A,{gutter:12,align:"middle",children:[(0,A.jsx)(o.A,{span:7,children:(0,A.jsxs)("div",{className:"d-flex align-items-center",children:[(0,A.jsx)(n.A,{src:c.sE+(null===s||void 0===s?void 0:s.img)}),(0,A.jsxs)("div",{className:"ml-2",children:[(0,A.jsx)("div",{className:"title",children:(null===s||void 0===s?void 0:s.firstname)+" "+(null===s||void 0===s?void 0:s.lastname)}),(0,A.jsx)(p.A,{disabled:!0,allowHalf:!0,value:v||0})]})]})}),(0,A.jsxs)(o.A,{span:4,children:[(0,A.jsx)("div",{className:"title",children:u}),(0,A.jsx)("div",{className:"label",children:a("phone")})]}),(0,A.jsxs)(o.A,{span:4,children:[(0,A.jsx)("div",{className:"title",children:d}),(0,A.jsx)("div",{className:"label",children:a("last.activity")})]}),(0,A.jsxs)(o.A,{span:4,children:[(0,A.jsx)("div",{className:"title",children:m}),(0,A.jsx)("div",{className:"label",children:a("total.orders")})]}),(0,A.jsxs)(o.A,{span:4,children:[(0,A.jsx)("div",{className:"title",children:(0,y.r)(h)}),(0,A.jsxs)("div",{className:"label",children:[" ",a("total.earning")]})]}),(0,A.jsx)(o.A,{span:1,children:(0,A.jsx)("button",{type:"button",className:"close-btn",onClick:i,children:(0,A.jsx)(g.A,{})})})]})};var f=s(80737),N=s(13564),k=s(79378);function w(e){var l,s,i,d;let{data:t}=e;const{t:o}=(0,r.B)(),u=(0,N.Zp)(),m=(0,v.wA)(),{menuItems:x}=(0,v.d4)((e=>e.menu),v.bN),j=(null===t||void 0===t?void 0:t.deliveryman_orders)||[],g=(0,_.A)(null===t||void 0===t||null===(l=t.delivery_man_setting)||void 0===l?void 0:l.updated_at);return(0,A.jsxs)(a.A,{className:"user-card",onClick:()=>(e=>{!!x.find((e=>"delivery_map_orders"===e.id))&&m((0,h.EK)({id:"delivery_map_orders",nextUrl:"deliveries/map"})),m((0,h.X4)({url:`deliveries/map/${e.id}`,id:"delivery_map_orders",name:o("delivery.orders"),data:{list:j,item:j[0],deliveryman:t}})),u(`/deliveries/map/${e.id}`)})(t),children:[(0,A.jsxs)(f.A,{children:[(0,A.jsx)(n.A,{src:c.sE+(null===t||void 0===t?void 0:t.img),icon:(0,A.jsx)(k.A,{}),style:{color:"#1a3353"}}),(0,A.jsxs)("div",{children:[(0,A.jsxs)("h4",{className:"title",children:[null===t||void 0===t?void 0:t.firstname," ",null===t||void 0===t||null===(s=t.lastname)||void 0===s?void 0:s.charAt(0),"."]}),(0,A.jsx)("div",{className:"last-seen "+(null!==t&&void 0!==t&&null!==(i=t.delivery_man_setting)&&void 0!==i&&i.online?"online":"text-muted"),children:null!==t&&void 0!==t&&null!==(d=t.delivery_man_setting)&&void 0!==d&&d.online?o("online"):g})]})]}),(0,A.jsx)("div",{className:"mt-2"}),(0,A.jsxs)(f.A,{children:[(0,A.jsxs)("div",{children:[o("active_orders"),":"]}),(0,A.jsx)("div",{children:j.length})]})]})}var C=s(73737);const M=[{label:"All",value:"all",key:1},{label:"Online",value:"1",key:2},{label:"Offline",value:"0",key:3}],B=e=>(0,A.jsx)(n.A,{src:e.url,icon:(0,A.jsx)(k.A,{}),style:{color:"#1a3353"},onClick:e.onClick});function E(){const{t:e}=(0,r.B)(),{activeMenu:l}=(0,v.d4)((e=>e.menu),v.bN),s=(0,v.wA)(),[n,g]=(0,i.useState)(void 0),[p,y]=(0,i.useState)(null),{settings:_}=(0,v.d4)((e=>e.globalSettings),v.bN),f=(0,u.A)(_),{delivery:N,loading:k}=(0,v.d4)((e=>e.deliveries),v.bN);(0,j.A)((()=>{const e={page:1,perPage:100,online:"all"===n?void 0:n,"statuses[0]":"new","statuses[1]":"accepted","statuses[2]":"ready","statuses[3]":"on_a_way"};s((0,m.N)(e))}),[n]);return(0,i.useEffect)((()=>{null!==l&&void 0!==l&&l.refetch&&(s((0,m.N)({perPage:100,"statuses[0]":"new","statuses[1]":"accepted","statuses[2]":"ready","statuses[3]":"on_a_way"})),s((0,h.km)(l)))}),[null===l||void 0===l?void 0:l.refetch]),(0,A.jsx)(a.A,{title:e("deliveries"),className:"delivery",extra:(0,A.jsx)(d.A,{options:M,defaultValue:"all",loading:k,onChange:e=>g(e),style:{width:"200px"}}),children:k?(0,A.jsx)(x.A,{}):(0,A.jsxs)(t.A,{gutter:8,children:[(0,A.jsx)(o.A,{span:18,children:(0,A.jsxs)("div",{className:"map-container",style:{height:"73vh",width:"100%"},children:[!!p&&(0,A.jsx)(a.A,{className:"map-user-card",children:(0,A.jsx)(b,{data:p,handleClose:()=>{y(null)}})}),(0,A.jsx)(C.A,{center:f,handleLoadMap:(e,l)=>{const s=N.map((e=>{var l,s;return{lat:Number((null===(l=e.delivery_man_setting)||void 0===l?void 0:l.location.latitude)||"0"),lng:Number((null===(s=e.delivery_man_setting)||void 0===s?void 0:s.location.longitude)||"0")}}));let i=new l.LatLngBounds;for(var n=0;n<s.length;n++)i.extend(s[n]);e.fitBounds(i)},children:N.map((e=>{var l,s,i,n;return(0,A.jsx)(B,{lat:Number((null===e||void 0===e||null===(l=e.delivery_man_setting)||void 0===l||null===(s=l.location)||void 0===s?void 0:s.latitude)||"0"),lng:Number((null===e||void 0===e||null===(i=e.delivery_man_setting)||void 0===i||null===(n=i.location)||void 0===n?void 0:n.longitude)||"0"),url:c.sE+e.img,onClick:()=>{y(e)}},e.id)}))})]})}),(0,A.jsx)(o.A,{span:6,children:(0,A.jsx)("div",{className:"order-list",style:{height:"75vh"},children:N.map(((e,l)=>(0,A.jsx)(w,{data:e},e.id+l)))})})]})})}},89627:(e,l,s)=>{function i(e,l){var s=[{value:1,symbol:""},{value:1e3,symbol:"k"},{value:1e6,symbol:"M"},{value:1e9,symbol:"G"},{value:1e12,symbol:"T"},{value:1e15,symbol:"P"},{value:1e18,symbol:"E"}].slice().reverse().find((function(l){return e>=l.value}));return s?"$"+(e/s.value).toFixed(l).replace(/\.0+$|(\.[0-9]*[1-9])0+$/,"$1")+s.symbol:"0"}s.d(l,{r:()=>i})}}]);