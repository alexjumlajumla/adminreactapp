"use strict";(self.webpackChunkjumlajumla_dashboard=self.webpackChunkjumlajumla_dashboard||[]).push([[4912],{47992:(e,s,t)=>{t.d(s,{G:()=>u});var a=t(9950),n=t(95491),l=t.n(n),r=t(99674),i=t(90650),d=t(44414);const u=e=>{let{fetchOptions:s,debounceTimeout:t=400,onClear:n,...u}=e;const[o,c]=(0,a.useState)(!1),[m,h]=(0,a.useState)([]),b=(0,a.useMemo)((()=>l()((e=>{h([]),c(!0),s(e).then((e=>{h(e),c(!1)}))}),t)),[s,t]);return(0,d.jsx)(r.A,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:b,onClear:()=>{b(""),n&&n()},notFoundContent:o?(0,d.jsx)(i.A,{size:"small"}):"no results",...u,options:m,onFocus:()=>{b("")}})}},54912:(e,s,t)=>{t.r(s),t.d(s,{default:()=>x});var a=t(9950),n=t(13564),l=t(12449),r=t(3969),i=t(23263),d=t(91854),u=t(74623),o=t(70030),c=t(59051),m=t.n(c),h=t(24611),b=t(81499),p=t(77159),g=t(44414);const x=()=>{const{t:e}=(0,o.B)(),{activeMenu:s}=(0,d.d4)((e=>e.menu),d.bN),t=(0,d.wA)(),[c]=r.A.useForm(),x=(0,n.Zp)();(0,a.useEffect)((()=>()=>{const e=c.getFieldsValue(!0);t((0,u.Ok)({activeMenu:s,data:e}))}),[]);return(0,g.jsx)(i.A,{title:e("add.subscriber"),className:"h-100",children:(0,g.jsx)(p.A,{form:c,handleSubmit:a=>{const n={...a,type:a.type,email_setting_id:a.email_setting_id.value,send_to:m()(a.send_to).format("YYYY-MM-DD HH:mm:ss")},r="message/subscriber";return h.A.create(n).then((()=>{l.oR.success(e("successfully.created")),(0,d.vA)((()=>{t((0,u.EK)({...s,nextUrl:r})),t((0,b.e)({}))})),x(`/${r}`)}))}})})}},77159:(e,s,t)=>{t.d(s,{A:()=>w});var a=t(9950),n=t(3969),l=t(87094),r=t(41988),i=t(55902),d=t(99674),u=t(87864),o=t(48538),c=t(47992),m=t(70030),h=t(36455),b=t(19181),p=t.n(b),g=t(63620),x=t(64924),f=t(44414);function j(e){let{form:s,lang:t,languages:a}=e;const{t:l}=(0,m.B)();return(0,f.jsx)("div",{className:"textEditor",children:(0,f.jsx)(n.A.Item,{label:l("newsletter.content"),name:"body",valuePropName:"data",getValueFromEvent:(e,s)=>s.getData(),rules:[{required:!0,message:l("required")}],className:"description-editor",children:(0,f.jsx)(h.CKEditor,{editor:p(),config:{extraPlugins:[function(e){e.plugins.get("FileRepository").createUploadAdapter=e=>function(e){return{upload:()=>new Promise(((s,t)=>{const a=new FormData;e.file.then((e=>{a.append("image",e),a.append("type","blogs"),x.A.upload(a).then((e=>{let{data:t}=e;s({default:`${g.sE+t.title}`})})).catch((e=>{t(e)}))}))}))}}(e)}]},onChange:(e,s)=>{s.getData()},onBlur:(e,t)=>{const a=t.getData();s.setFieldsValue({body:a})}})})})}var A=t(59051),v=t.n(A),y=t(91854),_=t(7843);const N=[{title:"order",value:"order"},{title:"subscribe",value:"subscribe"},{title:"verify",value:"verify"}];function w(e){let{type:s="add",form:t,handleSubmit:h}=e;const{t:b}=(0,m.B)(),{activeMenu:p}=(0,y.d4)((e=>e.menu),y.bN),{defaultLang:g,languages:x}=(0,y.d4)((e=>e.formLang),y.bN),{subscribers:A}=(0,y.d4)((e=>e.messageSubscriber),y.bN),[w,q]=(0,a.useState)(!1);return(0,f.jsxs)(n.A,{name:"subscriber-form",layout:"vertical",onFinish:e=>{q(!0),h(e).finally((()=>q(!1)))},form:t,initialValues:{...p.data,...(()=>{const e=p.data;if(null===e||void 0===e||!e.send_to)return e;const s=e.send_to;return{...e,send_to:v()(s,"YYYY-MM-DD")}})()},className:"d-flex flex-column h-100",children:[(0,f.jsxs)(l.A,{gutter:12,children:[(0,f.jsx)(r.A,{span:12,children:(0,f.jsx)(n.A.Item,{label:b("subject"),name:"subject",rules:[{required:!0,message:b("required")}],children:(0,f.jsx)(i.A,{})})}),(0,f.jsx)(r.A,{span:12,children:(0,f.jsx)(n.A.Item,{label:b("type"),name:"type",rules:[{required:!0,message:b("required")}],children:(0,f.jsx)(d.A,{disabled:"edit"===s,options:N.filter((e=>!A.some((s=>s.type===e.value)))),className:"w-100"})})}),(0,f.jsx)(r.A,{span:12,children:(0,f.jsx)(n.A.Item,{label:b("email.setting.id"),name:"email_setting_id",rules:[{required:!0,message:b("required")}],children:(0,f.jsx)(c.G,{fetchOptions:()=>_.A.get().then((e=>{let{data:s}=e;return s.map((e=>({label:null===e||void 0===e?void 0:e.host,value:null===e||void 0===e?void 0:e.id})))})),className:"w-100",placeholder:b("email.setting.id")})})}),(0,f.jsx)(r.A,{span:24,children:(0,f.jsx)(j,{languages:x,form:t,lang:g})}),(0,f.jsx)(r.A,{span:12,children:(0,f.jsx)(n.A.Item,{label:b("alt.body"),name:"alt_body",rules:[{required:!0,message:b("required")}],children:(0,f.jsx)(i.A,{})})}),(0,f.jsx)(r.A,{span:6,children:(0,f.jsx)(n.A.Item,{label:b("send.to"),name:"send_to",rules:[{required:!0,message:b("required")}],children:(0,f.jsx)(u.A,{showTime:!0,className:"w-100",disabledDate:e=>v()().add(-1,"days")>=e})})})]}),(0,f.jsx)("div",{className:"flex-grow-1 d-flex flex-column justify-content-end",children:(0,f.jsx)("div",{className:"pb-5",children:(0,f.jsx)(o.A,{type:"primary",htmlType:"submit",loading:w,children:b("send")})})})]})}}}]);