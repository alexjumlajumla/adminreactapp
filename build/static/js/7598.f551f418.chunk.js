"use strict";(self.webpackChunkjumlajumla_dashboard=self.webpackChunkjumlajumla_dashboard||[]).push([[7598],{18744:(e,l,n)=>{n.d(l,{A:()=>k});var t=n(9950),a=n(3969),i=n(87094),o=n(41988),d=n(55902),s=n(99674),r=n(8724),u=n(25933),c=n(48538),v=n(98591),m=n(79406),p=n(16254),h=n(70030),g=n(91854),A=n(13564),j=n(62572),x=(n(47992),n(12449)),f=n(74623),b=n(28264),y=n(31281),I=n(44414);function k(e){var l,n;let{form:k,handleSubmit:w,error:S}=e;const{t:_}=(0,h.B)(),q=(0,g.wA)(),N=(0,A.Zp)(),{state:C}=(0,A.zy)(),{activeMenu:F}=(0,g.d4)((e=>e.menu),g.bN),{defaultLang:$,languages:O}=(0,g.d4)((e=>e.formLang),g.bN),{params:M}=(0,g.d4)((e=>e.category),g.bN),[L,E]=(0,t.useState)(!1),[z,V]=(0,t.useState)(null!==(l=F.data)&&void 0!==l&&l.image?null===(n=F.data)||void 0===n?void 0:n.image:[]),B={...M,type:null!==C&&void 0!==C&&C.parentId?"sub_main":"main",parent_id:null===C||void 0===C?void 0:C.parentId};return(0,I.jsxs)(a.A,{name:"basic",layout:"vertical",onFinish:e=>{var l,n;const t={...e,title:(0,y.A)(O,e),description:(0,y.A)(O,e,"description"),type:null!==C&&void 0!==C&&C.parentId?"sub_main":"main",active:Number(null===e||void 0===e?void 0:e.active),keywords:null===e||void 0===e||null===(l=e.keywords)||void 0===l?void 0:l.join(","),parent_id:(null===C||void 0===C?void 0:C.parentId)||(null===e||void 0===e||null===(n=e.parent_id)||void 0===n?void 0:n.value),images:null===z||void 0===z?void 0:z.map((e=>null===e||void 0===e?void 0:e.name))};E(!0),w(t).then((()=>{const e=null!==C&&void 0!==C&&C.parentId?`category/${null===C||void 0===C?void 0:C.parentUuid}`:"catalog/categories";x.oR.success(_("successfully.updated")),(0,g.vA)((()=>{q((0,f.EK)({...F,nextUrl:e})),q((0,b.jE)(B))})),N(`/${e}`)})).finally((()=>{E(!1)}))},initialValues:{active:!0,...F.data},form:k,children:[(0,I.jsxs)(i.A,{gutter:12,children:[(0,I.jsx)(o.A,{span:12,children:O.map((e=>(0,I.jsx)(a.A.Item,{label:_("name"),name:`title[${(null===e||void 0===e?void 0:e.locale)||"en"}]`,hidden:(null===e||void 0===e?void 0:e.locale)!==$,rules:[{required:(null===e||void 0===e?void 0:e.locale)===$,message:_("required")},{type:"string",min:2,max:200,message:_("min.2.max.200.chars")}],children:(0,I.jsx)(d.A,{})},null===e||void 0===e?void 0:e.locale)))}),(0,I.jsx)(o.A,{span:12,children:O.map((e=>(0,I.jsx)(a.A.Item,{label:_("description"),name:`description[${(null===e||void 0===e?void 0:e.locale)||"en"}]`,hidden:(null===e||void 0===e?void 0:e.locale)!==$,rules:[{required:(null===e||void 0===e?void 0:e.locale)===$,message:_("required")},{type:"string",min:2,max:200,message:_("min.2.max.200.chars")}],children:(0,I.jsx)(v.A,{rows:2})},null===e||void 0===e?void 0:e.locale)))}),(0,I.jsx)(o.A,{span:12,children:(0,I.jsx)(a.A.Item,{label:_("keywords"),name:"keywords",rules:[{required:!0,message:_("required")}],children:(0,I.jsx)(s.A,{mode:"tags",style:{width:"100%"}})})}),!(null!==C&&void 0!==C&&C.parentId)&&(0,I.jsx)(o.A,{span:12,children:(0,I.jsx)(a.A.Item,{label:_("parent.category"),name:"parent_id",rules:[{required:!0,message:_("required")}],children:(0,I.jsx)(m.a,{refetch:!0,fetchOptions:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const l={perPage:100,type:null!==C&&void 0!==C&&C.parentId?"main":"sub_shop",active:1,search:null!==e&&void 0!==e&&e.length?e:void 0};return j.A.selectPaginate(l).then((e=>e.data.map((e=>{var l;return{label:null===e||void 0===e||null===(l=e.translation)||void 0===l?void 0:l.title,value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id}}))))}})})}),(0,I.jsx)(o.A,{span:12,children:(0,I.jsx)(a.A.Item,{name:"input",label:_("position"),rules:[{required:!0,message:_("required")}],children:(0,I.jsx)(r.A,{min:0,parser:e=>parseInt(e,10),max:32767,className:"w-100"})})}),(0,I.jsx)(o.A,{span:4,children:(0,I.jsx)(a.A.Item,{label:_("image"),name:"images",rules:[{required:!(null!==z&&void 0!==z&&z.length),message:_("required")}],children:(0,I.jsx)(p.A,{type:"categories",imageList:z,setImageList:V,form:k,multiple:!1})})}),(0,I.jsx)(o.A,{span:2,children:(0,I.jsx)(a.A.Item,{label:_("active"),name:"active",valuePropName:"checked",children:(0,I.jsx)(u.A,{})})})]}),(0,I.jsx)(c.A,{type:"primary",htmlType:"submit",loading:L,children:_("submit")})]})}},31281:(e,l,n)=>{function t(e,l){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"title";const t=null===e||void 0===e?void 0:e.map((e=>({[null===e||void 0===e?void 0:e.locale]:l[`${n}[${null===e||void 0===e?void 0:e.locale}]`]?l[`${n}[${null===e||void 0===e?void 0:e.locale}]`]:void 0})));return Object.assign({},...t)}n.d(l,{A:()=>t})},41064:(e,l,n)=>{function t(e,l){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:["title"];if(null===l||void 0===l||!l.translations)return{};const{translations:t}=l,a=(e,l)=>{const n=null===t||void 0===t?void 0:t.find((l=>(null===l||void 0===l?void 0:l.locale)===(null===e||void 0===e?void 0:e.locale)));return n||{[l]:""}},i=e.flatMap((e=>n.flatMap((l=>({[`${l}[${null===e||void 0===e?void 0:e.locale}]`]:a(e,l)[l]})))));return Object.assign({},...i)}n.d(l,{A:()=>t})},47992:(e,l,n)=>{n.d(l,{G:()=>r});var t=n(9950),a=n(95491),i=n.n(a),o=n(99674),d=n(90650),s=n(44414);const r=e=>{let{fetchOptions:l,debounceTimeout:n=400,onClear:a,...r}=e;const[u,c]=(0,t.useState)(!1),[v,m]=(0,t.useState)([]),p=(0,t.useMemo)((()=>i()((e=>{m([]),c(!0),l(e).then((e=>{m(e),c(!1)}))}),n)),[l,n]);return(0,s.jsx)(o.A,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:p,onClear:()=>{p(""),a&&a()},notFoundContent:u?(0,s.jsx)(d.A,{size:"small"}):"no results",...r,options:v,onFocus:()=>{p("")}})}},71999:(e,l,n)=>{n.d(l,{A:()=>r});var t=n(9950),a=n(17811),i=n(91854),o=n(82406),d=n(12437),s=n(44414);const r=()=>{const e=(0,i.wA)(),{languages:l,defaultLang:n}=(0,i.d4)((e=>e.formLang),i.bN);(0,t.useEffect)((()=>{d.A.getAllActive().then((l=>{let{data:n}=l;e((0,o.Nn)(n)),e((0,o.Qq)(n.find((e=>!(null===e||void 0===e||!e.default))).locale))}))}),[]);return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(a.Ay.Group,{value:n,onChange:l=>{let{target:{value:n}}=l;e((0,o.Qq)(n))},className:"float-right",buttonStyle:"solid",children:null===l||void 0===l?void 0:l.map((e=>(0,s.jsx)(a.Ay.Button,{value:e.locale,children:e.title},e.id)))})})}},79406:(e,l,n)=>{n.d(l,{a:()=>r});var t=n(9950),a=n(95491),i=n.n(a),o=n(99674),d=n(90650),s=n(44414);const r=e=>{let{fetchOptions:l,debounceTimeout:n=400,refetch:a=!1,...r}=e;const[u,c]=(0,t.useState)(!1),[v,m]=(0,t.useState)([]),p=(0,t.useMemo)((()=>i()((e=>{m([]),c(!0),l(e).then((e=>{m(e),c(!1)}))}),n)),[l,n]);return(0,s.jsx)(o.A,{showSearch:!0,allowClear:!0,labelInValue:!0,onClear:()=>p(""),filterOption:!1,onSearch:p,notFoundContent:u?(0,s.jsx)(d.A,{size:"small"}):"no results",...r,options:v,onFocus:()=>{p("")}})}},87598:(e,l,n)=>{n.r(l),n.d(l,{default:()=>f});var t=n(9950),a=n(3969),i=n(23263),o=n(90650),d=n(13564),s=n(71999),r=n(91854),u=n(74623),c=n(62572),v=n(70030),m=n(28264),p=n(88986),h=n(41064),g=n(62466),A=n(34967),j=n(18744),x=n(44414);const f=()=>{const{t:e}=(0,v.B)(),l=(0,r.wA)(),[n]=a.A.useForm(),{state:f}=(0,d.zy)(),{activeMenu:b}=(0,r.d4)((e=>e.menu),r.bN),{languages:y}=(0,r.d4)((e=>e.formLang),r.bN),{params:I}=(0,r.d4)((e=>e.category),r.bN),[k,w]=(0,t.useState)(null),[S,_]=(0,t.useState)(!1),{uuid:q}=(0,d.g)(),N={...I,type:null!==f&&void 0!==f&&f.parentId?"sub_main":"main",parent_id:null===f||void 0===f?void 0:f.parentId};(0,t.useEffect)((()=>()=>{const e=n.getFieldsValue(!0);(0,r.vA)((()=>{l((0,u.Ok)({activeMenu:b,data:e})),l((0,m.jE)(N))}))}),[]),(0,p.A)((()=>{b.refetch&&(C(q),l((0,u.km)(b)))}),[b.refetch]),(0,t.useEffect)((()=>{C(q),l((0,u.km)(b))}),[q,null===f||void 0===f?void 0:f.parentId]);const C=e=>{e&&(_(!0),c.A.getById(e).then((e=>{var t,a,i;let o=null===e||void 0===e?void 0:e.data;console.log("category",o);const d={...o,...(0,h.A)(y,o,["title","description"]),image:[(0,g.A)(o.img)],keywords:null===o||void 0===o||null===(t=o.keywords)||void 0===t?void 0:t.split(","),parent_id:{label:null===(a=o.parent)||void 0===a||null===(i=a.translation)||void 0===i?void 0:i.title,value:o.parent_id,key:o.parent_id}};w(o.id),n.setFieldsValue(d),l((0,u.Ok)({activeMenu:b,data:d}))})).finally((()=>{_(!1),l((0,u.km)(b))})))};return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(i.A,{title:null!==f&&void 0!==f&&f.parentId?e("edit.sub.category"):e("edit.category"),extra:(0,x.jsx)(s.A,{}),children:S?(0,x.jsx)("div",{className:"d-flex justify-content-center align-items-center py-5",children:(0,x.jsx)(o.A,{size:"large",className:"mt-5 pt-5"})}):(0,x.jsx)(j.A,{form:n,handleSubmit:e=>c.A.update(q,e)})}),!!k&&!(null!==f&&void 0!==f&&f.parentId)&&(0,x.jsx)(A.A,{type:"sub_main",parentId:k})]})}}}]);