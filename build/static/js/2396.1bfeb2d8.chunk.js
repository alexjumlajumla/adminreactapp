"use strict";(self.webpackChunkjumlajumla_dashboard=self.webpackChunkjumlajumla_dashboard||[]).push([[2396],{8168:(e,l,t)=>{function a(e){switch(e){case"ascend":return"asc";case"descend":return"desc"}}t.d(l,{A:()=>a})},28645:(e,l,t)=>{t.d(l,{A:()=>p});var a=t(9950),n=t(66362),i=t(69216),s=t(80737),r=t(25933),d=t(57811),o=t(81541),u=t(48538),c=t(89323),v=t(70030),m=t(44414);const{Text:h}=n.A,p=e=>{let{columns:l=[],setColumns:t,style:n,size:p="",iconOnly:y}=e;const{t:x}=(0,v.B)(),[A,j]=(0,a.useState)(!1),g=(0,m.jsx)(i.A,{children:null===l||void 0===l?void 0:l.map(((e,a)=>(0,m.jsx)(i.A.Item,{children:(0,m.jsxs)(s.A,{className:"d-flex justify-content-between",children:[(0,m.jsx)(h,{children:e.title}),(0,m.jsx)(r.A,{defaultChecked:!0,onClick:()=>function(e){const a=null===l||void 0===l?void 0:l.map((l=>(l.dataIndex===e.dataIndex&&(l.is_show=!(null!==l&&void 0!==l&&l.is_show)),l)));t(a)}(e),disabled:1===a})]})},e+a)))});return(0,m.jsx)(d.A,{overlay:g,trigger:["click"],onVisibleChange:e=>{j(e)},visible:A,children:(0,m.jsx)(o.A,{title:x("change.columns"),children:(0,m.jsx)(u.A,{style:{...n},size:p,icon:(0,m.jsx)(c.A,{}),children:y?null:x("Columns")})})})}},53774:(e,l,t)=>{t.d(l,{A:()=>n});var a=t(83291);function n(){var e,l;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;const s=null===(e=a.M.getState())||void 0===e||null===(l=e.currency)||void 0===l?void 0:l.defaultCurrency,r=Number(t).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,"),d=n||(null===s||void 0===s?void 0:s.symbol)||"$";return"after"===(i||(null===s||void 0===s?void 0:s.position)||"before")?`${r} ${d}`:`${d} ${r}`}},79406:(e,l,t)=>{t.d(l,{a:()=>o});var a=t(9950),n=t(95491),i=t.n(n),s=t(99674),r=t(90650),d=t(44414);const o=e=>{let{fetchOptions:l,debounceTimeout:t=400,refetch:n=!1,...o}=e;const[u,c]=(0,a.useState)(!1),[v,m]=(0,a.useState)([]),h=(0,a.useMemo)((()=>i()((e=>{m([]),c(!0),l(e).then((e=>{m(e),c(!1)}))}),t)),[l,t]);return(0,d.jsx)(s.A,{showSearch:!0,allowClear:!0,labelInValue:!0,onClear:()=>h(""),filterOption:!1,onSearch:h,notFoundContent:u?(0,d.jsx)(r.A,{size:"small"}):"no results",...o,options:v,onFocus:()=>{h("")}})}},85023:(e,l,t)=>{t.d(l,{D:()=>r});var a=t(9950),n=t(99674),i=t(90650),s=t(44414);const r=e=>{let{fetchOptions:l,refetch:t=!1,...r}=e;const[d,o]=(0,a.useState)(!1),[u,c]=(0,a.useState)([]);return(0,s.jsx)(n.A,{labelInValue:!0,filterOption:!1,notFoundContent:d?(0,s.jsx)(i.A,{size:"small"}):"no results",...r,options:d?[]:u,onFocus:()=>{u.length&&!t||(o(!0),l().then((e=>{c(e),o(!1)})))}})}},89323:(e,l,t)=>{t.d(l,{A:()=>d});var a=t(89379),n=t(9950);const i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 208H676V232h212v136zm0 224H676V432h212v160zM412 432h200v160H412V432zm200-64H412V232h200v136zm-476 64h212v160H136V432zm0-200h212v136H136V232zm0 424h212v136H136V656zm276 0h200v136H412V656zm476 136H676V656h212v136z"}}]},name:"table",theme:"outlined"};var s=t(25085),r=function(e,l){return n.createElement(s.A,(0,a.A)((0,a.A)({},e),{},{ref:l,icon:i}))};r.displayName="TableOutlined";const d=n.forwardRef(r)},92396:(e,l,t)=>{t.r(l),t.d(l,{default:()=>T});var a=t(9950),n=t(54909),i=t(12916),s=t(80737),r=t(81541),d=t(48538),o=t(23263),u=t(1007),c=t(12203),v=t(91854),m=t(74623),h=t(88986),p=t(8168),y=t(70030),x=t(53774),A=t(32645),j=t(3969),g=t(87094),b=t(41988),f=t(8724),w=t(55902),k=t(85023),C=t(53271),_=t(13567),S=t(34996),I=t(38342),z=t(79406),P=t(44414);function $(e){var l,t,n,i,s,r,o,u;let{data:c,handleCancel:h}=e;const{t:p}=(0,y.B)(),{activeMenu:x}=(0,v.d4)((e=>e.menu),v.bN),[$,N]=(0,a.useState)(!1),V=(0,v.wA)();return(0,P.jsx)(A.A,{visible:!!c,title:p("pay.to.seller"),onCancel:h,footer:[(0,P.jsx)(d.A,{onClick:h,children:p("cancel")},"calcel-btn"),(0,P.jsx)(d.A,{type:"primary",form:"form",htmlType:"submit",loading:$,children:null!==c&&void 0!==c&&c.id?p("edit"):p("create")},"pay-btn")],children:(0,P.jsx)(j.A,{initialValues:{cause:null===c||void 0===c?void 0:c.cause,price:null===c||void 0===c?void 0:c.price,answer:null===c||void 0===c?void 0:c.answer,currency_id:(null===c||void 0===c?void 0:c.currency)&&{value:null===c||void 0===c||null===(l=c.currency)||void 0===l?void 0:l.id,label:`${null===c||void 0===c||null===(t=c.currency)||void 0===t?void 0:t.title} (${null===c||void 0===c||null===(n=c.currency)||void 0===n?void 0:n.symbol})`},payment_id:(null===c||void 0===c?void 0:c.payment)&&{value:null===c||void 0===c||null===(i=c.payment)||void 0===i?void 0:i.id,label:null===c||void 0===c||null===(s=c.payment)||void 0===s?void 0:s.tag},created_by:(null===c||void 0===c?void 0:c.createdBy)&&{value:null===c||void 0===c||null===(r=c.createdBy)||void 0===r?void 0:r.id,label:`${null===c||void 0===c||null===(o=c.createdBy)||void 0===o?void 0:o.firstname} ${(null===c||void 0===c||null===(u=c.createdBy)||void 0===u?void 0:u.lastname)||""}`}},onFinish:e=>{var l,t,a;const n={cause:e.cause,price:e.price,created_by:null===e||void 0===e||null===(l=e.created_by)||void 0===l?void 0:l.value,payment_id:null===e||void 0===e||null===(t=e.payment_id)||void 0===t?void 0:t.value,currency_id:null===e||void 0===e||null===(a=e.currency_id)||void 0===a?void 0:a.value,answer:e.answer};N(!0),null!==c&&void 0!==c&&c.id?I.s.update(c.id,n).then((()=>{h(),V((0,m.Ms)(x))})).finally((()=>N(!1))):I.s.create(n).then((()=>{h(),V((0,m.Ms)(x))})).finally((()=>N(!1)))},id:"form",layout:"vertical",children:(0,P.jsxs)(g.A,{gutter:24,children:[(0,P.jsxs)(b.A,{span:12,children:[(0,P.jsx)(j.A.Item,{name:"created_by",rules:[{required:!0,message:p("required")}],label:p("seller"),children:(0,P.jsx)(z.a,{className:"w-100",placeholder:p("select.seller"),fetchOptions:e=>C.A.getAll({role:"seller",search:e}).then((e=>{let{data:l}=e;return l.map((e=>({value:e.id,label:`${e.firstname} ${e.lastname||""}`,key:e.id})))}))})}),(0,P.jsx)(j.A.Item,{name:"payment_id",rules:[{required:!0,message:p("required")}],label:p("payment"),children:(0,P.jsx)(k.D,{className:"w-100",placeholder:p("select.payment.type"),fetchOptions:()=>S.A.getAll().then((e=>{let{data:l}=e;return l.filter((e=>e.active&&"wallet"===e.tag)).map((e=>({value:e.id,label:e.tag,key:e.id})))}))})})]}),(0,P.jsxs)(b.A,{span:12,children:[(0,P.jsx)(j.A.Item,{name:"currency_id",rules:[{required:!0,message:p("required")}],label:p("currency"),children:(0,P.jsx)(k.D,{className:"w-100",placeholder:p("select.currency"),fetchOptions:()=>_.A.getAll().then((e=>{let{data:l}=e;return l.filter((e=>e.active)).map((e=>({value:e.id,label:`${e.title} (${e.symbol||""})`,key:e.id})))}))})}),(0,P.jsx)(j.A.Item,{name:"price",rules:[{required:!0,message:p("required")}],label:p("price"),children:(0,P.jsx)(f.A,{className:"w-100",placeholder:p("amount"),min:0})})]}),(0,P.jsxs)(b.A,{span:24,children:[(0,P.jsx)(j.A.Item,{name:"cause",rules:[{validator:(e,l)=>l?l&&""===(null===l||void 0===l?void 0:l.trim())?Promise.reject(new Error(p("no.empty.space"))):l&&(null===l||void 0===l?void 0:l.trim().length)<2?Promise.reject(new Error(p("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(p("required")))}],label:p("cause"),children:(0,P.jsx)(w.A.TextArea,{showCount:!0,maxLength:100,placeholder:p("cause")})}),(0,P.jsx)(j.A.Item,{name:"answer",label:p("answer"),rules:[{validator:(e,l)=>l?l&&""===(null===l||void 0===l?void 0:l.trim())?Promise.reject(new Error(p("no.empty.space"))):l&&(null===l||void 0===l?void 0:l.trim().length)<2?Promise.reject(new Error(p("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(p("required")))}],children:(0,P.jsx)(w.A.TextArea,{showCount:!0,maxLength:100,placeholder:p("answer")})})]})]})})})}var N=t(28645),V=t(13564),M=t(37694),q=t(99674);function H(e){let{data:l,handleCancel:t,statuses:n}=e;const{t:i}=(0,y.B)(),{activeMenu:s}=(0,v.d4)((e=>e.menu),v.bN),[r,o]=(0,a.useState)(!1),u=(0,v.wA)();return(0,P.jsx)(A.A,{visible:!!l,title:i("change.status"),onCancel:t,footer:[(0,P.jsx)(d.A,{onClick:t,children:i("cancel")}),(0,P.jsx)(d.A,{loading:r,type:"primary",form:"status",htmlType:"submit",children:i("change")},"pay-btn")],children:(0,P.jsx)(j.A,{initialValues:{status:null===l||void 0===l?void 0:l.status},onFinish:e=>{o(!0),I.s.changeStatus(null===l||void 0===l?void 0:l.id,e).then((()=>{t(),u((0,m.Ms)(s))})).finally((()=>o(!1)))},id:"status",layout:"vertical",children:(0,P.jsx)(j.A.Item,{label:i("status"),name:"status",children:(0,P.jsx)(q.A,{options:n.slice(1).map((e=>({label:i(e),value:e})))})})})})}var B=t(59051),O=t.n(B);const{TabPane:E}=n.A,F=[{key:"pending",label:"pending",statusParam:"pending"},{key:"history",label:"history",statusParam:void 0}];function T(){var e;const{t:l}=(0,y.B)(),t=(0,v.wA)(),A=(0,V.Zp)(),{activeMenu:j}=(0,v.d4)((e=>e.menu),v.bN),[g,b]=(0,a.useState)("pending"),f=(null===(e=j.data)||void 0===e?void 0:e.viewKey)||g,w=j.data,k={sort:null===w||void 0===w?void 0:w.sort,column:null===w||void 0===w?void 0:w.column,perPage:null===w||void 0===w?void 0:w.perPage,page:null===w||void 0===w?void 0:w.page,status:"history"===f?void 0:"pending"},{payoutRequests:C,meta:_,loading:S,params:I}=(0,v.d4)((e=>e.adminPayouts),v.bN),[z,q]=(0,a.useState)(null),[B,T]=(0,a.useState)(null),D=null===C||void 0===C?void 0:C.filter((e=>"pending"===e.status)).reduce(((e,l)=>e+Number(l.price||0)),0),[K,Y]=(0,a.useState)([{title:l("user"),dataIndex:"createdBy",key:"createdBy",is_show:!0,render:e=>(0,P.jsx)("div",{className:"text-hover",onClick:()=>(e=>{t((0,m.X4)({url:`/users/user/${e.uuid}`,id:"user_info",name:l("user.info")})),A(`/users/user/${e.uuid}`,{state:{user_id:e.id}})})(e),children:(null===e||void 0===e?void 0:e.firstname)+" "+(null===e||void 0===e?void 0:e.lastname)})},{title:l("price"),dataIndex:"price",key:"price",is_show:!0,render:(e,l)=>{var t,a;return(0,x.A)(e,null===l||void 0===l||null===(t=l.currency)||void 0===t?void 0:t.symbol,null===l||void 0===l||null===(a=l.currency)||void 0===a?void 0:a.position)}},{title:l("status"),dataIndex:"status",key:"status",is_show:!0,render:e=>(0,P.jsx)(i.A,{color:{pending:"blue",accepted:"green",canceled:"red"}[e]||"default",children:l(e)})},{title:l("cause"),dataIndex:"cause",key:"cause",is_show:!0},{title:l("created.at"),dataIndex:"created_at",key:"created_at",is_show:!0,render:(e,l)=>O()(null===l||void 0===l?void 0:l.created_at).format("YYYY-MM-DD HH:mm")},{title:l("answer"),dataIndex:"answer",key:"answer",is_show:!0},{title:l("actions"),dataIndex:"uuid",key:"uuid",is_show:!0,render:(e,t)=>(0,P.jsx)(s.A,{children:"pending"===t.status&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(r.A,{title:l("approve"),children:(0,P.jsx)(d.A,{type:"primary",onClick:()=>T({...t,desiredStatus:"accepted"}),children:l("pay")})}),(0,P.jsx)(r.A,{title:l("reject"),children:(0,P.jsx)(d.A,{danger:!0,onClick:()=>T({...t,desiredStatus:"canceled"}),children:l("reject")})})]})})}]);(0,a.useEffect)((()=>{j.refetch&&(t((0,M.X)(k)),t((0,m.km)(j)))}),[j.refetch]),(0,h.A)((()=>{t((0,M.X)(k))}),[j.data]);return(0,P.jsxs)(o.A,{title:l("payout.requests"),extra:(0,P.jsxs)(s.A,{children:[(0,P.jsx)(d.A,{onClick:()=>q(!0),type:"primary",children:l("create.payout")}),(0,P.jsx)(N.A,{columns:K,setColumns:Y})]}),children:["pending"===f&&(0,P.jsx)(u.A,{title:l("total.pending"),value:(0,x.A)(D),className:"mb-4"}),(0,P.jsx)(n.A,{className:"mt-3",activeKey:f,onChange:e=>{(e=>{const l=j.data;t((0,m.Ok)({activeMenu:j,data:{...l,...e}}))})({viewKey:e,page:1}),b(e)},type:"card",children:F.map((e=>(0,P.jsx)(E,{tab:l(e.label)},e.key)))}),(0,P.jsx)(c.A,{scroll:{x:!0},columns:null===K||void 0===K?void 0:K.filter((e=>e.is_show)),dataSource:C,pagination:{pageSize:I.perPage,page:I.page,total:_.total,defaultCurrent:I.page},rowKey:e=>e.id,onChange:function(e,l,a){const{pageSize:n,current:i}=e,{field:s,order:r}=a,d=(0,p.A)(r);t((0,m.Ok)({activeMenu:j,data:{perPage:n,page:i,column:s,sort:d}}))},loading:S}),z&&(0,P.jsx)($,{data:z,handleCancel:()=>q(null)}),B&&(0,P.jsx)(H,{data:B,statuses:F.map((e=>e.key)),handleCancel:()=>T(null)})]})}}}]);