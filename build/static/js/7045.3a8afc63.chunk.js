"use strict";(self.webpackChunkjumlajumla_dashboard=self.webpackChunkjumlajumla_dashboard||[]).push([[7045],{1201:(l,e,d)=>{d.d(e,{A:()=>u});d(9950);var i=d(70030),n=d(88542);const o=d.p+"static/media/noproductsfound.1cec73868b5fd048b865.riv",t=d.p+"static/media/noresult.ac4af107751f94856a9c.riv",a=d.p+"static/media/nosell.32cb2c2cc548a15c820d.riv";var s=d(44414);const u=function(l){let{id:e="noresult",text:d=""}=l;const{t:u}=(0,i.B)(),v={src:{noproductsfound:o,noresult:t,nosell:a}[e],artboard:"New Artboard",autoplay:!0},{RiveComponent:r}=(0,n.useRive)(v);return(0,s.jsxs)("div",{className:"animation-canvas",children:[(0,s.jsx)("div",{style:{width:"100%",height:200},children:(0,s.jsx)(r,{})}),(0,s.jsx)("div",{className:"text text-center",children:u(d)})]})}},11906:(l,e,d)=>{d.d(e,{A:()=>$});var i=d(3969),n=d(23263),o=d(98412),t=d(80737),a=d(48538),s=d(9950),u=d(13564),v=d(47933),r=d(67231),c=d(45321),h=d(91854),m=d(74623),x=d(88986),p=d(92979),A=d(70030),j=d(1201);var k=d(12449),f=d(87094),y=d(41988),g=d(55902),b=d(8724),w=d(47992),_=d(34537),q=d(44414);const I=(l,e,d)=>l.map((function(){return{...arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[e]:d}})),F=l=>{let{form:e,fetchAddonOptions:d}=l;const{t:n}=(0,A.B)(),{defaultCurrency:o}=(0,h.d4)((l=>l.currency),h.bN),t=(l,d)=>{const i=l?(0,_.A)(6):d,{stocks:n}=e.getFieldsValue();e.setFieldsValue({all_sku:i,stocks:I(n,"sku",i)})};return(0,q.jsxs)(f.A,{gutter:12,children:[(0,q.jsx)(y.A,{style:{width:200},children:(0,q.jsx)(i.A.Item,{label:n("set.all.skus"),name:"all_sku",children:(0,q.jsx)(g.A,{onChange:l=>t(!1,l.target.value)})})}),(0,q.jsx)(y.A,{children:(0,q.jsx)(i.A.Item,{label:" ",children:(0,q.jsx)(a.A,{onClick:t,children:n("generate.sku")})})}),(0,q.jsx)(y.A,{style:{width:200},children:(0,q.jsx)(i.A.Item,{label:n("set.all.quantities"),name:"all_quantity",children:(0,q.jsx)(b.A,{onChange:l=>{const{stocks:d}=e.getFieldsValue();e.setFieldsValue({stocks:I(d,"quantity",l)})},className:"w-100"})})}),(0,q.jsx)(y.A,{style:{width:200},children:(0,q.jsx)(i.A.Item,{label:`${n("set.all.prices")} (${null===o||void 0===o?void 0:o.symbol})`,name:"all_price",children:(0,q.jsx)(b.A,{onChange:l=>{const{stocks:d}=e.getFieldsValue();e.setFieldsValue({stocks:I(d,"price",l)})},className:"w-100"})})}),(0,q.jsx)(y.A,{style:{width:200},children:(0,q.jsx)(i.A.Item,{label:n("set.all.addons"),name:"all_addon",children:(0,q.jsx)(w.G,{mode:"multiple",style:{minWidth:"300px"},fetchOptions:d,allowClear:!0,onChange:l=>{const{stocks:d}=e.getFieldsValue();e.setFieldsValue({stocks:I(d,"addons",l)})}})})})]})};var N=d(99674),C=d(44070);const V=l=>{let{fetchAddonOptions:e,form:d}=l;const n=(0,h.wA)(),{t:o}=(0,A.B)(),{activeMenu:t}=(0,h.d4)((l=>l.menu),h.bN),{defaultCurrency:s}=(0,h.d4)((l=>l.currency),h.bN);return(0,q.jsx)(i.A.List,{name:"stocks",children:(l,u)=>{let{remove:v}=u;return(0,q.jsx)("div",{children:l.map(((l,u)=>{var r,c,h,m,x,A;return(0,q.jsxs)(f.A,{gutter:12,align:"middle",style:{flexWrap:"nowrap",overflowX:"auto"},hidden:!(null!==(r=t.data)&&void 0!==r&&null!==(c=r.extras)&&void 0!==c&&c.length)&&l.key,children:[null===(h=t.data)||void 0===h||null===(m=h.extras)||void 0===m?void 0:m.map(((l,e)=>(0,q.jsx)(y.A,{children:(0,q.jsx)(i.A.Item,{label:null===l||void 0===l?void 0:l.label,name:[u,`extras[${e}]`],rules:[{required:!0,message:o("required")}],children:(0,q.jsx)(N.A,{disabled:!0,className:"w-100",style:{minWidth:200}})})},"extra"+l.value))),(0,q.jsx)(y.A,{children:(0,q.jsx)(i.A.Item,{label:o("addons"),name:[u,"addons"],rules:[{required:!1,message:o("required")}],children:(0,q.jsx)(w.G,{mode:"multiple",style:{minWidth:"300px",maxWidth:"300px"},fetchOptions:e,allowClear:!0})})}),(0,q.jsx)(y.A,{children:(0,q.jsx)(i.A.Item,{label:o("sku"),name:[u,"sku"],children:(0,q.jsx)(g.A,{className:"w-100",style:{minWidth:200}})})}),(0,q.jsx)(y.A,{children:(0,q.jsx)(i.A.Item,{label:o("quantity"),name:[u,"quantity"],rules:[{required:!0,message:o("required")}],children:(0,q.jsx)(b.A,{min:0,className:"w-100",style:{minWidth:200}})})}),(0,q.jsxs)(y.A,{children:[(0,q.jsx)(i.A.Item,{label:`${o("price")} (${null===s||void 0===s?void 0:s.symbol})`,name:[u,"price"],rules:[{required:!0,message:o("requried")}],children:(0,q.jsx)(b.A,{min:0,className:"w-100",style:{minWidth:200}})}),(0,q.jsx)(i.A.Item,{hidden:!0,label:o("id"),name:[u,"stock_id"],children:(0,q.jsx)(b.A,{})})]}),(0,q.jsx)(y.A,{children:(0,q.jsx)(i.A.Item,{label:o("tax"),name:[u,"tax"],children:(0,q.jsx)(b.A,{className:"w-100",disabled:!0,style:{minWidth:200},addonAfter:"%"})})}),(0,q.jsx)(y.A,{children:(0,q.jsx)(i.A.Item,{noStyle:!0,shouldUpdate:(e,d)=>{var i,n,o,t;return(null===e||void 0===e||null===(i=e.stocks)||void 0===i||null===(n=i[l.name])||void 0===n?void 0:n.price)!==(null===d||void 0===d||null===(o=d.stocks)||void 0===o||null===(t=o[l.name])||void 0===t?void 0:t.price)},children:e=>{let{getFieldValue:d}=e;const n=d(["stocks",l.name,"tax"])||0,t=d(["stocks",l.name,"price"]),a=0===n?t:t*n/100+t;return(0,q.jsx)(i.A.Item,{label:`${o("total.price")} (${null===s||void 0===s?void 0:s.symbol})`,children:(0,q.jsx)(b.A,{min:1,disabled:!0,value:a,className:"w-100",style:{minWidth:200}})})}})}),!(null===(x=t.data)||void 0===x||null===(A=x.extras)||void 0===A||!A.length)&&(0,q.jsx)(y.A,{children:(0,q.jsx)(a.A,{type:"primary",className:"mt-2",danger:!0,icon:(0,q.jsx)(C.A,{}),onClick:()=>(l=>{var e,i;let{remove:o,field:t}=l;const a=null===(e=d.getFieldsValue())||void 0===e||null===(i=e.stocks)||void 0===i?void 0:i[null===t||void 0===t?void 0:t.name];n((0,p.rG)(a)),o(t.name)})({remove:v,field:l})})})]},l.key)}))})}})},O=l=>{let{form:e,extras:d}=l;const o=(0,h.wA)(),{t:t}=(0,A.B)(),{filters:s,stocks:u,filteredStocks:v}=(0,h.d4)((l=>l.product.form),h.bN),r=()=>{e.setFieldsValue({all_sku:null,all_quantity:null,all_price:null,all_addon:[]})},c=function(){var l;let d=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const i=null===(l=e.getFieldsValue())||void 0===l?void 0:l.stocks;(0,h.vA)((()=>{null!==i&&void 0!==i&&i.length&&d&&o((0,p.f3)(i)),o((0,p.dr)()),o((0,p.yw)())})),r()};return(0,x.A)((()=>{var l;if(null===(l=Object.values(s))||void 0===l||!l.length)return;const e=null===u||void 0===u?void 0:u.filter((l=>{var e;return null===(e=Object.values(s))||void 0===e?void 0:e.every((e=>{var d;return null===l||void 0===l||null===(d=l.extras)||void 0===d?void 0:d.find((l=>(null===l||void 0===l?void 0:l.value)===(null===e||void 0===e?void 0:e.value)))}))}));o((0,p.K3)(e))}),[s,u]),(0,x.A)((()=>{var l;e.setFieldsValue({stocks:null!==(l=Object.values(s))&&void 0!==l&&l.length?v:u})}),[v]),(0,q.jsx)(n.A,{children:(0,q.jsxs)(f.A,{gutter:12,children:[null===d||void 0===d?void 0:d.map((l=>{var d;return(0,q.jsx)(y.A,{style:{width:250},children:(0,q.jsx)(i.A.Item,{label:null===l||void 0===l?void 0:l.label,children:(0,q.jsx)(N.A,{allowClear:!0,labelInValue:!0,options:null===l||void 0===l?void 0:l.values,onChange:d=>((l,d)=>{var i,n;const t=null===(i=e.getFieldsValue())||void 0===i?void 0:i.stocks;var a;if(null!==t&&void 0!==t&&t.length&&o((0,p.f3)(t)),!d)return 1===(null===(a=Object.values(s))||void 0===a?void 0:a.length)?void c(!1):void o((0,p.Sy)(null===l||void 0===l?void 0:l.value));const u=null===l||void 0===l||null===(n=l.values)||void 0===n?void 0:n.find((l=>(null===l||void 0===l?void 0:l.value)===(null===d||void 0===d?void 0:d.value)));(0,h.vA)((()=>{o((0,p._F)({[null===l||void 0===l?void 0:l.value]:u}))})),r()})(l,d),value:null===s||void 0===s||null===(d=s[null===l||void 0===l?void 0:l.value])||void 0===d?void 0:d.value})})},null===l||void 0===l?void 0:l.value)})),(0,q.jsx)(y.A,{children:(0,q.jsx)(i.A.Item,{label:" ",children:(0,q.jsx)(a.A,{onClick:c,children:t("clear.filter")})})})]})})},W=l=>"seller"===l?r.A:v.A,$=l=>{var e,d,v,r,f,y;let{next:g,prev:b,isRequest:w,userRole:_="admin"}=l;const I=(0,h.wA)(),{t:N}=(0,A.B)(),{uuid:C}=(0,u.g)(),[$]=i.A.useForm(),{activeMenu:B}=(0,h.d4)((l=>l.menu),h.bN),{stocks:M,filteredStocks:S,filters:R,deletedIds:E}=(0,h.d4)((l=>l.product.form),h.bN),[G,K]=(0,s.useState)(!1),[P,U]=(0,s.useState)(!1),L=()=>{K(!0),W(_).getById(C).then((l=>{var e,d,i;const n=(0,c.A)(null===B||void 0===B||null===(e=B.data.extras)||void 0===e?void 0:e.map((l=>l.values||[]))),o=n.map(((e,d)=>{var i,n;if(e.every((l=>"undefined"!==typeof l.stock_id))){var o;const i=l.data.stocks.find((l=>l.extras.every((l=>e.some((e=>e.value===l.id)))))),n=[];return null===i||void 0===i||null===(o=i.addons)||void 0===o||o.forEach((l=>{var e,d,i;l.product&&n.push({label:(null===l||void 0===l||null===(e=l.product)||void 0===e||null===(d=e.translation)||void 0===d?void 0:d.title)||(null===l||void 0===l?void 0:l.label),value:(null===l||void 0===l||null===(i=l.product)||void 0===i?void 0:i.id)||(null===l||void 0===l?void 0:l.value)})})),{price:(null===i||void 0===i?void 0:i.price)||0,quantity:(null===i||void 0===i?void 0:i.quantity)||0,sku:null===i||void 0===i?void 0:i.sku,stock_id:null===i||void 0===i?void 0:i.id,tax:(null===B||void 0===B?void 0:B.data.tax)||0,extras:e,addons:n,fieldKey:d,...Object.assign({},...e.map(((l,e)=>({[`extras[${e}]`]:{label:l.label,value:l.value}}))))}}return{price:0,quantity:0,sku:null===B||void 0===B||null===(i=B.data)||void 0===i?void 0:i.sku,tax:(null===(n=B.data)||void 0===n?void 0:n.tax)||0,extras:e,fieldKey:d,addons:[],...Object.assign({},...e.map(((l,e)=>({[`extras[${e}]`]:{label:l.label,value:l.value}}))))}}));let t=[];if(0===n.length&&0!==(null===(d=l.data.stocks)||void 0===d?void 0:d.length)){var a,s,u;const e=null===(a=l.data.stocks)||void 0===a?void 0:a.at(0),d=[];null===e||void 0===e||null===(s=e.addons)||void 0===s||s.forEach((l=>{var e,i,n;l.product&&d.push({label:(null===l||void 0===l||null===(e=l.product)||void 0===e||null===(i=e.translation)||void 0===i?void 0:i.title)||(null===l||void 0===l?void 0:l.label),value:(null===l||void 0===l||null===(n=l.product)||void 0===n?void 0:n.id)||(null===l||void 0===l?void 0:l.value)})})),t=[{price:(null===e||void 0===e?void 0:e.price)||0,quantity:(null===e||void 0===e?void 0:e.quantity)||0,sku:null===e||void 0===e?void 0:e.sku,tax:(null===(u=B.data)||void 0===u?void 0:u.tax)||0,addons:e?d:[]}]}var v,r;0===n.length&&0===(null===(i=l.data.stocks)||void 0===i?void 0:i.length)&&(t=[{price:void 0,quantity:0,sku:null===B||void 0===B||null===(v=B.data)||void 0===v?void 0:v.sku,tax:(null===(r=B.data)||void 0===r?void 0:r.tax)||0,addons:[]}]);const m=t.concat(o);(0,h.vA)((()=>{I((0,p.GV)(m)),I((0,p.fv)()),I((0,p.dr)()),I((0,p.yw)())})),$.setFieldsValue({stocks:m})})).finally((()=>{K(!1)}))},T=async l=>{var e;const d={search:l,addon:1,shop_id:null===B||void 0===B||null===(e=B.data)||void 0===e?void 0:e.shop_id,"statuses[0]":"published","statuses[1]":"pending",active:1},i=await W(_).getAll(d).then((l=>l.data.map((l=>{var e;return{label:null===l||void 0===l||null===(e=l.translation)||void 0===e?void 0:e.title,value:null===l||void 0===l?void 0:l.id}}))))||[];return null!==i&&void 0!==i&&i.length?[{label:N("all.addons"),value:"all",key:"all"},...i]:[]};return(0,s.useEffect)((()=>{L(),I((0,m.km)(B))}),[C]),(0,x.A)((()=>{B.refetch&&(L(),I((0,m.km)(B)))}),[B.refetch]),(0,q.jsxs)(i.A,{onFinish:l=>{var e,d;const{stocks:i}=l,n=null!==M&&void 0!==M&&M.some((l=>{var e;return!(null===l||void 0===l||null===(e=l.extras)||void 0===e||!e.length)}))?((l,e,d)=>{var i;return null===e||void 0===e||null===(i=e.map((e=>(null===l||void 0===l?void 0:l.find((l=>{var d;return null===e||void 0===e||null===(d=e.extras)||void 0===d?void 0:d.every((e=>{var d;return null===l||void 0===l||null===(d=l.extras)||void 0===d?void 0:d.find((l=>(null===l||void 0===l?void 0:l.value)===(null===e||void 0===e?void 0:e.value)))}))})))||e)))||void 0===i?void 0:i.filter((l=>!(null!==d&&void 0!==d&&d.includes(null===l||void 0===l?void 0:l.stock_id))))})(i,M,E):i;let o;var t,a,s,u,v,r,c;null!==(e=B.data)&&void 0!==e&&null!==(d=e.extras)&&void 0!==d&&d.length?o=n.map((l=>{var e,d,i,n;return{price:null===l||void 0===l?void 0:l.price,quantity:null===l||void 0===l?void 0:l.quantity,sku:null===l||void 0===l?void 0:l.sku,ids:w?null===(e=B.data)||void 0===e?void 0:e.extras.map(((e,d)=>l[`extras[${d}]`])):null===(d=B.data)||void 0===d?void 0:d.extras.map(((e,d)=>{var i;return null===l||void 0===l||null===(i=l[`extras[${d}]`])||void 0===i?void 0:i.value})),addons:null!==l&&void 0!==l&&l.addons?w?null===l||void 0===l||null===(i=l.addons)||void 0===i?void 0:i.map((l=>l)):null===l||void 0===l||null===(n=l.addons)||void 0===n?void 0:n.map((l=>null===l||void 0===l?void 0:l.value)):[],stock_id:null===l||void 0===l?void 0:l.stock_id}})):o=[{price:null===n||void 0===n||null===(t=n[0])||void 0===t?void 0:t.price,quantity:null===n||void 0===n||null===(a=n[0])||void 0===a?void 0:a.quantity,addons:null!==n&&void 0!==n&&null!==(s=n[0])&&void 0!==s&&s.addons?w?null===n||void 0===n||null===(u=n[0])||void 0===u?void 0:u.addons.map((l=>l)):null===n||void 0===n||null===(v=n[0])||void 0===v?void 0:v.addons.map((l=>null===l||void 0===l?void 0:l.value)):[],stock_id:null===n||void 0===n||null===(r=n[0])||void 0===r?void 0:r.stock_id,sku:null===n||void 0===n||null===(c=n[0])||void 0===c?void 0:c.sku,ids:[]}];if(w)return I((0,m.Ok)({activeMenu:B,data:{...B.data,stocks:o,delete_ids:E}})),void g();U(!0),W(_).stocks(C,{extras:o,delete_ids:E}).then((l=>{(0,h.vA)((()=>{var e;const d=null===l||void 0===l||null===(e=l.data)||void 0===e?void 0:e.stocks,i=null===d||void 0===d?void 0:d.flatMap((l=>l.extras)),n=i.map((l=>{var e;return{...null===l||void 0===l?void 0:l.value,stock_id:null===l||void 0===l?void 0:l.stock_id,group_type:null===l||void 0===l||null===(e=l.group)||void 0===e?void 0:e.type}})),t=null===i||void 0===i?void 0:i.find((l=>"color"===l.group.type));I((0,m.IU)({...B,data:{...B.data,newExtras:[{group:null===t||void 0===t?void 0:t.group,values:n}],stocks:o,delete_ids:E},refetch:!0})),I((0,p.dr)()),I((0,p.yw)()),I((0,p.pY)()),I((0,p.fv)())})),k.oR.success(N("successfully.updated")),g()})).finally((()=>U(!1)))},form:$,layout:"vertical",children:[!(null===(e=B.data)||void 0===e||null===(d=e.extras)||void 0===d||!d.length)&&(0,q.jsx)(n.A,{children:(0,q.jsx)(F,{form:$,fetchAddonOptions:T})}),!(null===(v=B.data)||void 0===v||null===(r=v.extras)||void 0===r||!r.length)&&(0,q.jsx)(O,{extras:null===(f=B.data)||void 0===f?void 0:f.extras,form:$}),(0,q.jsx)(n.A,{loading:G,children:(0,q.jsx)(o.A,{defaultActiveKey:["stocks"],children:(0,q.jsx)(o.A.Panel,{header:N("stocks"),children:null===(y=Object.values(R))||void 0===y||!y.length||null!==S&&void 0!==S&&S.length?(0,q.jsx)(V,{fetchAddonOptions:T,form:$}):(0,q.jsx)(j.A,{})},"stocks")})}),(0,q.jsx)(n.A,{children:(0,q.jsxs)(t.A,{children:[(0,q.jsx)(a.A,{onClick:b,children:N("prev")}),(0,q.jsx)(a.A,{type:"primary",htmlType:"submit",loading:P,children:N("next")})]})})]})}},68387:(l,e,d)=>{d.d(e,{P:()=>i});const i=function(){let l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let d="";for(let i=0;i<l;i++){d+=e[Math.floor(62*Math.random())]}return d}}}]);