"use strict";(self.webpackChunkjumlajumla_dashboard=self.webpackChunkjumlajumla_dashboard||[]).push([[8591],{8168:(e,l,n)=>{function d(e){switch(e){case"ascend":return"asc";case"descend":return"desc"}}n.d(l,{A:()=>d})},58591:(e,l,n)=>{n.r(l),n.d(l,{default:()=>E});var d=n(9950),i=n(80737),a=n(20978),t=n(12916),o=n(48538),s=n(23263),r=n(12203),u=n(91854),v=n(74623),c=n(70030),h=n(65270),m=n(88986),x=n(8168),p=n(24513),j=n(12678),g=n(32645),A=n(91524),b=n(44414);function f(e){var l,n,d,i,a,t,s,r,u,v;let{data:h,handleClose:m}=e;const{t:x}=(0,c.B)();return(0,b.jsx)(g.A,{title:x("request.details"),visible:!!h,onCancel:m,footer:(0,b.jsx)(o.A,{type:"default",onClick:m,children:x("cancel")}),children:(0,b.jsxs)(A.A,{bordered:!0,children:[(0,b.jsx)(A.A.Item,{span:3,label:x("id"),children:null===h||void 0===h?void 0:h.id}),(0,b.jsx)(A.A.Item,{span:3,label:x("firstname"),children:x(null===h||void 0===h||null===(l=h.model)||void 0===l?void 0:l.firstname)}),(0,b.jsx)(A.A.Item,{span:3,label:x("lastname"),children:x(null===h||void 0===h||null===(n=h.model)||void 0===n?void 0:n.lastname)}),(0,b.jsxs)(A.A.Item,{span:3,label:x("car"),children:[x(null===h||void 0===h||null===(d=h.data)||void 0===d?void 0:d.brand)," ",x(null===h||void 0===h||null===(i=h.data)||void 0===i?void 0:i.model)]}),(0,b.jsx)(A.A.Item,{span:3,label:x("car.number"),children:x(null===h||void 0===h||null===(a=h.data)||void 0===a?void 0:a.number)}),(0,b.jsx)(A.A.Item,{span:3,label:x("color"),children:x(null===h||void 0===h||null===(t=h.data)||void 0===t?void 0:t.color)}),(0,b.jsxs)(A.A.Item,{span:3,label:x("height"),children:[x(null===h||void 0===h||null===(s=h.data)||void 0===s?void 0:s.height),"  ",x("m")]}),(0,b.jsxs)(A.A.Item,{span:3,label:x("width"),children:[x(null===h||void 0===h||null===(r=h.data)||void 0===r?void 0:r.width),"  ",x("m")]}),(0,b.jsx)(A.A.Item,{span:3,label:x("status"),children:null!==h&&void 0!==h&&null!==(u=h.data)&&void 0!==u&&u.online?x("online"):x("offline")}),(0,b.jsx)(A.A.Item,{span:3,label:x("fuel"),children:x(null===h||void 0===h||null===(v=h.data)||void 0===v?void 0:v.type_of_technique)})]})})}var w=n(3969),y=n(87094),C=n(41988),k=n(99674),I=n(55902);const _=["pending","approved","canceled"];function S(e){let{data:l,handleClose:n,handleChange:i}=e;const{t:a}=(0,c.B)(),[t]=w.A.useForm(),[s,r]=(0,d.useState)(!1),[u,v]=(0,d.useState)(null===l||void 0===l?void 0:l.status);return(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(g.A,{title:a("status.change"),visible:!!l,onCancel:n,footer:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(o.A,{type:"default",onClick:n,children:a("cancel")}),(0,b.jsx)(o.A,{type:"primary",onClick:()=>t.submit(),loading:s,children:a("save")})]}),children:(0,b.jsx)(w.A,{form:t,layout:"vertical",onFinish:e=>{r(!0),i(null===l||void 0===l?void 0:l.id,e).final((()=>r(!1)))},initialValues:{status:null===l||void 0===l?void 0:l.status},children:(0,b.jsx)(y.A,{gutter:12,children:(0,b.jsxs)(C.A,{span:24,children:[(0,b.jsx)(w.A.Item,{label:a("status"),name:"status",rules:[{required:!0,message:a("required")}],children:(0,b.jsx)(k.A,{onChange:e=>v(e),children:_.map(((e,l)=>(0,b.jsx)(k.A.Option,{value:e,children:a(e)},e+l)))})}),"canceled"===u?(0,b.jsx)(w.A.Item,{name:"status_note",label:a("note"),rules:[{validator:(e,l)=>l?l&&""===(null===l||void 0===l?void 0:l.trim())?Promise.reject(new Error(a("no.empty.space"))):l&&(null===l||void 0===l?void 0:l.trim().length)<2?Promise.reject(new Error(a("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(a("required")))}],children:(0,b.jsx)(I.A.TextArea,{maxLength:250,showCount:!0})}):""]})})})})})}var P=n(98890),q=n(12449);function E(){const e=(0,u.wA)(),{t:l}=(0,c.B)(),{activeMenu:n}=(0,u.d4)((e=>e.menu),u.bN),{deliverymanRequestData:g,meta:A,loading:w}=(0,u.d4)((e=>e.deliverymanRequest),u.bN),[y,C]=(0,d.useState)(null),[k,I]=(0,d.useState)(null),[_,E]=(0,d.useState)(null),F=n.data,R={perPage:null===F||void 0===F?void 0:F.perPage,page:null===F||void 0===F?void 0:F.page,search:null===F||void 0===F?void 0:F.search,columns:null===F||void 0===F?void 0:F.columns};(0,m.A)((()=>{e((0,h.i)(R))}),[null===n||void 0===n?void 0:n.data]),(0,d.useEffect)((()=>{null!==n&&void 0!==n&&n.refetch&&(e((0,h.i)(R)),e((0,v.km)(n)))}),[null===n||void 0===n?void 0:n.refetch]);const B={selectedRowKeys:y,onChange:e=>{C(e)}};const N=[{title:l("id"),dataIndex:"id",key:"id",is_show:!0},{title:l("name"),dataIndex:"name",key:"name",is_show:!0,render:(e,l)=>{var n,d;return(null===l||void 0===l||null===(n=l.model)||void 0===n?void 0:n.firstname)+" "+(null===l||void 0===l||null===(d=l.model)||void 0===d?void 0:d.lastname)}},{title:l("delivery.man.setting"),dataIndex:"setting",key:"setting",is_show:!0,render:(e,n)=>{var d,a,t,o;return(0,b.jsx)(i.A,{children:(0,b.jsxs)("span",{children:[l("brand"),": ",null===n||void 0===n||null===(d=n.data)||void 0===d?void 0:d.brand,(0,b.jsx)("br",{}),l("model"),": ",null===n||void 0===n||null===(a=n.data)||void 0===a?void 0:a.model,(0,b.jsx)("br",{}),l("number"),": ",null===n||void 0===n||null===(t=n.data)||void 0===t?void 0:t.number,(0,b.jsx)("br",{}),l("color"),": ",null===n||void 0===n||null===(o=n.data)||void 0===o?void 0:o.color]})})}},{title:l("image"),dataIndex:"image",key:"image",is_show:!0,render:(e,l)=>{var n;return(0,b.jsx)(a.A,{src:(null===l||void 0===l||null===(n=l.data)||void 0===n?void 0:n["images[0]"])||"https://via.placeholder.com/100",alt:"img",width:100,className:"rounded",preview:!0,placeholder:!0})}},{title:l("status"),dataIndex:"status",key:"status",is_show:!0,render:(e,n)=>(0,b.jsxs)("div",{children:["pending"===e?(0,b.jsx)(t.A,{color:"blue",children:l(e)}):"canceled"===e?(0,b.jsx)(t.A,{color:"error",children:l(e)}):(0,b.jsx)(t.A,{color:"cyan",children:l(e)}),n.deleted_at?"":(0,b.jsx)(p.A,{onClick:()=>E(n)})]})},{title:l("options"),key:"options",dataIndex:"options",is_show:!0,render:(e,l)=>(0,b.jsx)(i.A,{children:(0,b.jsx)(o.A,{icon:(0,b.jsx)(j.A,{}),onClick:e=>{e.stopPropagation(),I(l)}})})}];return(0,b.jsxs)(s.A,{title:l("deliveryman.request"),children:[(0,b.jsx)(r.A,{scroll:{x:!0},rowSelection:B,columns:null===N||void 0===N?void 0:N.filter((e=>null===e||void 0===e?void 0:e.is_show)),dataSource:g,pagination:{pageSize:null===A||void 0===A?void 0:A.perPage,total:null===A||void 0===A?void 0:A.total,current:null===F||void 0===F?void 0:F.page,page:(null===F||void 0===F?void 0:F.page)||1,defaultCurrent:null===F||void 0===F?void 0:F.page},onChange:function(l,d,i){const{pageSize:a,current:t}=l,{field:o,order:s}=i,r=(0,x.A)(s);e((0,v.Ok)({activeMenu:n,data:{...null===n||void 0===n?void 0:n.data,perPage:a,page:t,column:o,sort:r}}))},rowKey:e=>null===e||void 0===e?void 0:e.id,loading:w}),k?(0,b.jsx)(f,{data:k,handleClose:()=>I(null)}):null,_?(0,b.jsx)(S,{data:_,handleChange:(d,i)=>{const a={status_note:null===i||void 0===i?void 0:i.status_note,status:null===i||void 0===i?void 0:i.status};return P.A.changeStatus(d,a).then((()=>{E(null),q.oR.success(l("successfully.updated")),e((0,h.i)(R)),e((0,v.km)(n))}))},handleClose:()=>E(null)}):null]})}}}]);