"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[7497],{97388:(e,r,l)=>{l.d(r,{Z:()=>g});var s=l(47313),a=l(16609);const i=l.p+"static/media/pin.0e41858db80c699cd8a2.png";var n=l(31881),o=l.n(n),t=l(97421);async function d(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.kr,l={latlng:`${null===e||void 0===e?void 0:e.lat},${null===e||void 0===e?void 0:e.lng}`,key:r};return o().get("https://maps.googleapis.com/maps/api/geocode/json",{params:l}).then((e=>{var r;let{data:l}=e;return null===(r=l.results[0])||void 0===r?void 0:r.formatted_address})).catch((e=>"not found"))}var m=l(59392),c=l(23560),u=l(24511),v=l(307),h=l(46417);const p=(0,v.Z)();const g=(0,a.GoogleApiWrapper)({apiKey:p,libraries:["places","geometry"]})((function(e){var r,l;const[n,o]=(0,s.useState)(),{t:t}=(0,u.$)(),v=async()=>{await navigator.geolocation.getCurrentPosition((function(e){const r={lat:e.coords.latitude,lng:e.coords.longitude};o(r)}),(function(e){c.Am.warning(t("turn.on.gps"))}))};(0,s.useEffect)((()=>{v()}),[]);const g=[{lat:Number(null===e||void 0===e||null===(r=e.location)||void 0===r?void 0:r.lat)||0,lng:Number(null===e||void 0===e||null===(l=e.location)||void 0===l?void 0:l.lng)||0}];for(var j=new e.google.maps.LatLngBounds,x=0;x<g.length;x++)j.extend(g[x]);return(0,h.jsxs)("div",{className:"map-container",style:{height:400,width:"100%"},children:[(0,h.jsx)("button",{className:"map-button",type:"button",onClick:()=>{v(),n&&(async r=>{const l={lat:null===r||void 0===r?void 0:r.lat,lng:null===r||void 0===r?void 0:r.lng};e.setLocation(l);const s=await d(l,p);e.setAddress(s)})(n)},children:(0,h.jsx)(m.nDs,{})}),(0,h.jsx)(a.Map,{cursor:"pointer",onClick:async(r,l,s)=>{const{latLng:a}=s,i={lat:a.lat(),lng:a.lng()};e.setLocation(i);const n=await d(i,p);e.setAddress(n)},google:e.google,defaultZoom:12,zoom:10,className:"clickable",initialCenter:e.location,center:e.location,children:(0,h.jsx)(a.Marker,{position:e.location,icon:{url:i,scaledSize:new e.google.maps.Size(32,32)},className:"marker"})})]})}))},89281:(e,r,l)=>{l.d(r,{h:()=>d});var s=l(47313),a=l(12279),i=l.n(a),n=l(74294),o=l(72652),t=l(46417);const d=e=>{let{fetchOptions:r,debounceTimeout:l=400,onClear:a,...d}=e;const[m,c]=(0,s.useState)(!1),[u,v]=(0,s.useState)([]),h=(0,s.useMemo)((()=>i()((e=>{v([]),c(!0),r(e).then((e=>{v(e),c(!1)}))}),l)),[r,l]);return(0,t.jsx)(n.Z,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:h,onClear:()=>{h(""),a&&a()},notFoundContent:m?(0,t.jsx)(o.Z,{size:"small"}):"no results",...d,options:u,onFocus:()=>{h("")}})}},17649:(e,r,l)=>{l.d(r,{Z:()=>s});l(97421);function s(e){if(null===e||void 0===e||!e.location)return{lat:47.4143302506288,lng:8.532059477976883};const r=e.location.split(", ");return{lat:Number(null===r||void 0===r?void 0:r[0]),lng:Number(null===r||void 0===r?void 0:r[1])}}},307:(e,r,l)=>{l.d(r,{Z:()=>i});var s=l(67968),a=l(97421);const i=()=>{var e,r;const{google_map_key:l}=null===(e=s.h.getState())||void 0===e||null===(r=e.globalSettings)||void 0===r?void 0:r.settings;return l||a.kr}},68652:(e,r,l)=>{l.r(r),l.d(r,{default:()=>A});var s=l(47313),a=l(10976),i=l(77181),n=l(68197),o=l(59624),t=l(66672),d=l(16124),m=l(99096),c=l(74294),u=l(46155),v=l(59491),h=l(97890),p=l(23560),g=l(2717),j=l(90954),x=l(49986),Z=l(24511),b=l(70816),w=l.n(b),f=l(75868),y=l(89281),P=l(53149),q=l(84304),_=l(45321),k=l(17649),E=l(86345),I=l(97388),N=l(46417);const S=[{label:"Benzine",value:"benzine"},{label:"Diesel",value:"diesel"},{label:"Gas",value:"gas"},{label:"Motorbike",value:"motorbike"},{label:"Bike",value:"bike"},{label:"Foot",value:"foot"},{label:"Electric",value:"electric"}],C=e=>{let{location:r,setLocation:l,form:s,image:i,setImage:m}=e;const{t:u}=(0,Z.$)();return(0,N.jsxs)(n.Z,{gutter:12,children:[(0,N.jsx)(o.Z,{span:12,children:(0,N.jsx)(a.Z.Item,{label:u("brand"),name:"brand",rules:[{validator:(e,r)=>r?r&&""===(null===r||void 0===r?void 0:r.trim())?Promise.reject(new Error(u("no.empty.space"))):r&&(null===r||void 0===r?void 0:r.trim().length)<2?Promise.reject(new Error(u("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(u("required")))}],children:(0,N.jsx)(t.Z,{})})}),(0,N.jsx)(o.Z,{span:12,children:(0,N.jsx)(a.Z.Item,{label:u("model"),name:"model",rules:[{validator:(e,r)=>r?r&&""===(null===r||void 0===r?void 0:r.trim())?Promise.reject(new Error(u("no.empty.space"))):r&&(null===r||void 0===r?void 0:r.trim().length)<2?Promise.reject(new Error(u("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(u("required")))}],children:(0,N.jsx)(t.Z,{})})}),(0,N.jsx)(o.Z,{span:12,children:(0,N.jsx)(a.Z.Item,{label:u("type.of.technique"),name:"type_of_technique",rules:[{required:!0,message:u("required")}],children:(0,N.jsx)(c.Z,{options:S})})}),(0,N.jsx)(o.Z,{span:12,children:(0,N.jsx)(a.Z.Item,{label:u("car.number"),name:"number",rules:[{validator:(e,r)=>r?r&&""===(null===r||void 0===r?void 0:r.trim())?Promise.reject(new Error(u("no.empty.space"))):r&&(null===r||void 0===r?void 0:r.trim().length)<2?Promise.reject(new Error(u("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(u("required")))}],children:(0,N.jsx)(t.Z,{})})}),(0,N.jsx)(o.Z,{span:12,children:(0,N.jsx)(a.Z.Item,{label:u("car.color"),name:"color",rules:[{validator:(e,r)=>r?r&&""===(null===r||void 0===r?void 0:r.trim())?Promise.reject(new Error(u("no.empty.space"))):r&&(null===r||void 0===r?void 0:r.trim().length)<2?Promise.reject(new Error(u("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(u("required")))}],children:(0,N.jsx)(t.Z,{})})}),(0,N.jsx)(o.Z,{span:12,children:(0,N.jsx)(a.Z.Item,{label:u("height"),name:"height",rules:[{validator:(e,r)=>r||0===r?!r||r<1?Promise.reject(new Error(u("min.1"))):Promise.resolve():Promise.reject(new Error(u("required")))}],children:(0,N.jsx)(d.Z,{className:"w-100",addonAfter:"sm"})})}),(0,N.jsx)(o.Z,{span:12,children:(0,N.jsx)(a.Z.Item,{label:u("weight"),name:"kg",rules:[{validator:(e,r)=>r||0===r?!r||r<1?Promise.reject(new Error(u("min.1"))):Promise.resolve():Promise.reject(new Error(u("required")))}],children:(0,N.jsx)(d.Z,{className:"w-100",addonAfter:"kg"})})}),(0,N.jsx)(o.Z,{span:12,children:(0,N.jsx)(a.Z.Item,{label:u("length"),name:"length",rules:[{validator:(e,r)=>r||0===r?!r||r<1?Promise.reject(new Error(u("min.1"))):Promise.resolve():Promise.reject(new Error(u("required")))}],children:(0,N.jsx)(d.Z,{className:"w-100",addonAfter:"sm"})})}),(0,N.jsx)(o.Z,{span:12,children:(0,N.jsx)(a.Z.Item,{label:u("width"),name:"width",rules:[{validator:(e,r)=>r||0===r?!r||r<1?Promise.reject(new Error(u("min.1"))):Promise.resolve():Promise.reject(new Error(u("required")))}],children:(0,N.jsx)(d.Z,{className:"w-100",addonAfter:"sm"})})}),(0,N.jsx)(o.Z,{span:12,children:(0,N.jsx)(a.Z.Item,{label:u("image"),name:"images",rules:[{validator:()=>0===(null===i||void 0===i?void 0:i.length)?Promise.reject(new Error(u("required"))):Promise.resolve()}],children:(0,N.jsx)(f.Z,{type:"deliveryman/settings",imageList:i,setImageList:m,form:s,length:"1",multiple:!0})})}),(0,N.jsx)(o.Z,{span:6,children:(0,N.jsx)(a.Z.Item,{label:u("online"),name:"online",rules:[{required:!0,message:u("required")}],valuePropName:"checked",children:(0,N.jsx)(E.Z,{})})}),(0,N.jsx)(o.Z,{span:24,children:(0,N.jsx)(a.Z.Item,{label:u("map"),name:"location",children:(0,N.jsx)(I.Z,{location:r,setLocation:l})})})]})};var L=l(81566);function A(){var e,r;const{t:l}=(0,Z.$)(),[b]=a.Z.useForm(),[E,I]=(0,s.useState)(),[S,A]=(0,s.useState)(null),[O,F]=(0,s.useState)(!1),z=(0,h.s0)(),$=(0,g.v9)((e=>e.user),g.wU),{role:M}=(0,h.UO)(),{settings:V}=(0,g.v9)((e=>e.globalSettings),g.wU),[T,U]=(0,s.useState)((0,k.Z)(V));(0,s.useEffect)((()=>()=>{const e=b.getFieldsValue(!0);e.birthday=JSON.stringify(null===e||void 0===e?void 0:e.birthday),G((0,j.nc)({activeMenu:D,data:{...D.data,...e}}))}),[]);const B=(0,h.TH)(),D=(0,g.v9)((e=>e.menu.activeMenu)),G=(0,g.I0)(),[J,W]=(0,s.useState)(null!==D&&void 0!==D&&null!==(e=D.data)&&void 0!==e&&e.image?[null===D||void 0===D||null===(r=D.data)||void 0===r?void 0:r.image]:[]),[H,K]=(0,s.useState)([]);async function Q(e){const r={search:e,status:"approved"};return P.Z.search(r).then((e=>e.data.map((e=>({label:null!==e.translation?e.translation.title:"no name",value:e.id})))))}return(0,N.jsx)(i.Z,{title:l("add.user"),children:(0,N.jsx)(a.Z,{form:b,layout:"vertical",initialValues:{online:!0,gender:"male",...(()=>{var e,r;if(null===(e=D.data)||void 0===e||!e.birthday)return{};const l=JSON.parse(null===(r=D.data)||void 0===r?void 0:r.birthday);return{birthday:w()(l)}})()},onFinish:e=>{var r,s;F(!0);const a={firstname:e.firstname,lastname:e.lastname,email:e.user_email,phone:e.phone,birthday:E,gender:e.gender,password_confirmation:e.password_confirmation,password:e.password,images:J[0]?[null===(r=J[0])||void 0===r?void 0:r.name]:void 0,shop_id:null!==e&&void 0!==e&&e.shop_id?void 0!==(null===e||void 0===e?void 0:e.shop_id.length)?null===e||void 0===e||null===(s=e.shop_id)||void 0===s?void 0:s.map((e=>e.value)):[null===e||void 0===e?void 0:e.shop_id.value]:void 0,role:M||void 0,online:Number(e.online),height:e.height,kg:e.kg,length:e.length,price:e.price,price_per_km:e.price_per_km,width:e.width},i=B.pathname.search("/user/delivery/")?"deliveries/list":"users/admin";console.log(i),x.Z.create(a).then((r=>{let{data:s}=r;if("deliveryman"===M){const r={color:e.color,number:e.number,type_of_technique:e.type_of_technique,brand:e.brand,model:e.model,user_id:s.id,images:J.map((e=>e.name)),location:{latitude:T.lat,longitude:T.lng},online:Number(e.online),height:e.height,kg:e.kg,length:e.length,price:e.price,price_per_km:e.price_per_km,width:e.width};_.Z.create(r).then((()=>{p.Am.success(l("successfully.created")),G((0,j.ph)({...D,nextUrl:i})),z(`/${i}`),G(B.pathname.search("/user/delivery/")?(0,L.W)():(0,q.uh)({role:M}))}))}else{const e="users/admin",r={...$.params,role:s.role};G((0,j.ph)({...D,menu:e})),z(`/${e}`),G((0,q.uh)(r))}b.resetFields()})).catch((e=>{var r,l,s,a,i,n,o,t,d;null!==e&&void 0!==e&&null!==(r=e.response)&&void 0!==r&&null!==(l=r.data)&&void 0!==l&&l.params&&(p.Am.dismiss(),null===(o=Object.values(null===e||void 0===e||null===(t=e.response)||void 0===t||null===(d=t.data)||void 0===d?void 0:d.params))||void 0===o||o.map((e=>p.Am.error(e[0]))));console.log(null===e||void 0===e||null===(s=e.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.params),A(null===e||void 0===e||null===(i=e.response)||void 0===i||null===(n=i.data)||void 0===n?void 0:n.params)})).finally((()=>F(!1)))},children:(0,N.jsxs)(n.Z,{gutter:12,children:[(0,N.jsx)(o.Z,{span:24,children:(0,N.jsx)(a.Z.Item,{rules:[{validator:()=>0===(null===J||void 0===J?void 0:J.length)?Promise.reject(new Error(l("required"))):Promise.resolve()}],name:"images",label:l("avatar"),children:(0,N.jsx)(f.Z,{type:"users",imageList:J,setImageList:W,form:b,multiple:!1})})}),(0,N.jsx)(o.Z,{span:12,children:(0,N.jsx)(a.Z.Item,{label:l("firstname"),name:"firstname",help:null!==S&&void 0!==S&&S.firstname?S.firstname[0]:null,validateStatus:null!==S&&void 0!==S&&S.firstname?"error":"success",rules:[{validator:(e,r)=>r?r&&""===(null===r||void 0===r?void 0:r.trim())?Promise.reject(new Error(l("no.empty.space"))):r&&(null===r||void 0===r?void 0:r.trim().length)<2?Promise.reject(new Error(l("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(l("required")))}],children:(0,N.jsx)(t.Z,{})})}),(0,N.jsx)(o.Z,{span:12,children:(0,N.jsx)(a.Z.Item,{label:"lastname",name:"lastname",help:null!==S&&void 0!==S&&S.lastname?S.lastname[0]:null,validateStatus:null!==S&&void 0!==S&&S.lastname?"error":"success",rules:[{validator:(e,r)=>r?r&&""===(null===r||void 0===r?void 0:r.trim())?Promise.reject(new Error(l("no.empty.space"))):r&&(null===r||void 0===r?void 0:r.trim().length)<2?Promise.reject(new Error(l("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(l("required")))}],children:(0,N.jsx)(t.Z,{})})}),(0,N.jsx)(o.Z,{span:12,children:(0,N.jsx)(a.Z.Item,{label:l("phone"),name:"phone",help:null!==S&&void 0!==S&&S.phone?S.phone[0]:null,validateStatus:null!==S&&void 0!==S&&S.phone?"error":"success",rules:[{required:!0,message:l("required")}],children:(0,N.jsx)(d.Z,{min:0,className:"w-100"})})}),(0,N.jsx)(o.Z,{span:12,children:(0,N.jsx)(a.Z.Item,{label:l("birthday"),name:"birthday",rules:[{required:!0,message:l("required")}],children:(0,N.jsx)(m.Z,{onChange:(e,r)=>I(r),className:"w-100",disabledDate:e=>w()().add(-18,"years")<=e,defaultPickerValue:w()().add(-18,"years")})})}),(0,N.jsx)(o.Z,{span:12,children:(0,N.jsx)(a.Z.Item,{label:l("gender"),name:"gender",rules:[{required:!0,message:l("required")}],children:(0,N.jsxs)(c.Z,{picker:"dayTime",className:"w-100",children:[(0,N.jsx)(c.Z.Option,{value:"male",children:l("male")}),(0,N.jsx)(c.Z.Option,{value:"female",children:l("female")})]})})}),(0,N.jsx)(o.Z,{span:12,children:(0,N.jsx)(a.Z.Item,{label:l("email"),name:"user_email",help:null!==S&&void 0!==S&&S.email?S.email[0]:null,validateStatus:null!==S&&void 0!==S&&S.email?"error":"success",rules:[{required:!0,message:l("required")},{type:"email",message:l("invalid.email")}],children:(0,N.jsx)(t.Z,{type:"email"})})}),(0,N.jsx)(o.Z,{span:12,children:(0,N.jsx)(a.Z.Item,{label:l("password"),name:"password",help:null!==S&&void 0!==S&&S.password?S.password[0]:null,validateStatus:null!==S&&void 0!==S&&S.password?"error":"success",rules:[{required:!0,message:l("required")},{validator:(e,r)=>r&&(null===r||void 0===r?void 0:r.length)<6?Promise.reject(new Error(l("min.6.letters"))):Promise.resolve()}],normalize:e=>""===(null===e||void 0===e?void 0:e.trim())?null===e||void 0===e?void 0:e.trim():e,children:(0,N.jsx)(t.Z.Password,{type:"password",className:"w-100"})})}),"admin"!==M&&"manager"!==M&&"moderator"!==M&&"seller"!==M&&"cook"!==M&&"user"!==M&&(0,N.jsx)(o.Z,{span:12,children:(0,N.jsx)(a.Z.Item,{label:l("shop"),name:"shop_id",rules:[{required:!0,message:l("required")}],children:(0,N.jsx)(y.h,{mode:"multiple",className:"w-100",placeholder:l("select.shop"),fetchOptions:Q,allowClear:!1})})}),"cook"===M&&(0,N.jsx)(o.Z,{span:12,children:(0,N.jsx)(a.Z.Item,{label:l("shop"),name:"shop_id",rules:[{required:!0,message:l("required")}],children:(0,N.jsx)(y.h,{fetchOptions:Q,className:"w-100",placeholder:l("select.shop"),allowClear:!1})})}),"moderator"===M&&(0,N.jsx)(o.Z,{span:12,children:(0,N.jsx)(a.Z.Item,{label:l("branches"),name:"shop_id",rules:[{required:!0,message:l("required")}],children:(0,N.jsx)(y.h,{fetchOptions:Q,className:"w-100",placeholder:l("select.shop"),allowClear:!1})})}),(0,N.jsx)(o.Z,{span:12,children:(0,N.jsx)(a.Z.Item,{label:l("password.confirmation"),help:null!==S&&void 0!==S&&S.password_confirmation?S.password_confirmation[0]:null,validateStatus:null!==S&&void 0!==S&&S.password_confirmation?"error":"success",name:"password_confirmation",dependencies:["password"],hasFeedback:!0,rules:[{required:!0,message:l("required")},e=>{let{getFieldValue:r}=e;return{validator:(e,s)=>s&&r("password")!==s?Promise.reject(l("two.passwords.dont.match")):Promise.resolve()}}],normalize:e=>""===(null===e||void 0===e?void 0:e.trim())?null===e||void 0===e?void 0:e.trim():e,children:(0,N.jsx)(t.Z.Password,{type:"password"})})}),"deliveryman"===M&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(u.Z,{className:"pt-3 pb-3",dashed:!0,orientation:"left",plain:!0,children:l("deliveryman.settings")}),(0,N.jsx)(C,{setLocation:U,location:T,setImage:K,image:H,form:b})]}),(0,N.jsx)(o.Z,{span:24,children:(0,N.jsx)(v.Z,{type:"primary",htmlType:"submit",loading:O,children:l("save")})})]})})})}}}]);