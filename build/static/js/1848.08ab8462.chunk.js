"use strict";(self.webpackChunkjumlajumla_dashboard=self.webpackChunkjumlajumla_dashboard||[]).push([[1848],{51848:(e,r,t)=>{t.r(r),t.d(r,{default:()=>y});var a=t(9950),i=t(12916),s=t(48538),n=t(23263),d=t(55902),l=t(12203),m=t(32645),c=t(3969),u=t(80737),o=t(25933),p=t(87864),_=t(24513),h=t(87848),x=t(82371),A=t(59051),j=t.n(A),g=t(44414);const y=()=>{const[e,r]=(0,a.useState)([]),[t,A]=(0,a.useState)(!0),[y,f]=(0,a.useState)(""),[v,S]=(0,a.useState)({current:1,pageSize:10,total:0}),[b,k]=(0,a.useState)(!1),[I,C]=(0,a.useState)(null),[w,Y]=(0,a.useState)({ai_order_credits:0,is_premium:!1,premium_expires_at:null});(0,a.useEffect)((()=>{E()}),[v.current,y]);const E=async()=>{A(!0);try{const e={page:v.current,per_page:v.pageSize,search:y},t=await x.A.get("/api/v1/dashboard/admin/users",{params:e});r(t.data.data||[]),S({...v,total:t.data.total})}catch(e){console.error("Error fetching users:",e)}finally{A(!1)}},D=[{title:"ID",dataIndex:"id",key:"id",width:60},{title:"Name",dataIndex:"name",key:"name",render:(e,r)=>`${r.firstname} ${r.lastname}`},{title:"Email",dataIndex:"email",key:"email"},{title:"AI Order Credits",dataIndex:"ai_order_credits",key:"ai_order_credits",render:e=>(0,g.jsx)(i.A,{color:e>0?"blue":"default",children:e||0})},{title:"Premium Status",key:"premium_status",render:(e,r)=>(e=>{if(!e.is_premium)return(0,g.jsx)(i.A,{color:"default",children:"No"});if(e.premium_expires_at){const r=j()(e.premium_expires_at),t=j()();return r.isAfter(t)?(0,g.jsxs)(i.A,{color:"success",children:["Until ",r.format("YYYY-MM-DD")]}):(0,g.jsx)(i.A,{color:"warning",children:"Expired"})}return(0,g.jsx)(i.A,{color:"success",children:"Yes"})})(r)},{title:"Actions",key:"actions",render:(e,r)=>(0,g.jsx)(s.A,{type:"primary",icon:(0,g.jsx)(_.A,{}),size:"small",onClick:()=>{return C(e=r),Y({ai_order_credits:e.ai_order_credits||0,is_premium:e.is_premium||!1,premium_expires_at:e.premium_expires_at?j()(e.premium_expires_at):null}),void k(!0);var e}})}];return(0,g.jsxs)("div",{children:[(0,g.jsx)("h2",{className:"mb-4",children:"AI User Credits Management"}),(0,g.jsxs)(n.A,{className:"mb-4",children:[(0,g.jsx)("div",{style:{marginBottom:16},children:(0,g.jsx)(d.A.Search,{placeholder:"Search users...",value:y,onChange:e=>{f(e.target.value),S({...v,current:1})},onSearch:()=>E(),style:{width:300}})}),(0,g.jsx)(l.A,{columns:D,dataSource:e,rowKey:"id",loading:t,pagination:{current:v.current,pageSize:v.pageSize,total:v.total,onChange:e=>{S({...v,current:e})}}})]}),(0,g.jsx)(m.A,{title:`Edit AI Credits - ${null===I||void 0===I?void 0:I.firstname} ${null===I||void 0===I?void 0:I.lastname}`,open:b,onCancel:()=>k(!1),onOk:async()=>{try{const t={ai_order_credits:parseInt(w.ai_order_credits),is_premium:w.is_premium,premium_expires_at:w.premium_expires_at?w.premium_expires_at.format("YYYY-MM-DD HH:mm:ss"):null};await x.A.put(`/api/v1/dashboard/admin/ai-assistant/user-credits/${I.id}`,t),r(e.map((e=>e.id===I.id?{...e,...t}:e))),k(!1)}catch(t){console.error("Error updating user AI credits:",t)}},children:(0,g.jsxs)(c.A,{layout:"vertical",children:[(0,g.jsx)(c.A.Item,{label:"AI Order Credits",children:(0,g.jsx)(d.A,{type:"number",name:"ai_order_credits",placeholder:"Enter AI order credits",value:w.ai_order_credits,onChange:e=>{const r="checkbox"===e.target.type?e.target.checked:e.target.value;Y({...w,[e.target.name]:r})},min:"0"})}),(0,g.jsx)(c.A.Item,{label:"Premium Status",children:(0,g.jsxs)(u.A,{children:[(0,g.jsx)(o.A,{checked:w.is_premium,onChange:e=>{Y({...w,is_premium:e})}}),w.is_premium&&(0,g.jsxs)(i.A,{color:"blue",children:[(0,g.jsx)(h.A,{})," Premium"]})]})}),w.is_premium&&(0,g.jsx)(c.A.Item,{label:"Premium Expiration Date",children:(0,g.jsx)(p.A,{value:w.premium_expires_at,onChange:e=>{Y({...w,premium_expires_at:e})},style:{width:"100%"},disabledDate:e=>e&&e<j()().startOf("day")})})]})})]})}}}]);