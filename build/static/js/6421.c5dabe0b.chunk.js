"use strict";(self.webpackChunkjumlajumla_dashboard=self.webpackChunkjumlajumla_dashboard||[]).push([[6421],{12970:(l,e,i)=>{function o(l){var e,i;let o=null===l||void 0===l?void 0:l.slice(0,1),t=null===l||void 0===l?void 0:l.lastIndexOf("@"),a=null===l||void 0===l?void 0:l.slice(1,t-1);a=null===(e=a)||void 0===e?void 0:e.replace(/./g,"*");let n=null===l||void 0===l?void 0:l.slice(t-1,l.length);return null===o||void 0===o||null===(i=o.concat(a))||void 0===i?void 0:i.concat(n)}i.d(e,{A:()=>o})},51359:(l,e,i)=>{l.exports=i.p+"static/media/map.f2e0b3013d676ba09c88.gif"},66421:(l,e,i)=>{i.r(e),i.d(e,{default:()=>z});var o=i(9950),t=i(54909),a=i(3969),n=i(23263),d=i(13564),s=i(59051),r=i.n(s),u=i(53271),v=i(81446),c=i(91854),g=i(74623),m=i(70030),p=i(62466),h=i(13311),b=i(12970),f=i(1840),j=i(50273),x=i(90150),y=i(54766),k=i(50302),C=i(87094),A=i(41988),w=i(48538),S=i(70948),_=i(51359),F=i(12449),N=i(44414);const M=l=>{let{user_id:e}=l;const{t:i}=(0,m.B)(),[t]=a.A.useForm(),[d,s]=(0,o.useState)([]),[r,v]=(0,o.useState)(null),[c,g]=(0,o.useState)(!1),[p,h]=(0,o.useState)(!1);(0,o.useEffect)((()=>{var l;e&&(l=e,g(!0),u.A.showDeliverymanZone(l).then((l=>{var e;s(void 0!==l.data?null===(e=l.data)||void 0===e?void 0:e.map((l=>({lat:null===l||void 0===l?void 0:l[0],lng:null===l||void 0===l?void 0:l[1]}))):[])})).catch((l=>{404===l.response.status&&F.oR.dismiss(),console.log("err",l)})).finally((()=>{g(!1)})))}),[e]);return(0,N.jsx)(n.A,{loading:c,children:(0,N.jsxs)(a.A,{layout:"vertical",form:t,onFinish:()=>{if(!e)return void F.oR.error(i("no.user.id"));if(d.length<3)return void F.oR.warning(i("place.selected.map"));if(!r)return void F.oR.warning(i("place.selected.map"));const l={user_id:e,address:d.map((l=>({0:l.lat,1:l.lng})))};h(!0),u.A.createAndUpdateDeliverymanZone(l).then((()=>{F.oR.success(i("successfully.updated"))})).finally((()=>{h(!1)}))},children:[(0,N.jsxs)(C.A,{gutter:12,children:[(0,N.jsx)(A.A,{span:12,children:(0,N.jsx)("img",{src:_,alt:i("map.gif"),style:{object:"contain"}})}),(0,N.jsx)(A.A,{span:24,children:(0,N.jsx)(S.A,{triangleCoords:d,settriangleCoords:s,setMerge:v})})]}),(0,N.jsx)(w.A,{type:"primary",htmlType:"submit",loading:p,className:"mt-4",children:i("save")})]})})},{TabPane:O}=t.A,z=()=>{var l,e;const{t:i}=(0,m.B)(),[s]=a.A.useForm(),{activeMenu:C}=(0,c.d4)((l=>l.menu),c.bN),A=(0,c.wA)(),{uuid:w}=(0,d.g)(),[S,_]=(0,o.useState)(!1),[F,z]=(0,o.useState)("edit"),[R,Z]=(0,o.useState)([]),[P,W]=(0,o.useState)(null),B=null===C||void 0===C||null===(l=C.data)||void 0===l?void 0:l.role,{isDemo:L}=(0,h.A)();(0,o.useEffect)((()=>{null!==C&&void 0!==C&&C.refetch&&(l=>{_(!0),u.A.getById(l).then((l=>{var e,i,o,t,a,n,d,u;const v=l.data,c={...v,image:v.img?(0,p.A)(v.img):[]};A((0,g.Ok)({activeMenu:C,data:c})),s.setFieldsValue({firstname:v.firstname,lastname:v.lastname,email:L?(0,b.A)(v.email):v.email,phone:v.phone,birthday:r()(v.birthday),gender:v.gender,password_confirmation:v.password_confirmation,password:v.password,shop_id:0!==v.invitations.length?v.invitations.map((l=>{var e,i,o;return{label:null===(e=l.shop)||void 0===e||null===(i=e.translation)||void 0===i?void 0:i.title,value:null===(o=l.shop)||void 0===o?void 0:o.id}})):void 0,kitchen:{label:null===v||void 0===v||null===(e=v.kitchen)||void 0===e||null===(i=e.translation)||void 0===i?void 0:i.title,value:null===v||void 0===v||null===(o=v.kitchen)||void 0===o?void 0:o.id,key:null===v||void 0===v||null===(t=v.kitchen)||void 0===t?void 0:t.id},isWork:!(null===v||void 0===v||!v.isWork),table_ids:0!==(null===(a=v.tables)||void 0===a?void 0:a.length)?null===v||void 0===v||null===(n=v.tables)||void 0===n?void 0:n.map((l=>({label:null===l||void 0===l?void 0:l.name,value:null===l||void 0===l?void 0:l.id}))):void 0}),Z(v.img?[(0,p.A)(v.img)]:[]),W(null===(d=l.data)||void 0===d||null===(u=d.delivery_man_setting)||void 0===u?void 0:u.id)})).finally((()=>{_(!1),A((0,g.km)(C))}))})(w)}),[null===C||void 0===C?void 0:C.refetch]);return(0,N.jsx)(n.A,{title:i("user.settings"),children:S?(0,N.jsx)(v.A,{}):(0,N.jsxs)(t.A,{activeKey:F,onChange:l=>z(l),tabPosition:"left",size:"small",children:[(0,N.jsx)(O,{tab:i("edit.user"),children:(0,N.jsx)(j.A,{data:null===C||void 0===C?void 0:C.data,form:s,image:R,setImage:Z,action_type:"edit"})},"edit"),"cook"===B&&(0,N.jsx)(O,{tab:i("orders"),children:(0,N.jsx)(x.A,{data:null===C||void 0===C?void 0:C.data})},"order"),"deliveryman"===B&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(O,{tab:i("deliveryman"),children:(0,N.jsx)(f.A,{id:P,data:C.data})},"delivery"),(0,N.jsx)(O,{tab:i("deliveryman.zone"),children:(0,N.jsx)(M,{user_id:null===(e=C.data)||void 0===e?void 0:e.id})},"deliverymanzone")]}),(0,N.jsx)(O,{tab:i("wallet"),children:(0,N.jsx)(y.A,{data:null===C||void 0===C?void 0:C.data})},"wallet"),(0,N.jsx)(O,{tab:i("password"),children:(0,N.jsx)(k.A,{data:null===C||void 0===C?void 0:C.data})},"password")]})})}},70948:(l,e,i)=>{i.d(e,{A:()=>g});var o=i(97239),t=i(9950),a=i(52423),n=i(6566),d=i(83291),s=i(63620);const r=()=>{var l,e,i;const o=null===(l=d.M.getState())||void 0===l||null===(e=l.globalSettings)||void 0===e||null===(i=e.settings)||void 0===i?void 0:i.location;if(null!==o&&void 0!==o&&o.length){const l=null===o||void 0===o?void 0:o.split(",");return{lat:parseFloat(null===l||void 0===l?void 0:l[0]),lng:parseFloat(null===l||void 0===l?void 0:l[1])}}return{lat:s.it,lng:s.cz}};var u=i(44414);const v=(0,n.A)(),c=r(),g=(0,o.GoogleApiWrapper)({apiKey:v,libraries:["places"]})((l=>{var e,i;const[n,d]=(0,t.useState)(c),[s,r]=(0,t.useState)(l.triangleCoords?l.triangleCoords:[]),[v,g]=(0,t.useState)(!!l.triangleCoords),[m,p]=(0,t.useState)(null);l.setMerge(v);(0,t.useEffect)((()=>{p(!0)}),[]);const h=l.triangleCoords.map((l=>({lat:Number(l.lat||"0"),lng:Number(l.lng||"0")})));for(var b=new l.google.maps.LatLngBounds(n),f=0;f<h.length;f++)b.extend(h[f]);return(0,u.jsxs)("div",{className:"map-container",style:{height:500,width:"100%"},children:[(0,u.jsx)("button",{className:"map-button",type:"button",onClick:()=>{navigator.geolocation.getCurrentPosition((function(l){d({lat:l.coords.latitude,lng:l.coords.longitude})}))},children:(0,u.jsx)(a.uFi,{})}),(0,u.jsxs)(o.Map,{options:{minZoom:15,maxZoom:15},cursor:"pointer",onClick:(e,i,o)=>{p(!1);const{latLng:t}=o,a=t.lat(),n=t.lng();v?(r([]),l.settriangleCoords([{lat:a,lng:n}]),d({lat:a,lng:n}),g(!1)):l.settriangleCoords((l=>[...l,{lat:a,lng:n}]))},maxZoom:16,minZoom:2,google:l.google,initialCenter:c,center:n,onReady:function(l,e){e.setOptions({draggableCursor:"crosshair",draggingCursor:"grab"})},bounds:m&&b,className:"clickable",children:[null===(e=l.triangleCoords)||void 0===e?void 0:e.map(((e,i)=>(0,u.jsx)(o.Marker,{onClick:e=>(e=>{var i,o;g(!(null===l||void 0===l||!l.triangleCoords)),(null===(i=l.triangleCoords[0])||void 0===i?void 0:i.lat)===(null===(o=e.position)||void 0===o?void 0:o.lat)&&l.triangleCoords.length>1&&(r(l.triangleCoords),l.setLocation(l.triangleCoords),g(!0),p(!0))})(e),position:e,icon:{url:"https://upload.wikimedia.org/wikipedia/commons/9/94/Circle-image.svg",scaledSize:new l.google.maps.Size(10,10)},className:"marker"},i))),null!==s&&void 0!==s&&s.length?(0,u.jsx)(o.Polygon,{path:l.triangleCoords,strokeColor:"black",strokeOpacity:.8,strokeWeight:3,fillColor:"black",fillOpacity:.35},null===s||void 0===s?void 0:s.length):(0,u.jsx)(o.Polyline,{path:l.triangleCoords,strokeColor:"black",strokeOpacity:.8,strokeWeight:3,fillColor:"black",fillOpacity:.35},null===(i=l.triangleCoords)||void 0===i?void 0:i.length)]})]})}))}}]);