"use strict";(self.webpackChunkjumlajumla_dashboard=self.webpackChunkjumlajumla_dashboard||[]).push([[2755],{47992:(e,t,s)=>{s.d(t,{G:()=>u});var a=s(9950),l=s(95491),n=s.n(l),i=s(99674),d=s(90650),r=s(44414);const u=e=>{let{fetchOptions:t,debounceTimeout:s=400,onClear:l,...u}=e;const[o,c]=(0,a.useState)(!1),[m,h]=(0,a.useState)([]),g=(0,a.useMemo)((()=>n()((e=>{h([]),c(!0),t(e).then((e=>{h(e),c(!1)}))}),s)),[t,s]);return(0,r.jsx)(i.A,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:g,onClear:()=>{g(""),l&&l()},notFoundContent:o?(0,r.jsx)(d.A,{size:"small"}):"no results",...u,options:m,onFocus:()=>{g("")}})}},77159:(e,t,s)=>{s.d(t,{A:()=>w});var a=s(9950),l=s(3969),n=s(87094),i=s(41988),d=s(55902),r=s(99674),u=s(87864),o=s(48538),c=s(47992),m=s(70030),h=s(36455),g=s(19181),b=s.n(g),f=s(63620),p=s(64924),x=s(44414);function j(e){let{form:t,lang:s,languages:a}=e;const{t:n}=(0,m.B)();return(0,x.jsx)("div",{className:"textEditor",children:(0,x.jsx)(l.A.Item,{label:n("newsletter.content"),name:"body",valuePropName:"data",getValueFromEvent:(e,t)=>t.getData(),rules:[{required:!0,message:n("required")}],className:"description-editor",children:(0,x.jsx)(h.CKEditor,{editor:b(),config:{extraPlugins:[function(e){e.plugins.get("FileRepository").createUploadAdapter=e=>function(e){return{upload:()=>new Promise(((t,s)=>{const a=new FormData;e.file.then((e=>{a.append("image",e),a.append("type","blogs"),p.A.upload(a).then((e=>{let{data:s}=e;t({default:`${f.sE+s.title}`})})).catch((e=>{s(e)}))}))}))}}(e)}]},onChange:(e,t)=>{t.getData()},onBlur:(e,s)=>{const a=s.getData();t.setFieldsValue({body:a})}})})})}var v=s(59051),A=s.n(v),y=s(91854),_=s(7843);const N=[{title:"order",value:"order"},{title:"subscribe",value:"subscribe"},{title:"verify",value:"verify"}];function w(e){let{type:t="add",form:s,handleSubmit:h}=e;const{t:g}=(0,m.B)(),{activeMenu:b}=(0,y.d4)((e=>e.menu),y.bN),{defaultLang:f,languages:p}=(0,y.d4)((e=>e.formLang),y.bN),{subscribers:v}=(0,y.d4)((e=>e.messageSubscriber),y.bN),[w,q]=(0,a.useState)(!1);return(0,x.jsxs)(l.A,{name:"subscriber-form",layout:"vertical",onFinish:e=>{q(!0),h(e).finally((()=>q(!1)))},form:s,initialValues:{...b.data,...(()=>{const e=b.data;if(null===e||void 0===e||!e.send_to)return e;const t=e.send_to;return{...e,send_to:A()(t,"YYYY-MM-DD")}})()},className:"d-flex flex-column h-100",children:[(0,x.jsxs)(n.A,{gutter:12,children:[(0,x.jsx)(i.A,{span:12,children:(0,x.jsx)(l.A.Item,{label:g("subject"),name:"subject",rules:[{required:!0,message:g("required")}],children:(0,x.jsx)(d.A,{})})}),(0,x.jsx)(i.A,{span:12,children:(0,x.jsx)(l.A.Item,{label:g("type"),name:"type",rules:[{required:!0,message:g("required")}],children:(0,x.jsx)(r.A,{disabled:"edit"===t,options:N.filter((e=>!v.some((t=>t.type===e.value)))),className:"w-100"})})}),(0,x.jsx)(i.A,{span:12,children:(0,x.jsx)(l.A.Item,{label:g("email.setting.id"),name:"email_setting_id",rules:[{required:!0,message:g("required")}],children:(0,x.jsx)(c.G,{fetchOptions:()=>_.A.get().then((e=>{let{data:t}=e;return t.map((e=>({label:null===e||void 0===e?void 0:e.host,value:null===e||void 0===e?void 0:e.id})))})),className:"w-100",placeholder:g("email.setting.id")})})}),(0,x.jsx)(i.A,{span:24,children:(0,x.jsx)(j,{languages:p,form:s,lang:f})}),(0,x.jsx)(i.A,{span:12,children:(0,x.jsx)(l.A.Item,{label:g("alt.body"),name:"alt_body",rules:[{required:!0,message:g("required")}],children:(0,x.jsx)(d.A,{})})}),(0,x.jsx)(i.A,{span:6,children:(0,x.jsx)(l.A.Item,{label:g("send.to"),name:"send_to",rules:[{required:!0,message:g("required")}],children:(0,x.jsx)(u.A,{showTime:!0,className:"w-100",disabledDate:e=>A()().add(-1,"days")>=e})})})]}),(0,x.jsx)("div",{className:"flex-grow-1 d-flex flex-column justify-content-end",children:(0,x.jsx)("div",{className:"pb-5",children:(0,x.jsx)(o.A,{type:"primary",htmlType:"submit",loading:w,children:g("send")})})})]})}},92755:(e,t,s)=>{s.r(t),s.d(t,{default:()=>x});var a=s(9950),l=s(13564),n=s(12449),i=s(3969),d=s(23263),r=s(91854),u=s(74623),o=s(70030),c=s(59051),m=s.n(c),h=s(24611),g=s(81446),b=s(81499),f=s(77159),p=s(44414);const x=()=>{const{t:e}=(0,o.B)(),{activeMenu:t}=(0,r.d4)((e=>e.menu),r.bN),s=(0,r.wA)(),[c]=i.A.useForm(),x=(0,l.Zp)(),[j,v]=(0,a.useState)(!1),{id:A}=(0,l.g)();(0,a.useEffect)((()=>()=>{const e=c.getFieldsValue(!0),a=JSON.stringify(e.send_to),l={...e,send_to:a};s((0,u.Ok)({activeMenu:t,data:l}))}),[]);return(0,a.useEffect)((()=>{t.refetch&&(e=>{v(!0),h.A.getById(e).then((e=>{var t,s,a,l;const n={...e.data,send_to:m()(e.data.send_to,"YYYY-MM-DD HH:mm:ss"),has_date:!0,email_setting_id:{label:null===e||void 0===e||null===(t=e.data)||void 0===t||null===(s=t.email_setting)||void 0===s?void 0:s.host,value:null===e||void 0===e||null===(a=e.data)||void 0===a||null===(l=a.email_setting)||void 0===l?void 0:l.id}};c.setFieldsValue(n)})).finally((()=>{v(!1),s((0,u.km)(t))}))})(A)}),[t.refetch]),(0,p.jsx)(p.Fragment,{children:j?(0,p.jsx)(g.A,{}):(0,p.jsx)(d.A,{title:e("edit.subscriber"),className:"h-100",children:(0,p.jsx)(f.A,{type:"edit",form:c,handleSubmit:a=>{const l={...a,send_to:m()(a.send_to).format("YYYY-MM-DD HH:mm:ss"),email_setting_id:a.email_setting_id.value},i="message/subscriber";return h.A.update(A,l).then((()=>{n.oR.success(e("successfully.updated")),(0,r.vA)((()=>{s((0,b.e)({})),s((0,u.EK)({...t,nextUrl:i}))})),x(`/${i}`)}))}})})})}}}]);