"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[5918],{49655:(e,l,t)=>{t.d(l,{_:()=>d});var n=t(47313),s=t(12279),a=t.n(s),i=t(74294),o=t(72652),u=t(46417);const d=e=>{let{fetchOptions:l,debounceTimeout:t=400,hasMore:s,refetchOnFocus:d=!1,...r}=e;const[c,v]=(0,n.useState)(!1),[h,m]=(0,n.useState)([]),[p,x]=(0,n.useState)(!1),[b,f]=(0,n.useState)(null),[_,j]=(0,n.useState)(1),g=(0,n.useMemo)((()=>a()((e=>{m([]),f(e),v(!0),l({search:e}).then((e=>{m(e),j(2),v(!1)})).finally((()=>x(!1)))}),t)),[l,t,_]);return(0,u.jsxs)(i.Z,{showSearch:!0,allowClear:!0,onPopupScroll:async e=>{const t=e.target;p||t.scrollTop+t.offsetHeight!==t.scrollHeight||s&&(x(!0),l({search:b,page:_}).then((e=>{j((e=>e+1)),m([...h,...e])})).finally((()=>x(!1))))},labelInValue:!0,filterOption:!1,onSearch:g,notFoundContent:c?(0,u.jsx)(o.Z,{size:"small"}):"no results",onFocus:()=>{d?g(""):null!==h&&void 0!==h&&h.length||g("")},...r,children:[h.map(((e,l)=>(0,u.jsx)(i.Z.Option,{value:e.value,children:e.label},l))),p&&(0,u.jsx)(i.Z.Option,{children:(0,u.jsx)(o.Z,{size:"small"})})]})}},95918:(e,l,t)=>{t.r(l),t.d(l,{default:()=>f});var n=t(47313),s=t(97890),a=t(23560),i=t(10976),o=t(77181),u=t(2717),d=t(90954),r=t(24511),c=t(70816),v=t.n(c),h=t(13783),m=t(73346),p=t(51282),x=t(9215),b=t(46417);const f=()=>{const{t:e}=(0,r.$)(),{activeMenu:l}=(0,u.v9)((e=>e.menu),u.wU),t=(0,u.I0)(),[c]=i.Z.useForm(),f=(0,s.s0)(),[_,j]=(0,n.useState)(!1),{myShop:g}=(0,u.v9)((e=>e.myShop),u.wU),{id:Z}=(0,s.UO)();(0,n.useEffect)((()=>()=>{const e=c.getFieldsValue(!0);e.expired_at=JSON.stringify(null===e||void 0===e?void 0:e.expired_at),t((0,d.nc)({activeMenu:l,data:e}))}),[]);const S=e=>{j(!0),m.Z.getById(e).then((e=>{!function(e){var n,s,a,i,o,u,r,h,m;const p={...e,expired_at:v()(e.expired_at,"YYYY-MM-DD"),bonus_stock_id:{label:`${null===e||void 0===e||null===(n=e.bonusStock)||void 0===n||null===(s=n.product)||void 0===s||null===(a=s.translation)||void 0===a?void 0:a.title} ${null!==e&&void 0!==e&&null!==(i=e.bonusStock)&&void 0!==i&&null!==(o=i.extras)&&void 0!==o&&o.length?`=> ${null===e||void 0===e||null===(u=e.bonusStock)||void 0===u||null===(r=u.extras.map((e=>{var l,t;return`${null===e||void 0===e||null===(l=e.group)||void 0===l||null===(t=l.translation)||void 0===t?void 0:t.title}: ${null===e||void 0===e?void 0:e.value}`})))||void 0===r?void 0:r.join(", ")}`:""}`,value:null===e||void 0===e||null===(h=e.bonusStock)||void 0===h?void 0:h.id,key:null===e||void 0===e||null===(m=e.bonusStock)||void 0===m?void 0:m.id}};c.setFieldsValue({...p}),t((0,d.nc)({activeMenu:l,data:{...p,expired_at:JSON.stringify(p.expired_at)}})),j(!1)}(e.data)})).finally((()=>t((0,d.A_)(l))))};(0,n.useEffect)((()=>{l.refetch&&S(Z)}),[l.refetch]);return(0,b.jsx)(o.Z,{title:e("edit.bonus"),className:"h-100",children:_?(0,b.jsx)(p.Z,{}):(0,b.jsx)(x.Z,{form:c,handleSubmit:n=>{const s={expired_at:v()(n.expired_at).format("YYYY-MM-DD"),status:n.status,type:"sum",value:n.value,bonus_stock_id:n.bonus_stock_id.value,bonus_quantity:n.bonus_quantity,bonusable_id:g.id},i="seller/bonus/shop";return m.Z.update(Z,s).then((()=>{a.Am.success(e("successfully.created")),(0,u.dC)((()=>{t((0,d.ph)({...l,nextUrl:i})),t((0,h.Q)({}))})),f(`/${i}`)}))}})})}},9215:(e,l,t)=>{t.d(l,{Z:()=>f});var n=t(47313),s=t(10976),a=t(68197),i=t(59624),o=t(16124),u=t(99096),d=t(86345),r=t(59491),c=t(70816),v=t.n(c),h=t(24511),m=t(2717),p=t(18333),x=t(49655),b=t(46417);function f(e){let{form:l,handleSubmit:t}=e;const{t:c}=(0,h.$)(),{activeMenu:f}=(0,m.v9)((e=>e.menu),m.wU),[_,j]=(0,n.useState)({bonusStock:!1}),[g,Z]=(0,n.useState)(!1);return(0,b.jsxs)(s.Z,{name:"bonus-form",layout:"vertical",onFinish:e=>{Z(!0),t(e).finally((()=>Z(!1)))},form:l,initialValues:{status:!0,...f.data,...(()=>{var e,l;if(null===(e=f.data)||void 0===e||!e.expired_at)return{};const t=JSON.parse(null===(l=f.data)||void 0===l?void 0:l.expired_at);return{expired_at:v()(t,"HH:mm:ss")}})()},className:"d-flex flex-column h-100",children:[(0,b.jsxs)(a.Z,{gutter:12,children:[(0,b.jsx)(i.Z,{span:12,children:(0,b.jsx)(s.Z.Item,{label:c("order_amount"),name:"value",rules:[{required:!0,message:c("required")},{type:"number",min:1,message:c("min.1")}],children:(0,b.jsx)(o.Z,{className:"w-100"})})}),(0,b.jsx)(i.Z,{span:12,children:(0,b.jsx)(s.Z.Item,{label:c("bonus.product.stock"),name:"bonus_stock_id",rules:[{required:!0,message:c("required")}],children:(0,b.jsx)(x._,{fetchOptions:function(e){let{page:l,search:t}=e;const n={active:1,status:"published",page:l,search:null!==t&&void 0!==t&&t.length?t:void 0};return p.Z.getStock(n).then((e=>{var l,t;return j({..._,bonusStock:(null===e||void 0===e||null===(l=e.meta)||void 0===l?void 0:l.current_page)<=(null===e||void 0===e||null===(t=e.meta)||void 0===t?void 0:t.last_page)}),e.data.map((e=>{var l,t,n,s,a;return{label:`${null===e||void 0===e||null===(l=e.product)||void 0===l||null===(t=l.translation)||void 0===t?void 0:t.title} ${null!==e&&void 0!==e&&null!==(n=e.extras)&&void 0!==n&&n.length?` => ${null===e||void 0===e||null===(s=e.extras)||void 0===s||null===(a=s.map((e=>{var l,t;return`${null===e||void 0===e||null===(l=e.group)||void 0===l||null===(t=l.translation)||void 0===t?void 0:t.title}: ${null===e||void 0===e?void 0:e.value}`})))||void 0===a?void 0:a.join(", ")}`:""}`,value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id}}))}))},hasMore:null===_||void 0===_?void 0:_.bonusStock,allowClear:!1})})}),(0,b.jsx)(i.Z,{span:12,children:(0,b.jsx)(s.Z.Item,{label:c("bonus.product.quantity"),name:"bonus_quantity",rules:[{required:!0,message:c("required")},{type:"number",min:1,message:c("min.1")}],children:(0,b.jsx)(o.Z,{className:"w-100"})})}),(0,b.jsx)(i.Z,{span:12,children:(0,b.jsx)(s.Z.Item,{name:"expired_at",label:c("expired.at"),rules:[{required:!0,message:c("required")}],children:(0,b.jsx)(u.Z,{className:"w-100",placeholder:"",disabledDate:e=>v()().add(-1,"days")>=e})})}),(0,b.jsx)(i.Z,{span:12,children:(0,b.jsx)(s.Z.Item,{label:c("active"),name:"status",valuePropName:"checked",children:(0,b.jsx)(d.Z,{})})})]}),(0,b.jsx)("div",{className:"flex-grow-1 d-flex flex-column justify-content-end",children:(0,b.jsx)("div",{className:"pb-5",children:(0,b.jsx)(r.Z,{type:"primary",htmlType:"submit",loading:g,children:c("submit")})})})]})}}}]);