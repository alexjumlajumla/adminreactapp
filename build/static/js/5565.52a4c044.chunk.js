"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[5565],{75565:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Y});var l=a(47313),i=a(73591),n=a(97890),s=a(24511),d=a(59308),o=a(45705),r=a(26824),c=a(66204),u=a(59491),v=a(77181),h=a(78508),m=a(45464),x=a(12019),p=a(90954),g=a(2717),j=a(23560),Z=a(69658),y=a(74580),w=a(53233),b=a(13945),f=a(80314),_=a(71810),k=a(47677),C=a(14349),I=a(70816),q=a.n(I),P=a(10976),S=a(9274),T=a(68197),M=a(59624),$=a(66672),U=a(46417);function A(e){let{data:t,handleCancel:a,handleOk:i,visible:n}=e;const{t:d}=(0,s.$)(),[o]=P.Z.useForm(),[r,c]=(0,l.useState)(!1);return(0,U.jsx)(S.Z,{title:d(t.title),visible:n,onCancel:a,footer:[(0,U.jsx)(u.Z,{type:"primary",onClick:()=>o.submit(),loading:r,children:d("save")}),(0,U.jsx)(u.Z,{type:"default",onClick:a,children:d("cancel")})],children:(0,U.jsx)(P.Z,{layout:"vertical",onFinish:e=>{c(!0);const t={...e,status:"canceled"};i(t)},form:o,children:(0,U.jsx)(P.Z.Item,{children:(0,U.jsx)(T.Z,{className:"mt-4",children:(0,U.jsx)(M.Z,{span:24,children:(0,U.jsx)(P.Z.Item,{name:"status_note",label:d("note"),rules:[{validator:(e,t)=>t?t&&""===(null===t||void 0===t?void 0:t.trim())?Promise.reject(new Error(d("no.empty.space"))):t&&(null===t||void 0===t?void 0:t.trim().length)<2?Promise.reject(new Error(d("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(d("required")))}],children:(0,U.jsx)($.Z.TextArea,{maxLength:250,showCount:!0})})})})})})})}const E={type:"category"};function F(e){var t,a,i;let{parentId:d,type:I="main",activeTab:P="request"}=e;const{t:S}=(0,s.$)(),{setIsModalVisible:T}=(0,l.useContext)(y._),[M,$]=(0,l.useState)(!1),[F,Y]=(0,l.useState)(!1),[H,K]=(0,l.useState)(null),N=(0,g.I0)(),O=(0,n.s0)(),{activeMenu:z}=(0,g.v9)((e=>e.menu),g.wU),{data:B,meta:D,loading:L,params:W}=(0,g.v9)((e=>e.requestModels),g.wU),R=z.data,{uuid:V}=(0,n.UO)(),G={sort:null===R||void 0===R?void 0:R.sort,column:null===R||void 0===R?void 0:R.column,perPage:null===R||void 0===R?void 0:R.perPage,page:null===R||void 0===R?void 0:R.page,parent_id:d},[J,Q]=(0,l.useState)([{title:S("created.by"),dataIndex:"createdBy",key:"createdBy",is_show:!0,render:e=>(0,U.jsxs)("span",{children:[e.firstname," ",null===e||void 0===e?void 0:e.lastname," ",(0,U.jsx)("a",{href:`tel:${null===e||void 0===e?void 0:e.phone}`,children:null===e||void 0===e?void 0:e.phone})]})},{title:S("created.at"),dataIndex:"created_at",key:"created_at",is_show:!0,render:e=>q()(e).format("YYYY-MM-DD HH:mm")},{title:S("name"),dataIndex:"name",key:"name",is_show:!0,render:(e,t)=>{var a,l,i,n,s,d;return(0,U.jsxs)(o.Z,{children:[null===t||void 0===t||null===(a=t.model)||void 0===a||null===(l=a.translation)||void 0===l?void 0:l.title," ",(0,U.jsx)(k.WFu,{})," ",null===t||void 0===t||null===(i=t.data)||void 0===i||null===(n=i.title)||void 0===n?void 0:n[null===t||void 0===t||null===(s=t.model)||void 0===s||null===(d=s.translation)||void 0===d?void 0:d.locale]]})}},{title:S("image"),dataIndex:"img",key:"img",is_show:!0,render:(e,t)=>{var a,l,i;return(0,U.jsxs)(o.Z,{children:[(0,U.jsx)(r.Z,{src:(0,m.Z)(null===t||void 0===t||null===(a=t.model)||void 0===a?void 0:a.img),alt:"img_gallery",width:100,className:"rounded",preview:!0,placeholder:!0}),(0,U.jsx)(k.WFu,{}),(0,U.jsx)(r.Z,{src:(0,m.Z)(null===t||void 0===t||null===(l=t.data)||void 0===l||null===(i=l.images)||void 0===i?void 0:i.at(0)),alt:"img_gallery",width:100,className:"rounded",preview:!0,placeholder:!0})]})}},{title:S("status"),is_show:!0,dataIndex:"status",key:"status",render:(e,t)=>(0,U.jsx)("div",{children:"pending"===e?(0,U.jsx)(c.Z,{color:"blue",children:S(e)}):"canceled"===e?(0,U.jsx)(c.Z,{color:"error",children:S(e)}):(0,U.jsx)(c.Z,{color:"cyan",children:S(e)})})},{title:S("options"),key:"options",dataIndex:"options",is_show:!0,render:(e,t)=>(0,U.jsxs)(o.Z,{children:[(0,U.jsx)(u.Z,{icon:(0,U.jsx)(x.Z,{}),onClick:()=>(e=>{N((0,p.bL)({url:`category-request/${e.id}`,id:"request_edit",name:S("request.edit")})),O(`/category-request/${e.id}`,{state:{parentId:d,parentUuid:V}})})(t)}),(0,U.jsx)(u.Z,{type:"primary",onClick:()=>{K([{id:t.id,status:"approved"}]),T(!0)},children:S("accept")}),(0,U.jsx)(u.Z,{type:"primary",danger:!0,onClick:()=>{K([{id:t.id,status:"canceled"}]),$(!0)},children:S("decline")})]})}]);(0,l.useEffect)((()=>{z.refetch&&"request"===P&&(N((0,_.aw)(G)),N((0,p.A_)(z)))}),[z.refetch]),(0,f.Z)((()=>{"request"===P&&N((0,_.aw)(G))}),[P,z.data]);const X=e=>{Y(!0);const t={status:null===H||void 0===H?void 0:H.at(0).status,status_note:null===e||void 0===e?void 0:e.status_note};C.Z.changeStatus(null===H||void 0===H?void 0:H.at(0).id,t).then((()=>{j.Am.success(S("successfully.changed")),N((0,_.aw)(E)),T(!1),K(null)})).finally((()=>{$(!1),Y(!1)}))},ee={selectedRowKeys:H,onChange:e=>{K(e)}};return(0,U.jsxs)(v.Z,{title:S("requests"),extra:(0,U.jsx)(o.Z,{wrap:!0,children:(0,U.jsx)(w.Z,{columns:J,setColumns:Q})}),children:[(0,U.jsx)(h.Z,{scroll:{x:!0},rowSelection:ee,columns:null===J||void 0===J?void 0:J.filter((e=>e.is_show)),dataSource:B,pagination:{pageSize:W.perPage,page:(null===(t=z.data)||void 0===t?void 0:t.page)||1,total:D.total,defaultCurrent:null===(a=z.data)||void 0===a?void 0:a.page,current:null===(i=z.data)||void 0===i?void 0:i.page},rowKey:e=>e.key,onChange:function(e,t,a){const{pageSize:l,current:i}=e,{field:n,order:s}=a,d=(0,b.Z)(s);N((0,p.nc)({activeMenu:z,data:{...z.data,perPage:l,page:i,column:n,sort:d}}))},loading:L}),(0,U.jsx)(Z.Z,{click:X,text:S("change.status"),setText:K,loading:F}),(0,U.jsx)(A,{data:{title:"decline"},visible:M,handleCancel:()=>$(!1),handleOk:X,laoding:F})]})}function Y(){var e,t;const{t:a}=(0,s.$)(),o=(0,n.TH)(),r=(0,g.I0)(),{activeMenu:c}=(0,g.v9)((e=>e.menu),g.wU),[u,v]=(0,l.useState)((null===(e=o.state)||void 0===e?void 0:e.tab)||"list");return(0,U.jsxs)(i.Z,{defaultActiveKey:(null===(t=o.state)||void 0===t?void 0:t.tab)||"list",destroyInactiveTabPane:!0,onChange:e=>{r((0,p.xo)(c)),v(e)},children:[(0,U.jsx)(i.Z.TabPane,{tab:a("category.list"),children:(0,U.jsx)(d.Z,{activeTab:u})},"list"),(0,U.jsx)(i.Z.TabPane,{tab:a("requests"),children:(0,U.jsx)(F,{activeTab:u})},"request")]})}}}]);