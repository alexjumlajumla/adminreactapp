(self.webpackChunkjumlajumla_dashboard=self.webpackChunkjumlajumla_dashboard||[]).push([[6008],{14932:(e,s,a)=>{"use strict";a.d(s,{A:()=>O});var l=a(9950),t=a(3969),n=a(80737),r=a(48538),i=a(13564),d=a(87094),o=a(41988),u=a(23263),m=a(55902),c=a(25933),p=a(8724),h=a(40895),g=a(99674),A=a(98591),x=a(53271),j=a(91854),v=a(70030),f=a(62572),y=a(78498),b=a(56713),_=a(63620),w=a(44414);function q(e){let{setLocation:s,form:a,item:l,idx:n,defaultLang:r}=e;const{t:i}=(0,v.B)(),{google_map_key:d}=(0,j.d4)((e=>e.globalSettings.settings),j.bN),{ref:o}=(0,b.usePlacesWidget)({apiKey:d||_.CJ,onPlaceSelected:e=>{const l={lat:null===e||void 0===e?void 0:e.geometry.location.lat(),lng:null===e||void 0===e?void 0:e.geometry.location.lng()};s(l),a.setFieldsValue({[`address[${r}]`]:null===e||void 0===e?void 0:e.formatted_address})}});return(0,w.jsx)(t.A.Item,{label:i("address"),name:`address[${null===l||void 0===l?void 0:l.locale}]`,rules:[{required:(null===l||void 0===l?void 0:l.locale)===r,message:i("required")}],hidden:(null===l||void 0===l?void 0:l.locale)!==r,children:(0,w.jsx)("input",{className:"address-input",ref:o,placeholder:""})},"address"+n)}var I=a(16254),k=a(92019),N=a(12040),S=a(92967),F=a(79406),L=a(58974);const B=e=>{let{logoImage:s,setLogoImage:a,backImage:n,setBackImage:i,form:b,location:_,setLocation:B,user:C}=e;const{t:M}=(0,v.B)(),[V,O]=(0,l.useState)(null),[$,D]=(0,l.useState)(null),[H,P]=(0,l.useState)(null),{defaultLang:Y,languages:E}=(0,j.d4)((e=>e.formLang),j.bN);const T=()=>{O(!0),P(!0)},J=()=>{D(!0),P(!0)},Q=()=>{O(!1),D(!1)};return(0,w.jsxs)(d.A,{gutter:12,children:[(0,w.jsx)(o.A,{span:24,children:(0,w.jsx)(u.A,{children:(0,w.jsxs)(d.A,{gutter:12,children:[(0,w.jsx)(o.A,{span:4,children:(0,w.jsx)(t.A.Item,{label:M("logo.image"),children:(0,w.jsx)(I.A,{type:"shops/logo",imageList:s,setImageList:a,form:b,multiple:!1,name:"logo_img"})})}),(0,w.jsx)(o.A,{span:4,children:(0,w.jsx)(t.A.Item,{label:M("background.image"),children:(0,w.jsx)(I.A,{type:"shops/background",imageList:n,setImageList:i,form:b,multiple:!1,name:"background_img"})})}),(0,w.jsx)(o.A,{span:10,children:(0,w.jsx)(t.A.Item,{label:M("status.note"),name:"status_note",children:(0,w.jsx)(A.A,{rows:4})})}),(0,w.jsx)(o.A,{span:4,children:(0,w.jsx)(t.A.Item,{name:"status",label:M("status"),children:(0,w.jsx)(m.A,{disabled:!0})})}),(0,w.jsx)(o.A,{span:2,children:(0,w.jsx)(t.A.Item,{label:M("open"),name:"open",valuePropName:"checked",initialValue:!1,children:(0,w.jsx)(c.A,{})})})]})})}),(0,w.jsx)(o.A,{span:24,children:(0,w.jsx)(u.A,{title:M("general"),children:(0,w.jsxs)(d.A,{gutter:12,children:[(0,w.jsx)(o.A,{span:12,children:(0,w.jsxs)(d.A,{gutter:12,children:[(0,w.jsx)(o.A,{span:24,children:E.map(((e,s)=>(0,w.jsx)(t.A.Item,{label:M("title"),name:`title[${e.locale}]`,rules:[{required:e.locale===Y,message:M("required")},{min:2,message:M("title.required")}],hidden:e.locale!==Y,children:(0,w.jsx)(m.A,{})},"title"+s)))}),(0,w.jsx)(o.A,{span:24,children:(0,w.jsx)(t.A.Item,{label:M("phone"),name:"phone",rules:[{required:!0,message:M("required")}],children:(0,w.jsx)(p.A,{min:0,className:"w-100"})})})]})}),(0,w.jsx)(o.A,{span:12,children:E.map(((e,s)=>(0,w.jsx)(t.A.Item,{label:M("description"),name:`description[${e.locale}]`,rules:[{required:e.locale===Y,message:M("required")},{min:3,message:M("required")}],hidden:e.locale!==Y,children:(0,w.jsx)(A.A,{rows:4})},"desc"+s)))}),(0,w.jsx)(o.A,{span:8,children:(0,w.jsx)(t.A.Item,{label:M("restaurant.tags"),name:"tags",rules:[{required:!1,message:M("required")}],children:(0,w.jsx)(F.a,{mode:"multiple",fetchOptions:async function(e){P(!1);const s={search:e};return L.A.getAll(s).then((e=>{let{data:s}=e;return s.map((e=>{var s;return{label:(null===(s=e.translation)||void 0===s?void 0:s.title)||"no name",value:e.id}}))}))},refetch:H})})}),(0,w.jsx)(o.A,{span:8,children:(0,w.jsx)(t.A.Item,{label:M("seller"),name:"user",rules:[{required:!0,message:M("required")}],children:(0,w.jsx)(F.a,{disabled:C,fetchOptions:async function(e){const s={search:e,roles:"user","empty-shop":1};return P(!1),x.A.search(s).then((e=>e.data.map((e=>({label:e.firstname+" "+(e.lastname?e.lastname:""),value:e.id})))))},refetch:H,dropdownRender:e=>(0,w.jsxs)(w.Fragment,{children:[e,(0,w.jsx)(h.A,{style:{margin:"8px 0"}}),(0,w.jsx)(r.A,{className:"w-100",disabled:C,icon:(0,w.jsx)(k.A,{}),onClick:T,children:M("add.user")})]})})})}),(0,w.jsx)(o.A,{span:8,children:(0,w.jsx)(t.A.Item,{label:M("categories"),name:"categories",rules:[{required:!0,message:M("required")}],children:(0,w.jsx)(F.a,{mode:"multiple",fetchOptions:async function(e){const s={search:e,type:"shop"};return P(!1),f.A.getAll(s).then((e=>{let{data:s}=e;return s.map((e=>{var s;return{label:(null===(s=e.translation)||void 0===s?void 0:s.title)||"no name",value:e.id}}))}))},refetch:H,dropdownRender:e=>(0,w.jsxs)(w.Fragment,{children:[e,(0,w.jsx)(h.A,{style:{margin:"8px 0"}}),(0,w.jsx)(r.A,{className:"w-100",icon:(0,w.jsx)(k.A,{}),onClick:J,children:M("add.category")})]})})})})]})})}),(0,w.jsx)(o.A,{span:8,children:(0,w.jsx)(u.A,{title:M("delivery"),children:(0,w.jsxs)(d.A,{gutter:8,children:[(0,w.jsx)(o.A,{span:12,children:(0,w.jsx)(t.A.Item,{name:"price",label:M("min.price"),rules:[{required:!0,message:M("required")}],children:(0,w.jsx)(p.A,{className:"w-100"})})}),(0,w.jsx)(o.A,{span:12,children:(0,w.jsx)(t.A.Item,{name:"price_per_km",label:M("price.per.km"),rules:[{required:!0,message:M("required")}],children:(0,w.jsx)(p.A,{className:"w-100"})})})]})})}),(0,w.jsx)(o.A,{span:8,children:(0,w.jsx)(u.A,{title:M("delivery.time"),children:(0,w.jsxs)(d.A,{gutter:12,children:[(0,w.jsx)(o.A,{span:12,children:(0,w.jsx)(t.A.Item,{name:"delivery_time_type",label:M("delivery_time_type"),rules:[{required:!0,message:M("required")}],children:(0,w.jsxs)(g.A,{className:"w-100",children:[(0,w.jsx)(g.A.Option,{value:"minute",label:M("minutes")}),(0,w.jsx)(g.A.Option,{value:"hour",label:M("hour")})]})})}),(0,w.jsx)(o.A,{span:12,children:(0,w.jsx)(t.A.Item,{name:"delivery_time_from",label:M("delivery_time_from"),rules:[{required:!0,message:M("required")}],children:(0,w.jsx)(p.A,{className:"w-100"})})}),(0,w.jsx)(o.A,{span:12,children:(0,w.jsx)(t.A.Item,{name:"delivery_time_to",label:M("delivery_time_to"),rules:[{required:!0,message:M("required")}],children:(0,w.jsx)(p.A,{className:"w-100"})})})]})})}),(0,w.jsx)(o.A,{span:8,children:(0,w.jsx)(u.A,{title:M("order.info"),children:(0,w.jsxs)(d.A,{gutter:12,children:[(0,w.jsx)(o.A,{span:12,children:(0,w.jsx)(t.A.Item,{label:M("min.amount"),name:"min_amount",rules:[{required:!0,message:M("required")}],children:(0,w.jsx)(p.A,{min:0,className:"w-100"})})}),(0,w.jsx)(o.A,{span:12,children:(0,w.jsx)(t.A.Item,{label:M("tax"),name:"tax",rules:[{required:!0,message:M("required")}],children:(0,w.jsx)(p.A,{min:0,addonAfter:"%",className:"w-100"})})}),(0,w.jsx)(o.A,{span:12,children:(0,w.jsx)(t.A.Item,{label:M("admin.comission"),name:"percentage",rules:[{required:!0,message:M("required")}],children:(0,w.jsx)(p.A,{min:0,className:"w-100",addonAfter:"%"})})})]})})}),(0,w.jsx)(o.A,{span:24,children:(0,w.jsx)(u.A,{title:M("address"),children:(0,w.jsxs)(d.A,{gutter:12,children:[(0,w.jsx)(o.A,{span:12,children:E.map(((e,s)=>(0,w.jsx)(q,{setLocation:B,form:b,item:e,idx:s,defaultLang:Y},s)))}),(0,w.jsx)(o.A,{span:24,children:(0,w.jsx)(y.A,{location:_,setLocation:B,setAddress:e=>b.setFieldsValue({[`address[${Y}]`]:e})})})]})})}),V&&(0,w.jsx)(N.A,{visible:V,handleCancel:()=>Q()}),$&&(0,w.jsx)(S.A,{visible:$,handleCancel:()=>Q()})]})};var C=a(74623),M=a(58547),V=a(29597);const O=e=>{var s,a,d,o,u,m,c,p,h;let{next:g,action_type:A="",user:x}=e;const{t:f}=(0,v.B)(),[y]=t.A.useForm(),b=(0,i.Zp)(),_=(0,j.wA)(),{uuid:q}=(0,i.g)(),{activeMenu:I}=(0,j.d4)((e=>e.menu),j.bN),[k,N]=(0,l.useState)(!1),[S,F]=(0,l.useState)(null!==(s=I.data)&&void 0!==s&&s.logo_img?[null===(a=I.data)||void 0===a?void 0:a.logo_img]:[]),[L,O]=(0,l.useState)(null!==(d=I.data)&&void 0!==d&&d.background_img?[null===(o=I.data)||void 0===o?void 0:o.background_img]:[]),{settings:$}=(0,j.d4)((e=>e.globalSettings),j.bN),[D,H]=(0,l.useState)(null!==I&&void 0!==I&&null!==(u=I.data)&&void 0!==u&&u.location?{lat:parseFloat(null===I||void 0===I||null===(m=I.data)||void 0===m||null===(c=m.location)||void 0===c?void 0:c.latitude),lng:parseFloat(null===I||void 0===I||null===(p=I.data)||void 0===p||null===(h=p.location)||void 0===h?void 0:h.longitude)}:(0,V.A)($));(0,l.useEffect)((()=>()=>{const e=y.getFieldsValue(!0);e.open_time=JSON.stringify(null===e||void 0===e?void 0:e.open_time),e.close_time=JSON.stringify(null===e||void 0===e?void 0:e.close_time),e.open=!!e.open,_((0,C.Ok)({activeMenu:I,data:{...I.data,...e}}))}),[]);return(0,w.jsx)(w.Fragment,{children:(0,w.jsxs)(t.A,{form:y,name:"basic",layout:"vertical",onFinish:e=>{var s,a,l;N(!0);const t={...e,"images[0]":null===(s=S[0])||void 0===s?void 0:s.name,"images[1]":null===(a=L[0])||void 0===a?void 0:a.name,delivery_time_type:e.delivery_time_type,delivery_time_to:e.delivery_time_to,delivery_time_from:e.delivery_time_from,categories:e.categories.map((e=>e.value)),tags:null===e||void 0===e||null===(l=e.tags)||void 0===l?void 0:l.map((e=>e.value)),user_id:e.user.value,open:e.open?1:0,"location[latitude]":D.lat,"location[longitude]":D.lng,user:void 0,delivery_time:0,type:"restaurant"};"edit"===A?function(e,s){M.A.update(q,s).then((()=>{_((0,C.Ok)({activeMenu:I,data:e})),g()})).catch((e=>console.error(e))).finally((()=>N(!1)))}(e,t):function(e,s){M.A.create(s).then((s=>{let{data:a}=s;_((0,C.W6)({id:`restaurant-${a.uuid}`,url:`restaurant/${a.uuid}`,name:f("add.restaurant"),data:{...a,background_img:{name:null===a||void 0===a?void 0:a.background_img},logo_img:{name:null===a||void 0===a?void 0:a.logo_img},...e},refetch:!1})),b(`/restaurant/${a.uuid}?step=1`)})).catch((e=>console.error(e))).finally((()=>N(!1)))}(e,t)},initialValues:{open:!1,status:"new",...I.data},children:[(0,w.jsx)(B,{logoImage:S,setLogoImage:F,backImage:L,setBackImage:O,form:y,location:D,setLocation:H,user:x}),(0,w.jsx)(n.A,{children:(0,w.jsx)(r.A,{type:"primary",htmlType:"submit",loading:k,children:f("next")})})]})})}},42634:()=>{},55529:(e,s,a)=>{"use strict";a.d(s,{C:()=>l});const l=[{title:"restaurant",content:"First-content"},{title:"map",content:"Second-content"},{title:"delivery",content:"Third-content"},{title:"user",content:"Four-content"}]},65820:(e,s,a)=>{"use strict";a.d(s,{s:()=>r});var l=a(13564),t=a(21215),n=a.n(t);const r=()=>{const e=(0,l.Zp)(),s=(0,l.zy)(),a=n().parse(s.search,{ignoreQueryPrefix:!0});return{values:a,set:(s,l)=>e({search:n().stringify({...a,[s]:l})}),reset:s=>{const l={...a};l[s]&&delete l[s],e({search:n().stringify({...l})})},clear:()=>e({search:n().stringify({})}),merge:s=>e({search:n().stringify({...a,...s})}),get:e=>a[e],setMultiple:s=>{const l={...a,...s};e({search:n().stringify(l)})},resetMultiple:s=>{const l={...a};s.forEach((e=>{l[e]&&delete l[e]})),e({search:n().stringify(l)})}}}},90419:(e,s,a)=>{"use strict";a.d(s,{A:()=>h});var l=a(3969),t=a(9950),n=a(81446),r=a(59051),i=a.n(r),d=a(81466),o=a(80127),u=a(13564),m=a(34422),c=a(40691),p=a(44414);const h=e=>{let{next:s,prev:a}=e;const[r]=l.A.useForm(),[h,g]=(0,t.useState)([]),[A,x]=(0,t.useState)(new Array(7).fill(!1)),[j,v]=(0,t.useState)(!1),[f,y]=(0,t.useState)(!1),{uuid:b}=(0,u.g)();return(0,t.useEffect)((()=>{r.setFieldsValue({working_days:m.Q}),b&&(y(!0),o.A.getById(b).then((e=>{g(e.data.closed_dates.filter((e=>e.day>i()(new Date).format("YYYY-MM-DD"))).map((e=>new Date(e.day))))})),d.A.getById(b).then((e=>{x(0!==e.data.dates.length?e.data.dates.map((e=>e.disabled)):[]),0!==e.data.dates.length&&r.setFieldsValue({working_days:e.data.dates.map((e=>({title:e.day,from:i()(e.from,"HH:mm:ss"),to:i()(e.to,"HH:mm:ss"),disabled:Boolean(e.disabled)})))})})).finally((()=>y(!1))))}),[]),(0,p.jsx)(p.Fragment,{children:f?(0,p.jsx)(n.A,{}):(0,p.jsx)(c.A,{onFinish:e=>{v(!0);const a={dates:h?h.map((e=>i()(e).format("YYYY-MM-DD"))):void 0},l={dates:e.working_days.map((e=>({day:e.title,from:i()(e.from?e.from:"00").format("HH-mm"),to:i()(e.to?e.to:"00").format("HH-mm"),disabled:e.disabled})))};o.A.update(b,a).then((()=>{s()})).finally((()=>v(!1))),0!==e.working_days.length&&d.A.update(b,l).then((()=>{s()})).finally((()=>v(!1)))},prev:a,form:r,lines:A,loadingBtn:j,days:h,setDays:g,setLines:x,weeks:m.Q})})}},96351:(e,s,a)=>{"use strict";a.d(s,{A:()=>b});var l=a(9950),t=a(3969),n=a(87094),r=a(41988),i=a(55902),d=a(8724),o=a(80737),u=a(48538),m=a(13564),c=a(91854),p=a(53271),h=a(12449),g=a(74623),A=a(59051),x=a.n(A),j=a(70030),v=a(81446),f=a(13311),y=a(44414);function b(e){var s;let{prev:a}=e;const{isDemo:A}=(0,f.A)(),{t:b}=(0,j.B)(),{activeMenu:_}=(0,c.d4)((e=>e.menu),c.bN),w=(0,c.wA)(),q=(0,m.Zp)(),[I,k]=(0,l.useState)(null),[N,S]=(0,l.useState)(!1),[F,L]=(0,l.useState)(!1),[B]=t.A.useForm();console.log(A);return(0,l.useEffect)((()=>{var e,s,a;null!==_&&void 0!==_&&_.data&&(a=null===_||void 0===_||null===(e=_.data)||void 0===e||null===(s=e.seller)||void 0===s?void 0:s.uuid,L(!0),p.A.getById(a).then((e=>{const s=e.data;B.setFieldsValue({firstname:s.firstname,lastname:s.lastname,email:s.email,phone:s.phone,password_confirmation:s.password_confirmation,password:s.password})})).finally((()=>L(!1))))}),[]),(0,y.jsx)(y.Fragment,{children:F?(0,y.jsx)(v.A,{}):(0,y.jsx)(t.A,{form:B,layout:"vertical",initialValues:{gender:"male",role:"admin",..._.data,birthday:null!==(s=_.data)&&void 0!==s&&s.birthday?x()(_.data.birthday):null},onFinish:e=>{var s,a;S(!0);const l={firstname:e.firstname,lastname:e.lastname,email:e.email,phone:e.phone,password_confirmation:e.password_confirmation,password:e.password},t="restaurants";p.A.update(null===_||void 0===_||null===(s=_.data)||void 0===s||null===(a=s.seller)||void 0===a?void 0:a.uuid,l).then((()=>{h.oR.success(b("successfully.updated")),q(`/${t}`),w((0,g.EK)({..._,nextUrl:t}))})).catch((e=>k(e.response.data.params))).finally((()=>S(!1)))},className:"py-4",children:(0,y.jsxs)(n.A,{gutter:12,children:[(0,y.jsx)(r.A,{span:12,children:(0,y.jsx)(t.A.Item,{label:b("firstname"),name:"firstname",help:null!==I&&void 0!==I&&I.firstname?I.firstname[0]:null,validateStatus:null!==I&&void 0!==I&&I.firstname?"error":"success",rules:[{required:!1,message:b("required")}],children:(0,y.jsx)(i.A,{className:"w-100"})})}),(0,y.jsx)(r.A,{span:12,children:(0,y.jsx)(t.A.Item,{label:b("lastname"),name:"lastname",help:null!==I&&void 0!==I&&I.lastname?I.lastname[0]:null,validateStatus:null!==I&&void 0!==I&&I.lastname?"error":"success",rules:[{required:!1,message:b("required")}],children:(0,y.jsx)(i.A,{className:"w-100"})})}),A||(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(r.A,{span:12,children:(0,y.jsx)(t.A.Item,{label:b("phone"),name:"phone",help:null!==I&&void 0!==I&&I.phone?I.phone[0]:null,validateStatus:null!==I&&void 0!==I&&I.phone?"error":"success",rules:[{required:!1,message:b("required")}],children:(0,y.jsx)(d.A,{min:0,className:"w-100"})})}),(0,y.jsx)(r.A,{span:12,children:(0,y.jsx)(t.A.Item,{label:b("email"),name:"email",help:null!==I&&void 0!==I&&I.email?I.email[0]:null,validateStatus:null!==I&&void 0!==I&&I.email?"error":"success",rules:[{required:!0,message:b("required")}],children:(0,y.jsx)(i.A,{type:"email",className:"w-100"})})}),(0,y.jsx)(r.A,{span:12,children:(0,y.jsx)(t.A.Item,{label:b("password"),name:"password",help:null!==I&&void 0!==I&&I.password?I.password[0]:null,validateStatus:null!==I&&void 0!==I&&I.password?"error":"success",rules:[{required:!1,message:b("required")}],children:(0,y.jsx)(i.A.Password,{type:"password",className:"w-100",autoComplete:"off"})})}),(0,y.jsx)(r.A,{span:12,children:(0,y.jsx)(t.A.Item,{label:b("password.confirmation"),help:null!==I&&void 0!==I&&I.password_confirmation?I.password_confirmation[0]:null,validateStatus:null!==I&&void 0!==I&&I.password_confirmation?"error":"success",name:"password_confirmation",dependencies:["password"],hasFeedback:!0,rules:[{required:!1,message:b("required")},e=>{let{getFieldValue:s}=e;return{validator:(e,a)=>a&&s("password")!==a?Promise.reject(b("passwords.do.not.match")):Promise.resolve()}}],children:(0,y.jsx)(i.A.Password,{type:"password",className:"w-100",autoComplete:"off"})})})]}),(0,y.jsx)(r.A,{span:24,children:(0,y.jsxs)(o.A,{children:[(0,y.jsx)(u.A,{type:"primary",htmlType:"submit",loading:N,children:b("save")}),(0,y.jsx)(u.A,{htmlType:"submit",onClick:()=>a(),children:b("prev")})]})})]})})})}}}]);