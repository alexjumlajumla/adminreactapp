"use strict";(self.webpackChunkjumlajumla_dashboard=self.webpackChunkjumlajumla_dashboard||[]).push([[4225],{14225:(e,t,s)=>{s.r(t),s.d(t,{default:()=>j});var a=s(9950),r=s(13564),n=s(12449),l=s(3969),d=s(23263),i=s(59051),u=s.n(i),c=s(91854),o=s(74623),m=s(35765),h=s(73439),p=s(70030),x=s(86954),f=s(44414);function j(){const{t:e}=(0,p.B)(),{activeMenu:t}=(0,c.d4)((e=>e.menu),c.bN),s=(0,c.wA)(),[i]=l.A.useForm(),j=(0,r.Zp)();(0,a.useEffect)((()=>()=>{const e=i.getFieldsValue(!0),a=JSON.stringify(e.start),r=JSON.stringify(e.end),n={...e,start:a,end:r};s((0,o.Ok)({activeMenu:t,data:n}))}),[]);return(0,f.jsx)(d.A,{title:e("add.discount"),className:"h-100",children:(0,f.jsx)(x.A,{form:i,handleSubmit:(a,r)=>{var l;if(u()(a.start).format("YYYY-MM-DD")>u()(a.end).format("YYYY-MM-DD"))return n.oR.error(e("start.date.must.be.before.end.date"));const d={price:a.price,type:a.type,products:a.products.map((e=>e.value)),start:a.start?u()(a.start).format("YYYY-MM-DD"):void 0,end:a.end?u()(a.end).format("YYYY-MM-DD"):void 0,images:[null===(l=r[0])||void 0===l?void 0:l.name]},i="seller/discounts";return m.A.create(d).then((()=>{n.oR.success(e("successfully.created")),s((()=>{s((0,o.EK)({...t,nextUrl:i})),s((0,h.X)({}))})),j(`/${i}`)}))}})})}},47992:(e,t,s)=>{s.d(t,{G:()=>u});var a=s(9950),r=s(95491),n=s.n(r),l=s(99674),d=s(90650),i=s(44414);const u=e=>{let{fetchOptions:t,debounceTimeout:s=400,onClear:r,...u}=e;const[c,o]=(0,a.useState)(!1),[m,h]=(0,a.useState)([]),p=(0,a.useMemo)((()=>n()((e=>{h([]),o(!0),t(e).then((e=>{h(e),o(!1)}))}),s)),[t,s]);return(0,i.jsx)(l.A,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:p,onClear:()=>{p(""),r&&r()},notFoundContent:c?(0,i.jsx)(d.A,{size:"small"}):"no results",...u,options:m,onFocus:()=>{p("")}})}},86954:(e,t,s)=>{s.d(t,{A:()=>v});var a=s(9950),r=s(3969),n=s(87094),l=s(41988),d=s(99674),i=s(8724),u=s(87864),c=s(48538),o=s(59051),m=s.n(o),h=s(47992),p=s(16254),x=s(70030),f=s(91854),j=s(67231),A=s(44414);function v(e){var t,s;let{form:o,handleSubmit:v}=e;const{t:b}=(0,x.B)(),{activeMenu:Y}=(0,f.d4)((e=>e.menu),f.bN),{myShop:g}=(0,f.d4)((e=>e.myShop),f.bN),[y,M]=(0,a.useState)(!1),[D,q]=(0,a.useState)(null!==(t=Y.data)&&void 0!==t&&t.image?null===(s=Y.data)||void 0===s?void 0:s.image:[]);return(0,A.jsxs)(r.A,{name:"discount-form",layout:"vertical",onFinish:e=>{M(!0),v(e,D).finally((()=>M(!1)))},form:o,initialValues:{...(()=>{var e;const t=Y.data;if(null===(e=Y.data)||void 0===e||!e.start)return t;const s=Y.data.start,a=Y.data.end;return{...t,start:m()(s,"YYYY-MM-DD"),end:m()(a,"YYYY-MM-DD")}})()},className:"d-flex flex-column h-100",children:[(0,A.jsxs)(n.A,{gutter:12,children:[(0,A.jsx)(l.A,{span:12,children:(0,A.jsx)(r.A.Item,{label:b("type"),name:"type",rules:[{required:!0,message:b("required")}],children:(0,A.jsxs)(d.A,{children:[(0,A.jsx)(d.A.Option,{value:"fix",children:b("fix")}),(0,A.jsx)(d.A.Option,{value:"percent",children:b("percent")})]})})}),(0,A.jsx)(l.A,{span:12,children:(0,A.jsx)(r.A.Item,{label:b("price"),name:"price",rules:[{required:!0,message:b("required")}],children:(0,A.jsx)(i.A,{min:0,className:"w-100"})})}),(0,A.jsx)(l.A,{span:12,children:(0,A.jsx)(r.A.Item,{label:b("start.date"),name:"start",rules:[{required:!0,message:b("required")}],children:(0,A.jsx)(u.A,{className:"w-100",placeholder:"",disabledDate:e=>m()().add(-1,"days")>=e})})}),(0,A.jsx)(l.A,{span:12,children:(0,A.jsx)(r.A.Item,{label:b("end.date"),name:"end",rules:[{required:!0,message:b("required")}],children:(0,A.jsx)(u.A,{className:"w-100",placeholder:"",disabledDate:e=>m()().add(-1,"days")>=e})})}),(0,A.jsx)(l.A,{span:24,children:(0,A.jsx)(r.A.Item,{label:b("products"),name:"products",rules:[{required:!0,message:b("required")}],children:(0,A.jsx)(h.G,{fetchOptions:async function(e){const t={search:e,shop_id:g.id,status:"published",active:1,rest:1};return j.A.getAll(t).then((e=>{let{data:t}=e;return t.map((e=>{var t;return{label:null===(t=e.translation)||void 0===t?void 0:t.title,value:e.id}}))}))},mode:"multiple"})})}),(0,A.jsx)(l.A,{span:24,children:(0,A.jsx)(r.A.Item,{label:b("image"),name:"images",rules:[{required:!D.length,message:b("required")}],children:(0,A.jsx)(p.A,{type:"discounts",imageList:D,setImageList:q,form:o,multiple:!1,name:"image"})})})]}),(0,A.jsx)("div",{className:"flex-grow-1 d-flex flex-column justify-content-end",children:(0,A.jsx)("div",{className:"pb-5",children:(0,A.jsx)(c.A,{type:"primary",htmlType:"submit",loading:y,children:b("submit")})})})]})}}}]);