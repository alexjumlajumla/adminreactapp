"use strict";(self.webpackChunkjumlajumla_dashboard=self.webpackChunkjumlajumla_dashboard||[]).push([[5522],{5522:(e,l,i)=>{i.r(l),i.d(l,{default:()=>M});var n=i(9950),d=i(20978),t=i(23263),s=i(48538),a=i(90650),o=i(87094),r=i(41988),c=i(12916),u=i(12203),v=i(80737),x=i(13564),h=i(82249),m=i(69554),j=i(91854),p=i(74623),y=i(3969),A=i(32645),g=i(99674),b=i(70030),f=i(44414);const N=["new","accepted","ready","on_a_way","delivered"];function _(e){let{orderDetails:l,handleCancel:i}=e;const{activeMenu:d}=(0,j.d4)((e=>e.menu),j.bN),[t]=y.A.useForm(),a=(0,j.wA)(),{t:c}=(0,b.B)(),[u,v]=(0,n.useState)(!1),[x,m]=(0,n.useState)(N);(0,n.useEffect)((()=>{const e=N.findIndex((e=>e===l.status));let i=[N[e],N[e+1],"canceled"];e<0&&(i=[N[e+1],"canceled"]),m(i)}),[l]);return(0,f.jsx)(A.A,{visible:!!l,title:l.title,onCancel:i,footer:[(0,f.jsx)(s.A,{type:"primary",onClick:()=>t.submit(),loading:u,children:c("save")}),(0,f.jsx)(s.A,{type:"default",onClick:i,children:c("cancel")})],children:(0,f.jsx)(y.A,{form:t,layout:"vertical",onFinish:e=>{v(!0);const n={...e};h.A.updateStatus(l.id,n).then((()=>{i(),a((0,p.Ms)(d))})).finally((()=>v(!1)))},initialValues:{status:l.status},children:(0,f.jsx)(o.A,{gutter:12,children:(0,f.jsx)(r.A,{span:24,children:(0,f.jsx)(y.A.Item,{label:c("status"),name:"status",rules:[{required:!0,message:c("required")}],children:(0,f.jsx)(g.A,{children:x.map(((e,l)=>(0,f.jsx)(g.A.Option,{value:e,children:c(e)},e+l)))})})})})})})}var k=i(58127),w=i(53774),C=i(83239),S=i(29949),I=i(16339),q=i(59051),B=i.n(q);function M(){var e,l,i,y;const{activeMenu:A}=(0,j.d4)((e=>e.menu),j.bN),{defaultCurrency:g}=(0,j.d4)((e=>e.currency),j.bN),{statusList:N}=(0,j.d4)((e=>e.orderStatus),j.bN),q=null===A||void 0===A||null===(e=A.data)||void 0===e?void 0:e.data,{t:M}=(0,b.B)(),{id:$}=(0,x.g)(),D=(0,j.wA)(),F=(0,n.useRef)(),L=(0,n.useRef)(),[H,Y]=(0,n.useState)(!1),[E,O]=(0,n.useState)(null),[P,R]=(0,n.useState)(null),[K,V]=(0,n.useState)(null),W=[{title:M("id"),dataIndex:"id",key:"id",render:(e,l)=>{var i;return null===(i=l.stock)||void 0===i?void 0:i.id}},{title:M("product.name"),dataIndex:"product",key:"product",render:(e,l)=>{var i,n,d;return null===(i=l.stock)||void 0===i||null===(n=i.product)||void 0===n||null===(d=n.translation)||void 0===d?void 0:d.title}},{title:M("image"),dataIndex:"img",key:"img",render:(e,l)=>{var i,n;return(0,f.jsx)(d.A,{src:(0,m.A)(null===(i=l.stock)||void 0===i||null===(n=i.product)||void 0===n?void 0:n.img),alt:"product",width:100,height:"auto",className:"rounded",preview:!0,placeholder:!0})}},{title:M("price"),dataIndex:"origin_price",key:"origin_price",render:e=>(0,w.A)(e,null===g||void 0===g?void 0:g.symbol)},{title:M("quantity"),dataIndex:"quantity",key:"quantity"},{title:M("discount"),dataIndex:"discount",key:"discount",render:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,l=arguments.length>1?arguments[1]:void 0;return(0,w.A)(e/l.quantity,null===g||void 0===g?void 0:g.symbol)}},{title:M("tax"),dataIndex:"tax",key:"tax",render:(e,l)=>(0,w.A)(e/l.quantity,null===g||void 0===g?void 0:g.symbol)},{title:M("total.price"),dataIndex:"total_price",key:"total_price",render:(e,l)=>{var i;const n=e+(null===l||void 0===l||null===(i=l.addons)||void 0===i?void 0:i.reduce(((e,l)=>e+l.total_price),0));return(0,w.A)(n,null===g||void 0===g?void 0:g.symbol)}}],Z=()=>{O(null),R(null),V(null)};return(0,n.useEffect)((()=>{A.refetch&&(Y(!0),h.A.getById($).then((e=>{let{data:l}=e;const i=l.currency,n=l.user,d=l.id,t=l.price,s=l.created_at,a=l.details.map((e=>{var l,i;return{...e,title:null===(l=e.shop)||void 0===l||null===(i=l.translation)||void 0===i?void 0:i.title}}));D((0,p.Ok)({activeMenu:A,data:{details:a,currency:i,user:n,id:d,createdAt:s,price:t,data:l}}))})).finally((()=>{Y(!1),D((0,p.km)(A))})))}),[A.refetch]),(0,f.jsxs)("div",{className:"order_details",children:[(0,f.jsx)(t.A,{className:"order-details-info",title:(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(I.iHs,{className:"mr-2 icon"}),`${M("order")} ${null!==q&&void 0!==q&&q.id?`#${null===q||void 0===q?void 0:q.id} `:""}`," ",M("from.order")," ",null===q||void 0===q||null===(l=q.table)||void 0===l?void 0:l.name]}),extra:"delivered"!==(null===q||void 0===q?void 0:q.status)&&"canceled"!==(null===q||void 0===q?void 0:q.status)&&"accepted"!==(null===q||void 0===q?void 0:q.status)&&"cooking"!==(null===q||void 0===q?void 0:q.status)?(0,f.jsx)(s.A,{type:"primary",onClick:()=>O(q),children:M("change.status")}):null}),(0,f.jsx)(a.A,{spinning:H,children:(0,f.jsx)(t.A,{style:{minHeight:"200px"},children:(0,f.jsxs)(o.A,{hidden:H,className:"mb-3 order_detail",children:[(0,f.jsx)(r.A,{span:12,children:(0,f.jsxs)("div",{children:[M("created.date.&.time"),":",(0,f.jsxs)("span",{className:"ml-2",children:[(0,f.jsx)(S.cCc,{className:"mr-1"})," ",B()(null===q||void 0===q?void 0:q.created_at).format("YYYY-MM-DD HH:mm")," "]})]})}),(0,f.jsx)(r.A,{span:12,children:(0,f.jsxs)("div",{children:[M("status"),":",(0,f.jsx)("span",{className:"ml-2",children:"new"===(null===q||void 0===q?void 0:q.status)?(0,f.jsx)(c.A,{color:"blue",children:M(null===q||void 0===q?void 0:q.status)}):"canceled"===(null===q||void 0===q?void 0:q.status)?(0,f.jsx)(c.A,{color:"error",children:M(null===q||void 0===q?void 0:q.status)}):(0,f.jsx)(c.A,{color:"cyan",children:M(null===q||void 0===q?void 0:q.status)})})]})})," ",(0,f.jsx)(r.A,{span:12,children:(0,f.jsxs)("div",{children:[M("table"),":",(0,f.jsx)("span",{className:"ml-2",children:(null===q||void 0===q||null===(i=q.table)||void 0===i?void 0:i.name)||M("unspecified")})]})}),(0,f.jsx)(r.A,{span:12,children:(0,f.jsxs)("div",{children:[M("delivery_type"),":",(0,f.jsx)("span",{className:"ml-2",children:(null===q||void 0===q?void 0:q.delivery_type)||M("unspecified")})]})})]})})}),(0,f.jsxs)(t.A,{className:"w-100 order-table",children:[(0,f.jsx)(u.A,{ref:L,scroll:{x:!0},columns:W,dataSource:(null===(y=A.data)||void 0===y?void 0:y.details)||[],loading:H,rowKey:e=>e.id,pagination:!1}),(0,f.jsxs)(v.A,{size:100,className:"d-flex justify-content-end w-100 order-table__summary",children:[(0,f.jsxs)("div",{children:[(0,f.jsxs)("span",{children:[M("delivery.fee"),":"]}),(0,f.jsx)("br",{}),(0,f.jsxs)("span",{children:[M("order.tax"),":"]}),(0,f.jsx)("br",{}),(0,f.jsxs)("span",{children:[M("product"),":"]}),(0,f.jsx)("br",{}),(0,f.jsxs)("span",{children:[M("discount"),":"]}),(0,f.jsx)("br",{}),(0,f.jsxs)("h3",{children:[M("total.price"),":"]})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("span",{children:(0,w.A)(null===q||void 0===q?void 0:q.delivery_fee,null===g||void 0===g?void 0:g.symbol)}),(0,f.jsx)("br",{}),(0,f.jsx)("span",{children:(0,w.A)(null===q||void 0===q?void 0:q.tax,null===g||void 0===g?void 0:g.symbol)}),(0,f.jsx)("br",{}),(0,f.jsx)("span",{children:(0,w.A)(null===q||void 0===q?void 0:q.origin_price,null===g||void 0===g?void 0:g.symbol)}),(0,f.jsx)("br",{}),(0,f.jsx)("span",{children:(0,w.A)(null===q||void 0===q?void 0:q.total_discount,null===g||void 0===g?void 0:g.symbol)}),(0,f.jsx)("br",{}),(0,f.jsx)("h3",{ref:F,children:(0,w.A)(null===q||void 0===q?void 0:q.total_price,null===g||void 0===g?void 0:g.symbol)})]})]})]}),E&&(0,f.jsx)(_,{orderDetails:E,handleCancel:Z,status:N}),P&&(0,f.jsx)(k.A,{orderDetails:P,handleCancel:Z}),K&&(0,f.jsx)(C.A,{id:K,handleCancel:Z})]})}},29597:(e,l,i)=>{i.d(l,{A:()=>n});i(63620);function n(e){if(null===e||void 0===e||!e.location)return{lat:47.4143302506288,lng:8.532059477976883};const l=e.location.split(", ");return{lat:Number(null===l||void 0===l?void 0:l[0]),lng:Number(null===l||void 0===l?void 0:l[1])}}},41478:(e,l,i)=>{e.exports=i.p+"static/media/user.fbe7078c52acde79652d.jpg"},53774:(e,l,i)=>{i.d(l,{A:()=>d});var n=i(83291);function d(){var e,l;let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,d=arguments.length>1?arguments[1]:void 0,t=arguments.length>2?arguments[2]:void 0;const s=null===(e=n.M.getState())||void 0===e||null===(l=e.currency)||void 0===l?void 0:l.defaultCurrency,a=Number(i).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,"),o=d||(null===s||void 0===s?void 0:s.symbol)||"$";return"after"===(t||(null===s||void 0===s?void 0:s.position)||"before")?`${a} ${o}`:`${o} ${a}`}},58127:(e,l,i)=>{i.d(l,{A:()=>m});var n=i(9950),d=i(3969),t=i(32645),s=i(48538),a=i(87094),o=i(41988),r=i(99674),c=i(91854),u=i(82249),v=i(74623),x=i(70030),h=i(44414);function m(e){var l;let{orderDetails:i,handleCancel:m}=e;const{t:j}=(0,x.B)(),{activeMenu:p}=(0,c.d4)((e=>e.menu),c.bN),{deliverymans:y}=(0,c.d4)((e=>e.deliveryman),c.bN),[A]=d.A.useForm(),g=(0,c.wA)(),[b,f]=(0,n.useState)(!1);return(0,h.jsx)(t.A,{visible:!!i,title:i.title,onCancel:m,footer:[(0,h.jsx)(s.A,{type:"primary",onClick:()=>A.submit(),loading:b,children:j("save")}),(0,h.jsx)(s.A,{type:"default",onClick:m,children:j("cancel")})],children:(0,h.jsx)(d.A,{form:A,layout:"vertical",onFinish:e=>{const l={...e};f(!0),u.A.updateDelivery(i.id,l).then((()=>{m(),g((0,v.Ms)(p))})).finally((()=>f(!1)))},initialValues:{deliveryman:null===(l=i.deliveryman)||void 0===l?void 0:l.id},children:(0,h.jsx)(a.A,{gutter:12,children:(0,h.jsx)(o.A,{span:24,children:(0,h.jsx)(d.A.Item,{label:j("deliveryman"),name:"deliveryman",rules:[{required:!0,message:j("required")}],children:(0,h.jsx)(r.A,{children:y.map(((e,l)=>(0,h.jsxs)(r.A.Option,{value:e.id,className:"d-block",children:[e.firstname," ",e.lastname||""]},e.id)))})})})})})})}},73631:(e,l,i)=>{e.exports=i.p+"static/media/shop.46d7a94ca800c711764a.png"},83239:(e,l,i)=>{i.d(l,{A:()=>q});var n=i(12403),d=i(86366),t=i(32645),s=i(48538),a=i(23263),o=i(87094),r=i(41988),c=i(12916),u=i(9950),v=i(70030),x=i(82249),h=i(81446),m=i(29949),j=i(91854),p=i(63620),y=i(41478),A=i(73631),g=i(29597),b=i(47965),f=i(50327),N=i(25495),_=i(38310),k=i(44414);const{Step:w}=d.A,C=()=>(0,k.jsx)("img",{src:y,width:"50",alt:"Pin"}),S=()=>(0,k.jsx)("img",{src:A,width:"50",alt:"Pin"}),I=["blue","red","gold","volcano","cyan","lime"],q=e=>{var l,i,y,A,q,B;let{id:M,handleCancel:$}=e;const{t:D}=(0,v.B)(),[F,L]=(0,u.useState)(null),[H,Y]=(0,u.useState)(null),[E,O]=(0,u.useState)(null),{settings:P}=(0,j.d4)((e=>e.globalSettings),j.bN),R=(0,g.A)(P),[K,V]=(0,u.useState)(0),[W,Z]=(0,u.useState)((0,g.A)(P)),[z,G]=(0,u.useState)((0,g.A)(P)),[J,U]=(0,u.useState)([{id:0,name:"new",icon:(0,k.jsx)(b.A,{})},{id:1,name:"accepted",icon:(0,k.jsx)(m.LW,{})},{id:2,name:"ready",icon:(0,k.jsx)(f.NtI,{})},{id:3,name:"on_a_way",icon:(0,k.jsx)(N.o2P,{})},{id:4,name:"delivered",icon:(0,k.jsx)(N.eDZ,{})}]);const{google_map_key:X}=(0,j.d4)((e=>e.globalSettings.settings),j.bN);(0,u.useEffect)((()=>{L(!0),x.A.getById(M).then((e=>{var l;let{data:i}=e;U("canceled"===i.status?[{id:1,name:"new",icon:(0,k.jsx)(b.A,{})},{id:5,name:"canceled",icon:(0,k.jsx)(_.XfH,{})}]:J),V("canceled"===i.status?1:null===(l=J.find((e=>e.name===i.status)))||void 0===l?void 0:l.id),O("canceled"===i.status?"error":"success"),Y(i),G({lat:i.location.latitude,lng:i.location.longitude}),Z({lat:i.shop.location.latitude,lng:i.shop.location.longitude})})).finally((()=>{L(!1)}))}),[]);return(0,k.jsx)(k.Fragment,{children:(0,k.jsx)(t.A,{visible:!!M,title:D("show.locations"),closable:!0,onCancel:$,style:{minWidth:"80vw"},footer:[(0,k.jsx)(s.A,{type:"default",onClick:$,children:D("cancel")},"cancelBtn")],children:F?(0,k.jsx)(h.A,{}):(0,k.jsxs)(a.A,{children:[(0,k.jsx)(d.A,{current:K,status:E,className:"mb-5",children:null===J||void 0===J?void 0:J.map(((e,l)=>(0,k.jsx)(w,{title:D(e.name),icon:null===e||void 0===e?void 0:e.icon},e.id+l)))}),(0,k.jsxs)(o.A,{gutter:12,children:[(0,k.jsxs)(r.A,{span:12,children:[(0,k.jsxs)("h3",{children:[D("order.id")," #",null===H||void 0===H?void 0:H.id]}),(0,k.jsxs)("p",{children:[(0,k.jsx)(m.A5h,{})," ",null===H||void 0===H?void 0:H.created_at]}),(0,k.jsxs)("p",{children:[D("schedulet.at")," ",null===H||void 0===H?void 0:H.delivery_date]}),(0,k.jsxs)("span",{children:[(0,k.jsx)("strong",{children:null===H||void 0===H||null===(l=H.shop)||void 0===l||null===(i=l.translation)||void 0===i?void 0:i.title})," ",null===H||void 0===H||null===(y=H.details)||void 0===y?void 0:y.map(((e,l)=>{var i;return(0,k.jsx)(c.A,{className:"mb-2",color:I[l],children:null===e||void 0===e||null===(i=e.stock)||void 0===i?void 0:i.product.translation.title})}))]})]}),(0,k.jsxs)(r.A,{span:12,children:[(0,k.jsxs)("p",{children:[D("status")," ","new"===(null===H||void 0===H?void 0:H.status)?(0,k.jsx)(c.A,{color:"blue",children:D(null===H||void 0===H?void 0:H.status)}):"canceled"===(null===H||void 0===H?void 0:H.status)?(0,k.jsx)(c.A,{color:"error",children:D(null===H||void 0===H?void 0:H.status)}):(0,k.jsx)(c.A,{color:"cyan",children:D(null===H||void 0===H?void 0:H.status)})]}),(0,k.jsxs)("p",{children:[D("payment.method")," ",(0,k.jsx)("strong",{children:null===H||void 0===H||null===(A=H.transaction)||void 0===A||null===(q=A.payment_system)||void 0===q?void 0:q.tag})]}),(0,k.jsxs)("p",{children:[D("order.type")," ",(0,k.jsx)("strong",{children:null===H||void 0===H?void 0:H.delivery_type})]}),(0,k.jsxs)("p",{children:[D("payment.type")," ",(0,k.jsx)("strong",{children:null===H||void 0===H||null===(B=H.transaction)||void 0===B?void 0:B.status})]})]}),(0,k.jsxs)(r.A,{span:24,className:"mt-5",children:[(0,k.jsx)("h4",{children:D("map")}),(0,k.jsx)("div",{className:"map-container",style:{height:400,width:"100%"},children:(0,k.jsxs)(n.Ay,{bootstrapURLKeys:{key:X||p.CJ},defaultZoom:14,center:R,options:{fullscreenControl:!1},onGoogleApiLoaded:e=>{let{map:l,maps:i}=e;const n=[W,z].map((e=>({lat:Number(e.lat||"0"),lng:Number(e.lng||"0")})));let d=new i.LatLngBounds;for(var t=0;t<n.length;t++)d.extend(n[t]);l.fitBounds(d)},children:[(0,k.jsx)(S,{lat:null===W||void 0===W?void 0:W.lat,lng:null===W||void 0===W?void 0:W.lng}),(0,k.jsx)(C,{lat:null===z||void 0===z?void 0:z.lat,lng:null===z||void 0===z?void 0:z.lng})]})})]})]})]})})})}}}]);