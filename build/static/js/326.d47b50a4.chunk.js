"use strict";(self.webpackChunkjumlajumla_dashboard=self.webpackChunkjumlajumla_dashboard||[]).push([[326],{6566:(e,l,t)=>{t.d(l,{A:()=>o});var n=t(83291),a=t(63620);const o=()=>{var e,l;const{google_map_key:t}=null===(e=n.M.getState())||void 0===e||null===(l=e.globalSettings)||void 0===l?void 0:l.settings;return t||a.CJ}},14713:(e,l,t)=>{t.r(l),t.d(l,{default:()=>h});var n=t(9950),a=t(13564),o=t(12449),i=t(3969),s=t(23263),d=t(91854),r=t(74623),c=t(70030),u=t(71999),g=t(31281),v=t(58962),m=t(37332),f=t(91675),p=t(44414);const h=()=>{const{t:e}=(0,c.B)(),{activeMenu:l}=(0,d.d4)((e=>e.menu),d.bN),t=(0,d.wA)(),[h]=i.A.useForm(),b=(0,a.Zp)(),{id:A}=(0,a.g)(),[j,x]=(0,n.useState)(!1),{languages:y}=(0,d.d4)((e=>e.formLang),d.bN);function N(e){if(!e)return{};const{translations:l}=e,t=y.map((e=>{var t;return{[`title[${e.locale}]`]:null===(t=l.find((l=>l.locale===e.locale)))||void 0===t?void 0:t.title}}));return Object.assign({},...t)}(0,n.useEffect)((()=>()=>{const e=h.getFieldsValue(!0);e.open_time=JSON.stringify(null===e||void 0===e?void 0:e.open_time),e.close_time=JSON.stringify(null===e||void 0===e?void 0:e.close_time),t((0,r.Ok)({activeMenu:l,data:e}))}),[]);return(0,n.useEffect)((()=>{l.refetch&&(e=>{x(!0),v.A.getById(e).then((e=>{var n;let a=e.data;const o={...a,mapCoordinates:{lat:Number(null===a||void 0===a?void 0:a.location.latitude),lng:Number(null===a||void 0===a?void 0:a.location.longitude)},...N(a),address:null===(n=a.address)||void 0===n?void 0:n.address};t((0,r.Ok)({activeMenu:l,data:o})),h.setFieldsValue({...o})})).finally((()=>{t((0,r.km)(l)),x(!1)}))})(A)}),[l.refetch]),(0,p.jsx)(s.A,{loading:j,title:e("edit.branch"),className:"h-100",extra:(0,p.jsx)(u.A,{}),children:(0,p.jsx)(f.A,{form:h,handleSubmit:n=>{const a={title:(0,g.A)(y,n,"title"),address:{address:n.address,office:null,house:null,floor:null},location:{longitude:n.location.lng,latitude:n.location.lat}},i="seller/branch";return v.A.update(A,a).then((()=>{o.oR.success(e("successfully.updated")),(0,d.vA)((()=>{t((0,r.EK)({...l,nextUrl:i})),t((0,m.D)({}))})),b(`/${i}`)}))}})})}},29597:(e,l,t)=>{t.d(l,{A:()=>n});t(63620);function n(e){if(null===e||void 0===e||!e.location)return{lat:47.4143302506288,lng:8.532059477976883};const l=e.location.split(", ");return{lat:Number(null===l||void 0===l?void 0:l[0]),lng:Number(null===l||void 0===l?void 0:l[1])}}},31281:(e,l,t)=>{function n(e,l){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"title";const n=null===e||void 0===e?void 0:e.map((e=>({[null===e||void 0===e?void 0:e.locale]:l[`${t}[${null===e||void 0===e?void 0:e.locale}]`]?l[`${t}[${null===e||void 0===e?void 0:e.locale}]`]:void 0})));return Object.assign({},...n)}t.d(l,{A:()=>n})},71999:(e,l,t)=>{t.d(l,{A:()=>r});var n=t(9950),a=t(17811),o=t(91854),i=t(82406),s=t(12437),d=t(44414);const r=()=>{const e=(0,o.wA)(),{languages:l,defaultLang:t}=(0,o.d4)((e=>e.formLang),o.bN);(0,n.useEffect)((()=>{s.A.getAllActive().then((l=>{let{data:t}=l;e((0,i.Nn)(t)),e((0,i.Qq)(t.find((e=>!(null===e||void 0===e||!e.default))).locale))}))}),[]);return(0,d.jsx)(d.Fragment,{children:(0,d.jsx)(a.Ay.Group,{value:t,onChange:l=>{let{target:{value:t}}=l;e((0,i.Qq)(t))},className:"float-right",buttonStyle:"solid",children:null===l||void 0===l?void 0:l.map((e=>(0,d.jsx)(a.Ay.Button,{value:e.locale,children:e.title},e.id)))})})}},78498:(e,l,t)=>{t.d(l,{A:()=>p});var n=t(9950),a=t(97239);const o=t.p+"static/media/pin.0e41858db80c699cd8a2.png";var i=t(96011),s=t.n(i),d=t(63620);async function r(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d.CJ,t={latlng:`${null===e||void 0===e?void 0:e.lat},${null===e||void 0===e?void 0:e.lng}`,key:l};return s().get("https://maps.googleapis.com/maps/api/geocode/json",{params:t}).then((e=>{var l;let{data:t}=e;return null===(l=t.results[0])||void 0===l?void 0:l.formatted_address})).catch((e=>"not found"))}var c=t(52423),u=t(12449),g=t(70030),v=t(6566),m=t(44414);const f=(0,v.A)();const p=(0,a.GoogleApiWrapper)({apiKey:f,libraries:["places","geometry"]})((function(e){var l,t;const[i,s]=(0,n.useState)(),{t:d}=(0,g.B)(),v=async()=>{await navigator.geolocation.getCurrentPosition((function(e){const l={lat:e.coords.latitude,lng:e.coords.longitude};s(l)}),(function(e){u.oR.warning(d("turn.on.gps"))}))};(0,n.useEffect)((()=>{v()}),[]);const p=[{lat:Number(null===e||void 0===e||null===(l=e.location)||void 0===l?void 0:l.lat)||0,lng:Number(null===e||void 0===e||null===(t=e.location)||void 0===t?void 0:t.lng)||0}];for(var h=new e.google.maps.LatLngBounds,b=0;b<p.length;b++)h.extend(p[b]);return(0,m.jsxs)("div",{className:"map-container",style:{height:400,width:"100%"},children:[(0,m.jsx)("button",{className:"map-button",type:"button",onClick:()=>{v(),i&&(async l=>{const t={lat:null===l||void 0===l?void 0:l.lat,lng:null===l||void 0===l?void 0:l.lng};e.setLocation(t);const n=await r(t,f);e.setAddress(n)})(i)},children:(0,m.jsx)(c.uFi,{})}),(0,m.jsx)(a.Map,{cursor:"pointer",onClick:async(l,t,n)=>{const{latLng:a}=n,o={lat:a.lat(),lng:a.lng()};e.setLocation(o);const i=await r(o,f);e.setAddress(i)},google:e.google,defaultZoom:12,zoom:10,className:"clickable",initialCenter:e.location,center:e.location,children:(0,m.jsx)(a.Marker,{position:e.location,icon:{url:o,scaledSize:new e.google.maps.Size(32,32)},className:"marker"})})]})}))},91675:(e,l,t)=>{t.d(l,{A:()=>p});var n=t(9950),a=t(3969),o=t(87094),i=t(41988),s=t(55902),d=t(48538),r=t(78498),c=t(70030),u=t(91854),g=t(29597),v=t(56713),m=t(63620),f=t(44414);function p(e){var l,t;let{form:p,handleSubmit:h}=e;const{t:b}=(0,c.B)(),{activeMenu:A}=(0,u.d4)((e=>e.menu),u.bN),{languages:j,defaultLang:x}=(0,u.d4)((e=>e.formLang),u.bN),{settings:y}=(0,u.d4)((e=>e.globalSettings),u.bN),{google_map_key:N}=(0,u.d4)((e=>e.globalSettings.settings),u.bN),{ref:S}=(0,v.usePlacesWidget)({apiKey:N||m.CJ,onPlaceSelected:e=>{const l={lat:null===e||void 0===e?void 0:e.geometry.location.lat(),lng:null===e||void 0===e?void 0:e.geometry.location.lng()};_(l),p.setFieldsValue({[`address[${x}]`]:null===e||void 0===e?void 0:e.formatted_address})}}),[k,w]=(0,n.useState)(!1),[C,_]=(0,n.useState)(null!==(l=null===A||void 0===A||null===(t=A.data)||void 0===t?void 0:t.mapCoordinates)&&void 0!==l?l:(0,g.A)(y));return(0,f.jsxs)(a.A,{name:"branch-form",layout:"vertical",onFinish:e=>{w(!0);const l={...e,location:C};h(l).finally((()=>w(!1)))},form:p,initialValues:{...A.data},className:"d-flex flex-column h-100",children:[(0,f.jsxs)(o.A,{gutter:12,children:[(0,f.jsx)(i.A,{span:12,children:j.map(((e,l)=>(0,f.jsx)(a.A.Item,{label:b("title"),name:`title[${e.locale}]`,rules:[{required:e.locale===x,message:b("required")}],hidden:e.locale!==x,children:(0,f.jsx)(s.A,{})},"title"+l)))}),(0,f.jsx)(i.A,{span:12,children:(0,f.jsx)(a.A.Item,{label:b("address"),name:"address",rules:[{required:!0,message:b("required")}],children:(0,f.jsx)("input",{className:"address-input",ref:S,placeholder:""})})}),(0,f.jsx)(i.A,{span:24,children:(0,f.jsx)(r.A,{location:C,setLocation:_,setAddress:e=>p.setFieldsValue({address:e})})})]}),(0,f.jsx)("div",{className:"flex-grow-1 d-flex flex-column justify-content-end",children:(0,f.jsx)("div",{className:"pb-5",children:(0,f.jsx)(d.A,{type:"primary",htmlType:"submit",loading:k,children:b("submit")})})})]})}}}]);