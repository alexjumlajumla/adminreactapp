"use strict";(self.webpackChunkjumlajumla_dashboard=self.webpackChunkjumlajumla_dashboard||[]).push([[3207],{10557:(l,e,n)=>{n.d(e,{A:()=>j});var o=n(9950),t=n(3969),i=n(87094),u=n(41988),a=n(8724),d=n(87864),s=n(25933),r=n(48538),v=n(59051),c=n.n(v),p=n(70030),h=n(91854),m=n(67231),b=n(80905),x=n(44414);function j(l){let{form:e,handleSubmit:n}=l;const{t:v}=(0,p.B)(),{activeMenu:j}=(0,h.d4)((l=>l.menu),h.bN),[f,g]=(0,o.useState)(!1),[A,_]=(0,o.useState)({product:!1,bonusProduct:!1});return(0,x.jsxs)(t.A,{name:"product-bonus-form",layout:"vertical",onFinish:l=>{g(!0),n(l).finally((()=>g(!1)))},form:e,initialValues:{status:!0,...j.data,...(()=>{var l,e;if(null===(l=j.data)||void 0===l||!l.expired_at)return{};const n=JSON.parse(null===(e=j.data)||void 0===e?void 0:e.expired_at);return{expired_at:c()(n,"HH:mm:ss")}})()},className:"d-flex flex-column h-100",children:[(0,x.jsxs)(i.A,{gutter:12,children:[(0,x.jsx)(u.A,{span:12,children:(0,x.jsx)(t.A.Item,{label:v("products.stock"),name:"bonusable_id",rules:[{required:!0,message:v("required")}],children:(0,x.jsx)(b.j,{fetchOptions:function(l){let{page:e=1,search:n}=l;const o={page:e,search:null!==n&&void 0!==n&&n.length?n:void 0};return m.A.getStock(o).then((l=>{var e,n;return _({...A,product:(null===l||void 0===l||null===(e=l.meta)||void 0===e?void 0:e.current_page)<(null===l||void 0===l||null===(n=l.meta)||void 0===n?void 0:n.last_page)}),l.data.map((l=>{var e,n,o,t,i;return{label:`${null===l||void 0===l||null===(e=l.product)||void 0===e||null===(n=e.translation)||void 0===n?void 0:n.title} ${null!==l&&void 0!==l&&null!==(o=l.extras)&&void 0!==o&&o.length?`=> ${null===l||void 0===l||null===(t=l.extras)||void 0===t||null===(i=t.map((l=>{var e,n;return`${null===l||void 0===l||null===(e=l.group)||void 0===e||null===(n=e.translation)||void 0===n?void 0:n.title}: ${null===l||void 0===l?void 0:l.value}`})))||void 0===i?void 0:i.join(", ")}`:""}`,value:null===l||void 0===l?void 0:l.id,key:null===l||void 0===l?void 0:l.id}}))}))},hasMore:A.product,allowClear:!1})})}),(0,x.jsx)(u.A,{span:12,children:(0,x.jsx)(t.A.Item,{label:v("product.quantity"),name:"value",rules:[{required:!0,message:v("required")}],children:(0,x.jsx)(a.A,{className:"w-100"})})}),(0,x.jsx)(u.A,{span:12,children:(0,x.jsx)(t.A.Item,{label:v("bonus.product.stock"),name:"bonus_stock_id",rules:[{required:!0,message:v("required")}],children:(0,x.jsx)(b.j,{fetchOptions:function(l){let{page:e=1,search:n}=l;const o={page:e,search:null!==n&&void 0!==n&&n.length?n:void 0};return m.A.getStock(o).then((l=>{var e,n;return _({...A,bonusProduct:(null===l||void 0===l||null===(e=l.meta)||void 0===e?void 0:e.current_page)<(null===l||void 0===l||null===(n=l.meta)||void 0===n?void 0:n.last_page)}),l.data.map((l=>{var e,n,o,t,i;return{label:`${null===l||void 0===l||null===(e=l.product)||void 0===e||null===(n=e.translation)||void 0===n?void 0:n.title} ${null!==l&&void 0!==l&&null!==(o=l.extras)&&void 0!==o&&o.length?`=> ${null===l||void 0===l||null===(t=l.extras)||void 0===t||null===(i=t.map((l=>{var e,n;return`${null===l||void 0===l||null===(e=l.group)||void 0===e||null===(n=e.translation)||void 0===n?void 0:n.title}: ${null===l||void 0===l?void 0:l.value}`})))||void 0===i?void 0:i.join(", ")}`:""}`,value:null===l||void 0===l?void 0:l.id,key:null===l||void 0===l?void 0:l.id}}))}))},hasMore:A.bonusProduct,allowClear:!1})})}),(0,x.jsx)(u.A,{span:12,children:(0,x.jsx)(t.A.Item,{label:v("bonus.product.quantity"),name:"bonus_quantity",rules:[{required:!0,message:v("required")}],children:(0,x.jsx)(a.A,{className:"w-100"})})}),(0,x.jsx)(u.A,{span:12,children:(0,x.jsx)(t.A.Item,{name:"expired_at",label:v("expired.at"),rules:[{required:!0,message:v("required")}],children:(0,x.jsx)(d.A,{className:"w-100",placeholder:"",disabledDate:l=>c()().add(-1,"days")>=l})})}),(0,x.jsx)(u.A,{span:8,children:(0,x.jsx)(t.A.Item,{label:v("active"),name:"status",valuePropName:"checked",children:(0,x.jsx)(s.A,{})})})]}),(0,x.jsx)("div",{className:"flex-grow-1 d-flex flex-column justify-content-end",children:(0,x.jsx)("div",{className:"pb-5",children:(0,x.jsx)(r.A,{type:"primary",htmlType:"submit",loading:f,children:v("submit")})})})]})}},33207:(l,e,n)=>{n.r(e),n.d(e,{default:()=>j});var o=n(9950),t=n(13564),i=n(12449),u=n(3969),a=n(23263),d=n(91854),s=n(74623),r=n(70030),v=n(59051),c=n.n(v),p=n(96591),h=n(39095),m=n(81446),b=n(10557),x=n(44414);const j=()=>{const{t:l}=(0,r.B)(),{activeMenu:e}=(0,d.d4)((l=>l.menu),d.bN),n=(0,d.wA)(),[v]=u.A.useForm(),j=(0,t.Zp)(),[f,g]=(0,o.useState)(!1),{id:A}=(0,t.g)();(0,o.useEffect)((()=>()=>{const l=v.getFieldsValue(!0),o={...l,expired_at:JSON.stringify(null===l||void 0===l?void 0:l.expired_at)};n((0,s.Ok)({activeMenu:e,data:o}))}),[]);const _=l=>{g(!0),h.A.getById(l).then((l=>{!function(l){var o,t,i,u,a,d,r,p,h,m,b,x,j,f,A,_,k,y,S,$;const q={...l,expired_at:c()(l.expired_at,"YYYY-MM-DD"),bonusable_id:{label:`${null===l||void 0===l||null===(o=l.bonusable)||void 0===o||null===(t=o.product)||void 0===t||null===(i=t.translation)||void 0===i?void 0:i.title} ${null!==l&&void 0!==l&&null!==(u=l.bonusable)&&void 0!==u&&null!==(a=u.extras)&&void 0!==a&&a.length?` => ${null===l||void 0===l||null===(d=l.bonusable)||void 0===d||null===(r=d.extras)||void 0===r||null===(p=r.map((l=>{var e,n;return`${null===l||void 0===l||null===(e=l.group)||void 0===e||null===(n=e.translation)||void 0===n?void 0:n.title}: ${null===l||void 0===l?void 0:l.value}`})))||void 0===p?void 0:p.join(", ")}`:""}`,value:null===l||void 0===l||null===(h=l.bonusable)||void 0===h?void 0:h.id,key:null===l||void 0===l||null===(m=l.bonusable)||void 0===m?void 0:m.id},bonus_stock_id:{label:`${null===l||void 0===l||null===(b=l.bonusStock)||void 0===b||null===(x=b.product)||void 0===x||null===(j=x.translation)||void 0===j?void 0:j.title} ${null!==l&&void 0!==l&&null!==(f=l.bonusStock)&&void 0!==f&&null!==(A=f.extras)&&void 0!==A&&A.length?` => ${null===l||void 0===l||null===(_=l.bonusStock)||void 0===_||null===(k=_.extras)||void 0===k||null===(y=k.map((l=>{var e,n;return`${null===l||void 0===l||null===(e=l.group)||void 0===e||null===(n=e.translation)||void 0===n?void 0:n.title}: ${null===l||void 0===l?void 0:l.value}`})))||void 0===y?void 0:y.join(", ")}`:""}`,value:null===l||void 0===l||null===(S=l.bonusStock)||void 0===S?void 0:S.id,key:null===l||void 0===l||null===($=l.bonusStock)||void 0===$?void 0:$.id}};v.setFieldsValue({...q}),n((0,s.Ok)({activeMenu:e,data:{...q,expired_at:JSON.stringify(q.expired_at)}})),g(!1)}(l.data)})).finally((()=>{g(!1),n((0,s.km)(e))}))};(0,o.useEffect)((()=>{e.refetch&&_(A)}),[e.refetch]);return(0,x.jsx)(a.A,{title:l("edit.bonus"),className:"h-100",children:f?(0,x.jsx)(m.A,{}):(0,x.jsx)(b.A,{form:v,handleSubmit:o=>{const t={expired_at:c()(o.expired_at).format("YYYY-MM-DD"),status:o.status,type:"count",bonusable_id:o.bonusable_id.value,value:o.value,bonus_stock_id:o.bonus_stock_id.value,bonus_quantity:o.bonus_quantity},u="seller/bonus/product";h.A.update(A,t).then((()=>{i.oR.success(l("successfully.updated")),(0,d.vA)((()=>{n((0,s.EK)({...e,nextUrl:u})),n((0,p.q)({}))})),j(`/${u}`)}))}})})}},80905:(l,e,n)=>{n.d(e,{j:()=>s});var o=n(9950),t=n(95491),i=n.n(t),u=n(99674),a=n(90650),d=n(44414);const s=l=>{let{fetchOptions:e,debounceTimeout:n=400,hasMore:t,refetchOnFocus:s=!1,...r}=l;const[v,c]=(0,o.useState)(!1),[p,h]=(0,o.useState)([]),[m,b]=(0,o.useState)(!1),[x,j]=(0,o.useState)(null),[f,g]=(0,o.useState)(1),A=(0,o.useMemo)((()=>i()((l=>{h([]),j(l),c(!0),e({search:l}).then((l=>{h(l),g(2),c(!1)})).finally((()=>b(!1)))}),n)),[e,n,f]);return(0,d.jsxs)(u.A,{showSearch:!0,allowClear:!0,onPopupScroll:async l=>{const n=l.target;m||n.scrollTop+n.offsetHeight!==n.scrollHeight||t&&(b(!0),e({search:x,page:f}).then((l=>{g((l=>l+1)),h([...p,...l])})).finally((()=>b(!1))))},labelInValue:!0,filterOption:!1,onSearch:A,notFoundContent:v?(0,d.jsx)(a.A,{size:"small"}):"no results",onFocus:()=>{s?A(""):null!==p&&void 0!==p&&p.length||A("")},...r,children:[p.map(((l,e)=>(0,d.jsx)(u.A.Option,{value:l.value,children:l.label},e))),m&&(0,d.jsx)(u.A.Option,{children:(0,d.jsx)(a.A,{size:"small"})})]})}}}]);