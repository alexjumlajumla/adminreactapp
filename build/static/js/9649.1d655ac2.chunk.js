"use strict";(self.webpackChunkjumlajumla_dashboard=self.webpackChunkjumlajumla_dashboard||[]).push([[9649],{69649:(e,t,a)=>{a.r(t),a.d(t,{default:()=>z});var l=a(9950),n=a(54909),i=a(13564),s=a(70030),d=a(34967),o=a(80737),r=a(20978),u=a(12916),c=a(48538),v=a(23263),h=a(12203),m=a(69554),p=a(24513),x=a(74623),j=a(91854),g=a(12449),A=a(76083),y=a(55386),b=a(28645),f=a(8168),w=a(88986),k=a(3462),_=a(1669),C=a(98890),q=a(59051),I=a.n(q),P=a(3969),S=a(32645),M=a(87094),T=a(41988),N=a(55902),B=a(44414);function K(e){let{data:t,handleCancel:a,handleOk:n,visible:i}=e;const{t:d}=(0,s.B)(),[o]=P.A.useForm(),[r,u]=(0,l.useState)(!1);return(0,B.jsx)(S.A,{title:d(t.title),visible:i,onCancel:a,footer:[(0,B.jsx)(c.A,{type:"primary",onClick:()=>o.submit(),loading:r,children:d("save")}),(0,B.jsx)(c.A,{type:"default",onClick:a,children:d("cancel")})],children:(0,B.jsx)(P.A,{layout:"vertical",onFinish:e=>{u(!0);const t={...e,status:"canceled"};n(t)},form:o,children:(0,B.jsx)(P.A.Item,{children:(0,B.jsx)(M.A,{className:"mt-4",children:(0,B.jsx)(T.A,{span:24,children:(0,B.jsx)(P.A.Item,{name:"status_note",label:d("note"),rules:[{validator:(e,t)=>t?t&&""===(null===t||void 0===t?void 0:t.trim())?Promise.reject(new Error(d("no.empty.space"))):t&&(null===t||void 0===t?void 0:t.trim().length)<2?Promise.reject(new Error(d("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(d("required")))}],children:(0,B.jsx)(N.A.TextArea,{maxLength:250,showCount:!0})})})})})})})}const E={type:"category"};function Y(e){var t,a,n;let{parentId:d,type:q="main",activeTab:P="request"}=e;const{t:S}=(0,s.B)(),{setIsModalVisible:M}=(0,l.useContext)(y.o),[T,N]=(0,l.useState)(!1),[Y,z]=(0,l.useState)(!1),[O,$]=(0,l.useState)(null),D=(0,j.wA)(),F=(0,i.Zp)(),{activeMenu:H}=(0,j.d4)((e=>e.menu),j.bN),{data:R,meta:L,loading:U,params:V}=(0,j.d4)((e=>e.requestModels),j.bN),X=H.data,{uuid:Z}=(0,i.g)(),G={sort:null===X||void 0===X?void 0:X.sort,column:null===X||void 0===X?void 0:X.column,perPage:null===X||void 0===X?void 0:X.perPage,page:null===X||void 0===X?void 0:X.page,parent_id:d},[J,Q]=(0,l.useState)([{title:S("created.by"),dataIndex:"createdBy",key:"createdBy",is_show:!0,render:e=>(0,B.jsxs)("span",{children:[e.firstname," ",null===e||void 0===e?void 0:e.lastname," ",(0,B.jsx)("a",{href:`tel:${null===e||void 0===e?void 0:e.phone}`,children:null===e||void 0===e?void 0:e.phone})]})},{title:S("created.at"),dataIndex:"created_at",key:"created_at",is_show:!0,render:e=>I()(e).format("YYYY-MM-DD HH:mm")},{title:S("name"),dataIndex:"name",key:"name",is_show:!0,render:(e,t)=>{var a,l,n,i,s,d;return(0,B.jsxs)(o.A,{children:[null===t||void 0===t||null===(a=t.model)||void 0===a||null===(l=a.translation)||void 0===l?void 0:l.title," ",(0,B.jsx)(_.Kly,{})," ",null===t||void 0===t||null===(n=t.data)||void 0===n||null===(i=n.title)||void 0===i?void 0:i[null===t||void 0===t||null===(s=t.model)||void 0===s||null===(d=s.translation)||void 0===d?void 0:d.locale]]})}},{title:S("image"),dataIndex:"img",key:"img",is_show:!0,render:(e,t)=>{var a,l,n;return(0,B.jsxs)(o.A,{children:[(0,B.jsx)(r.A,{src:(0,m.A)(null===t||void 0===t||null===(a=t.model)||void 0===a?void 0:a.img),alt:"img_gallery",width:100,className:"rounded",preview:!0,placeholder:!0}),(0,B.jsx)(_.Kly,{}),(0,B.jsx)(r.A,{src:(0,m.A)(null===t||void 0===t||null===(l=t.data)||void 0===l||null===(n=l.images)||void 0===n?void 0:n.at(0)),alt:"img_gallery",width:100,className:"rounded",preview:!0,placeholder:!0})]})}},{title:S("status"),is_show:!0,dataIndex:"status",key:"status",render:(e,t)=>(0,B.jsx)("div",{children:"pending"===e?(0,B.jsx)(u.A,{color:"blue",children:S(e)}):"canceled"===e?(0,B.jsx)(u.A,{color:"error",children:S(e)}):(0,B.jsx)(u.A,{color:"cyan",children:S(e)})})},{title:S("options"),key:"options",dataIndex:"options",is_show:!0,render:(e,t)=>(0,B.jsxs)(o.A,{children:[(0,B.jsx)(c.A,{icon:(0,B.jsx)(p.A,{}),onClick:()=>(e=>{D((0,x.X4)({url:`category-request/${e.id}`,id:"request_edit",name:S("request.edit")})),F(`/category-request/${e.id}`,{state:{parentId:d,parentUuid:Z}})})(t)}),(0,B.jsx)(c.A,{type:"primary",onClick:()=>{$([{id:t.id,status:"approved"}]),M(!0)},children:S("accept")}),(0,B.jsx)(c.A,{type:"primary",danger:!0,onClick:()=>{$([{id:t.id,status:"canceled"}]),N(!0)},children:S("decline")})]})}]);(0,l.useEffect)((()=>{H.refetch&&"request"===P&&(D((0,k.uj)(G)),D((0,x.km)(H)))}),[H.refetch]),(0,w.A)((()=>{"request"===P&&D((0,k.uj)(G))}),[P,H.data]);const W=e=>{z(!0);const t={status:null===O||void 0===O?void 0:O.at(0).status,status_note:null===e||void 0===e?void 0:e.status_note};C.A.changeStatus(null===O||void 0===O?void 0:O.at(0).id,t).then((()=>{g.oR.success(S("successfully.changed")),D((0,k.uj)(E)),M(!1),$(null)})).finally((()=>{N(!1),z(!1)}))},ee={selectedRowKeys:O,onChange:e=>{$(e)}};return(0,B.jsxs)(v.A,{title:S("requests"),extra:(0,B.jsx)(o.A,{wrap:!0,children:(0,B.jsx)(b.A,{columns:J,setColumns:Q})}),children:[(0,B.jsx)(h.A,{scroll:{x:!0},rowSelection:ee,columns:null===J||void 0===J?void 0:J.filter((e=>e.is_show)),dataSource:R,pagination:{pageSize:V.perPage,page:(null===(t=H.data)||void 0===t?void 0:t.page)||1,total:L.total,defaultCurrent:null===(a=H.data)||void 0===a?void 0:a.page,current:null===(n=H.data)||void 0===n?void 0:n.page},rowKey:e=>e.key,onChange:function(e,t,a){const{pageSize:l,current:n}=e,{field:i,order:s}=a,d=(0,f.A)(s);D((0,x.Ok)({activeMenu:H,data:{...H.data,perPage:l,page:n,column:i,sort:d}}))},loading:U}),(0,B.jsx)(A.A,{click:W,text:S("change.status"),setText:$,loading:Y}),(0,B.jsx)(K,{data:{title:"decline"},visible:T,handleCancel:()=>N(!1),handleOk:W,laoding:Y})]})}function z(){var e,t;const{t:a}=(0,s.B)(),o=(0,i.zy)(),r=(0,j.wA)(),{activeMenu:u}=(0,j.d4)((e=>e.menu),j.bN),[c,v]=(0,l.useState)((null===(e=o.state)||void 0===e?void 0:e.tab)||"list");return(0,B.jsxs)(n.A,{defaultActiveKey:(null===(t=o.state)||void 0===t?void 0:t.tab)||"list",destroyInactiveTabPane:!0,onChange:e=>{r((0,x.Ms)(u)),v(e)},children:[(0,B.jsx)(n.A.TabPane,{tab:a("category.list"),children:(0,B.jsx)(d.A,{activeTab:c})},"list"),(0,B.jsx)(n.A.TabPane,{tab:a("requests"),children:(0,B.jsx)(Y,{activeTab:c})},"request")]})}}}]);