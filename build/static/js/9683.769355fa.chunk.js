(self.webpackChunkjumlajumla_dashboard=self.webpackChunkjumlajumla_dashboard||[]).push([[9683],{42634:()=>{},62545:(e,l,t)=>{"use strict";t.d(l,{A:()=>o});var a=t(89379),d=t(9950);const i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888.3 693.2c-42.5-24.6-94.3-18-129.2 12.8l-53-30.7V523.6c0-15.7-8.4-30.3-22-38.1l-136-78.3v-67.1c44.2-15 76-56.8 76-106.1 0-61.9-50.1-112-112-112s-112 50.1-112 112c0 49.3 31.8 91.1 76 106.1v67.1l-136 78.3c-13.6 7.8-22 22.4-22 38.1v151.6l-53 30.7c-34.9-30.8-86.8-37.4-129.2-12.8-53.5 31-71.7 99.4-41 152.9 30.8 53.5 98.9 71.9 152.2 41 42.5-24.6 62.7-73 53.6-118.8l48.7-28.3 140.6 81c6.8 3.9 14.4 5.9 22 5.9s15.2-2 22-5.9L674.5 740l48.7 28.3c-9.1 45.7 11.2 94.2 53.6 118.8 53.3 30.9 121.5 12.6 152.2-41 30.8-53.6 12.6-122-40.7-152.9zm-673 138.4a47.6 47.6 0 01-65.2-17.6c-13.2-22.9-5.4-52.3 17.5-65.5a47.6 47.6 0 0165.2 17.6c13.2 22.9 5.4 52.3-17.5 65.5zM522 463.8zM464 234a48.01 48.01 0 0196 0 48.01 48.01 0 01-96 0zm170 446.2l-122 70.3-122-70.3V539.8l122-70.3 122 70.3v140.4zm239.9 133.9c-13.2 22.9-42.4 30.8-65.2 17.6-22.8-13.2-30.7-42.6-17.5-65.5s42.4-30.8 65.2-17.6c22.9 13.2 30.7 42.5 17.5 65.5z"}}]},name:"deployment-unit",theme:"outlined"};var s=t(25085),n=function(e,l){return d.createElement(s.A,(0,a.A)((0,a.A)({},e),{},{ref:l,icon:i}))};n.displayName="DeploymentUnitOutlined";const o=d.forwardRef(n)},65820:(e,l,t)=>{"use strict";t.d(l,{s:()=>s});var a=t(13564),d=t(21215),i=t.n(d);const s=()=>{const e=(0,a.Zp)(),l=(0,a.zy)(),t=i().parse(l.search,{ignoreQueryPrefix:!0});return{values:t,set:(l,a)=>e({search:i().stringify({...t,[l]:a})}),reset:l=>{const a={...t};a[l]&&delete a[l],e({search:i().stringify({...a})})},clear:()=>e({search:i().stringify({})}),merge:l=>e({search:i().stringify({...t,...l})}),get:e=>t[e],setMultiple:l=>{const a={...t,...l};e({search:i().stringify(a)})},resetMultiple:l=>{const a={...t};l.forEach((e=>{a[e]&&delete a[e]})),e({search:i().stringify(a)})}}}},68387:(e,l,t)=>{"use strict";t.d(l,{P:()=>a});const a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;const l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let t="";for(let a=0;a<e;a++){t+=l[Math.floor(62*Math.random())]}return t}},81824:(e,l,t)=>{"use strict";t.r(l),t.d(l,{default:()=>z});var a=t(9950),d=t(86366),i=t(23263),s=t(90650),n=t(71999),o=t(13564),u=t(91854),r=t(74623),v=t(70030),c=t(65820),m=t(98890),p=t(49326),x=t(44832),h=t(93567),k=t(57844),j=t(3969),y=t(40895),A=t(87094),g=t(41988),f=t(55902),b=t(48538),q=t(8724),_=t(99674),w=t(80737),N=t(62545),C=t(44070),F=t(47933),I=t(47992),$=t(45321),V=t(34537),M=t(44414);const O=e=>{var l;let{prev:t,next:d,isRequest:s}=e;const{t:n}=(0,v.B)(),[c]=j.A.useForm(),{uuid:m}=(0,o.g)(),{activeMenu:p}=(0,u.d4)((e=>e.menu),u.bN),[x,h]=(0,a.useState)(null),[k,O]=(0,a.useState)(null),[S,W]=(0,a.useState)([]),z=(0,u.wA)(),E=(0,o.zy)(),{defaultLang:R}=(0,u.d4)((e=>e.formLang),u.bN),{defaultCurrency:B}=(0,u.d4)((e=>e.currency),u.bN);const L=async e=>{var l;const t={search:e,addon:1,shop_id:null===p||void 0===p||null===(l=p.data)||void 0===l?void 0:l.shop_id,"statuses[0]":"published","statuses[1]":"pending",active:1},a=await F.A.getAll(t).then((e=>e.data.map((e=>{var l;return{label:null===e||void 0===e||null===(l=e.translation)||void 0===l?void 0:l.title,value:null===e||void 0===e?void 0:e.id}}))))||[];return[{label:n("all.addons"),value:"all",key:"all"},...a]};(0,a.useEffect)((()=>{var e;if(s)if(null!==(e=E.state)&&void 0!==e&&e.generate){var l,t,a,d,i;const e=(0,$.A)(null===p||void 0===p||null===(l=p.data.extras)||void 0===l?void 0:l.map((e=>e.values||[]))),s=e.map((e=>{var l,t;if(e.every((e=>"undefined"!==typeof e.stock_id))){var a,d,i;const l=null===(a=p.data)||void 0===a||null===(d=a.actualStocks)||void 0===d?void 0:d.find((l=>l.extras.every((l=>e.some((e=>e.value===l.id)))))),t=[];return null===l||void 0===l||null===(i=l.addons)||void 0===i||i.forEach((e=>{var l,a,d;e.product&&t.push({label:(null===e||void 0===e||null===(l=e.product)||void 0===l||null===(a=l.translation)||void 0===a?void 0:a.title)||(null===e||void 0===e?void 0:e.label),value:(null===e||void 0===e||null===(d=e.product)||void 0===d?void 0:d.id)||(null===e||void 0===e?void 0:e.value)})})),{price:(null===l||void 0===l?void 0:l.price)||0,quantity:(null===l||void 0===l?void 0:l.quantity)||0,stock_id:null===l||void 0===l?void 0:l.id,tax:(null===p||void 0===p?void 0:p.data.tax)||0,addons:t,...Object.assign({},...e.map(((e,l)=>({[`extras[${l}]`]:{label:e.label,value:e.value,group:p.data.extras[l].label}}))))}}return{price:0,quantity:0,tax:(null===(l=p.data)||void 0===l?void 0:l.tax)||0,sku:null===p||void 0===p||null===(t=p.data)||void 0===t?void 0:t.sku,addons:[],...Object.assign({},...e.map(((e,l)=>({[`extras[${l}]`]:{label:e.label,value:e.value}}))))}}));let v=[];if(0===e.length&&0!==(null===(t=p.data)||void 0===t||null===(a=t.actualStocks)||void 0===a?void 0:a.length)){var n,o,u;const e=null===(n=p.data.actualStocks)||void 0===n?void 0:n.at(0),l=[];null===e||void 0===e||null===(o=e.addons)||void 0===o||o.forEach((e=>{var t,a,d;e.product&&l.push({label:(null===e||void 0===e||null===(t=e.product)||void 0===t||null===(a=t.translation)||void 0===a?void 0:a.title)||(null===e||void 0===e?void 0:e.label),value:(null===e||void 0===e||null===(d=e.product)||void 0===d?void 0:d.id)||(null===e||void 0===e?void 0:e.value)})})),v=[{price:(null===e||void 0===e?void 0:e.price)||0,quantity:(null===e||void 0===e?void 0:e.quantity)||0,sku:null===e||void 0===e?void 0:e.sku,tax:(null===(u=p.data)||void 0===u?void 0:u.tax)||0,addons:e?l:[]}]}var r;if(0===e.length&&0===(null===p||void 0===p||null===(d=p.data)||void 0===d||null===(i=d.actualStocks)||void 0===i?void 0:i.length))v=[{price:void 0,quantity:0,sku:null===p||void 0===p?void 0:p.data.sku,tax:(null===(r=p.data)||void 0===r?void 0:r.tax)||0,addons:[]}];const m=v.concat(s);W(p.data.actualStocks.map((e=>e.id))),c.setFieldsValue({stocks:m})}else{var v,x;const e=null===(v=p.data.stocks)||void 0===v?void 0:v.map((e=>{var l;return{price:e.price,quantity:e.quantity,tax:p.data.tax,stock_id:e.stock_id,sku:e.sku,...Object.assign({},...null===(l=e.ids)||void 0===l?void 0:l.map(((e,l)=>({[`extras[${l}]`]:{label:e.label,value:e.value,group:e.group}})))),addons:e.addons}}));W((null===(x=p.data)||void 0===x?void 0:x.delete_ids)||[]),c.setFieldsValue({stocks:e})}else!function(e){O(!0),F.A.getById(e).then((e=>{var l,t,a;const d=(0,$.A)(null===p||void 0===p||null===(l=p.data.extras)||void 0===l?void 0:l.map((e=>e.values||[]))),i=d.map(((l,t)=>{var a,d;if(l.every((e=>"undefined"!==typeof e.stock_id))){var i;const t=e.data.stocks.find((e=>e.extras.every((e=>l.some((l=>l.value===e.id)))))),a=[];return null===t||void 0===t||null===(i=t.addons)||void 0===i||i.forEach((e=>{var l,t,d;e.product&&a.push({label:(null===e||void 0===e||null===(l=e.product)||void 0===l||null===(t=l.translation)||void 0===t?void 0:t.title)||(null===e||void 0===e?void 0:e.label),value:(null===e||void 0===e||null===(d=e.product)||void 0===d?void 0:d.id)||(null===e||void 0===e?void 0:e.value)})})),{price:(null===t||void 0===t?void 0:t.price)||0,quantity:(null===t||void 0===t?void 0:t.quantity)||0,sku:null===t||void 0===t?void 0:t.sku,stock_id:null===t||void 0===t?void 0:t.id,tax:(null===p||void 0===p?void 0:p.data.tax)||0,addons:a,...Object.assign({},...l.map(((e,l)=>({[`extras[${l}]`]:{label:e.label,value:e.value}}))))}}return{price:0,quantity:0,sku:null===p||void 0===p||null===(a=p.data)||void 0===a?void 0:a.sku,tax:(null===(d=p.data)||void 0===d?void 0:d.tax)||0,addons:[],...Object.assign({},...l.map(((e,l)=>({[`extras[${l}]`]:{label:e.label,value:e.value}}))))}}));let s=[];if(0===d.length&&0!==(null===(t=e.data.stocks)||void 0===t?void 0:t.length)){var n,o,u;const l=null===(n=e.data.stocks)||void 0===n?void 0:n.at(0),t=[];null===l||void 0===l||null===(o=l.addons)||void 0===o||o.forEach((e=>{var l,a,d;e.product&&t.push({label:(null===e||void 0===e||null===(l=e.product)||void 0===l||null===(a=l.translation)||void 0===a?void 0:a.title)||(null===e||void 0===e?void 0:e.label),value:(null===e||void 0===e||null===(d=e.product)||void 0===d?void 0:d.id)||(null===e||void 0===e?void 0:e.value)})})),s=[{price:(null===l||void 0===l?void 0:l.price)||0,quantity:(null===l||void 0===l?void 0:l.quantity)||0,sku:null===l||void 0===l?void 0:l.sku,tax:(null===(u=p.data)||void 0===u?void 0:u.tax)||0,addons:l?t:[]}]}var r,v;0===d.length&&0===(null===(a=e.data.stocks)||void 0===a?void 0:a.length)&&(s=[{price:void 0,quantity:0,sku:null===p||void 0===p||null===(r=p.data)||void 0===r?void 0:r.sku,tax:(null===(v=p.data)||void 0===v?void 0:v.tax)||0,addons:[]}]);const m=s.concat(i);W(e.data.stocks.map((e=>e.id))),c.setFieldsValue({stocks:m})})).finally((()=>{O(!1)}))}(m)}),[s,null===(l=E.state)||void 0===l?void 0:l.generate]);const G=(e,l,t)=>e.map((e=>Object.assign(e,{[l]:t}))),P=(e,l)=>{const t=e?(0,V.A)(6):l,{stocks:a}=c.getFieldsValue();c.setFieldsValue({"set.all.sku":t,stock:G(a,"sku",t)})};return(0,M.jsx)(i.A,{title:`${n("product.name")}: ${p.data[`title[${R}]`]?`"${p.data[`title[${R}]`]}"`:""}`,loading:!!k,children:(0,M.jsxs)(j.A,{layout:"vertical",form:c,onFinish:e=>{var l,t;const{stocks:a}=e,i=S.filter(((e,l)=>{var t;return!(null===(t=a[l])||void 0===t||!t.stock_id)&&!a.some((l=>(null===l||void 0===l?void 0:l.stock_id)===e))}));let n;const o=!(null===(l=p.data)||void 0===l||null===(t=l.extras)||void 0===t||!t.length);if(n=o?a.map(((e,l)=>{var t,a,d,i;return{price:e.price,quantity:e.quantity,sku:e.sku,ids:s?null===(t=p.data)||void 0===t?void 0:t.extras.map(((l,t)=>e[`extras[${t}]`])):null===(a=p.data)||void 0===a?void 0:a.extras.map(((l,t)=>e[`extras[${t}]`].value)),addons:e.addons?s?null===(d=e.addons)||void 0===d?void 0:d.map((e=>e)):null===(i=e.addons)||void 0===i?void 0:i.map((e=>e.value)):[],stock_id:e.stock_id}})):[{price:a[0].price,quantity:a[0].quantity,addons:a[0].addons?s?a[0].addons.map((e=>e)):a[0].addons.map((e=>e.value)):[],stock_id:a[0].stock_id,sku:a[0].sku,ids:[]}],s)return z((0,r.Ok)({activeMenu:p,data:{...p.data,stocks:n,delete_ids:i}})),void d();h(!0),F.A.stocks(m,{extras:n,delete_ids:i}).then((()=>{z((0,r.Ok)({activeMenu:p,data:{...p.data,stocks:n,delete_ids:i}})),d()})).finally((()=>h(!1)))},children:[(0,M.jsx)(y.A,{}),(0,M.jsx)("h2",{children:n("set.all.values")}),(0,M.jsxs)(A.A,{gutter:12,align:"middle",children:[(0,M.jsx)(g.A,{span:5,style:{marginRight:"10px"},children:(0,M.jsx)(j.A.Item,{label:n("sku"),name:"set.all.sku",children:(0,M.jsx)(f.A,{className:"w-100",onChange:e=>P(!1,e.target.value)})})}),(0,M.jsx)(g.A,{children:(0,M.jsx)(j.A.Item,{label:" ",name:"sku",children:(0,M.jsx)(b.A,{icon:(0,M.jsx)(N.A,{}),onClick:()=>P(!0)})})}),(0,M.jsx)(g.A,{span:4,children:(0,M.jsx)(j.A.Item,{label:n("price"),name:"set.all.price",rules:[{type:"number",min:0,message:n("must.be.positive.number")}],children:(0,M.jsx)(q.A,{className:"w-100",onChange:function(e){const{stocks:l}=c.getFieldsValue();c.setFieldsValue({stocks:G(l,"price",e)})}})})}),(0,M.jsx)(g.A,{span:4,children:(0,M.jsx)(j.A.Item,{label:n("quantity"),name:"set.all.quantity",rules:[{type:"number",min:0,message:n("must.be.positive.number")}],children:(0,M.jsx)(q.A,{className:"w-100",onChange:function(e){const{stocks:l}=c.getFieldsValue();c.setFieldsValue({stocks:G(l,"quantity",e)})}})})}),(0,M.jsx)(g.A,{children:(0,M.jsx)(j.A.Item,{label:n("addons"),name:"addons",children:(0,M.jsx)(I.G,{mode:"multiple",style:{minWidth:"300px"},fetchOptions:L,allowClear:!0,onChange:function(e){const{stocks:l}=c.getFieldsValue();c.setFieldsValue({stocks:G(l,"addons",e)})}})})})]}),(0,M.jsx)(y.A,{}),(0,M.jsx)("h2",{children:n("values")}),(0,M.jsx)(j.A.List,{name:"stocks",children:(e,l)=>{let{add:t,remove:a}=l;return(0,M.jsx)("div",{children:e.map(((e,l)=>{var t,d,i,s;return(0,M.jsxs)(A.A,{gutter:12,align:"middle",style:{flexWrap:"nowrap",overflowX:"auto"},hidden:!(null!==(t=p.data)&&void 0!==t&&null!==(d=t.extras)&&void 0!==d&&d.length)&&e.key,children:[null===(i=p.data)||void 0===i||null===(s=i.extras)||void 0===s?void 0:s.map(((e,t)=>(0,M.jsx)(g.A,{children:(0,M.jsx)(j.A.Item,{label:null===e||void 0===e?void 0:e.label,name:[l,`extras[${t}]`],rules:[{required:!0,message:n("required")}],children:(0,M.jsx)(_.A,{disabled:!0,className:"w-100",style:{minWidth:200}})})},"extra"+e.value))),(0,M.jsx)(g.A,{children:(0,M.jsx)(j.A.Item,{label:n("addons"),name:[l,"addons"],rules:[{required:!1,message:n("required")}],children:(0,M.jsx)(I.G,{mode:"multiple",style:{minWidth:"300px"},fetchOptions:L,allowClear:!0})})}),(0,M.jsx)(g.A,{children:(0,M.jsx)(j.A.Item,{label:n("sku"),name:[l,"sku"],children:(0,M.jsx)(f.A,{className:"w-100",style:{minWidth:200}})})}),(0,M.jsx)(g.A,{children:(0,M.jsx)(j.A.Item,{label:n("quantity"),name:[l,"quantity"],rules:[{required:!0,message:n("required")}],children:(0,M.jsx)(q.A,{min:0,className:"w-100",style:{minWidth:200}})})}),(0,M.jsxs)(g.A,{children:[(0,M.jsx)(j.A.Item,{label:`${n("price")} (${null===B||void 0===B?void 0:B.symbol})`,name:[l,"price"],rules:[{required:!0,message:n("requried")}],children:(0,M.jsx)(q.A,{min:0,className:"w-100",style:{minWidth:200}})}),(0,M.jsx)(j.A.Item,{hidden:!0,label:n("id"),name:[l,"stock_id"],children:(0,M.jsx)(q.A,{min:1,className:"w-100",disabled:!0,style:{minWidth:200},addonAfter:"%"})})]}),(0,M.jsx)(g.A,{children:(0,M.jsx)(j.A.Item,{label:n("tax"),name:[l,"tax"],children:(0,M.jsx)(q.A,{className:"w-100",disabled:!0,style:{minWidth:200},addonAfter:"%"})})}),(0,M.jsx)(g.A,{children:(0,M.jsx)(j.A.Item,{noStyle:!0,shouldUpdate:(l,t)=>{var a,d;return(null===(a=l.stocks[e.name])||void 0===a?void 0:a.price)!==(null===(d=t.stocks[e.name])||void 0===d?void 0:d.price)},children:l=>{let{getFieldValue:t}=l;const a=t(["stocks",e.name,"tax"])||0,d=t(["stocks",e.name,"price"]),i=0===a?d:d*a/100+d;return(0,M.jsx)(j.A.Item,{label:`${n("total.price")} (${null===B||void 0===B?void 0:B.symbol})`,children:(0,M.jsx)(q.A,{min:1,disabled:!0,value:i,className:"w-100",style:{minWidth:200}})})}})}),(0,M.jsx)(g.A,{children:e.key?(0,M.jsx)(b.A,{type:"primary",className:"mt-2",danger:!0,icon:(0,M.jsx)(C.A,{}),onClick:()=>{a(e.name)}}):""})]},e.key)}))})}}),(0,M.jsxs)(w.A,{className:"mt-4",children:[(0,M.jsx)(b.A,{onClick:t,children:n("prev")}),(0,M.jsx)(b.A,{type:"primary",htmlType:"submit",loading:!!x,children:n("next")})]})]})})};var S=t(59585);const{Step:W}=d.A,z=()=>{var e;const{t:l}=(0,v.B)(),{id:t}=(0,o.g)(),j=(0,c.s)(),{activeMenu:y}=(0,u.d4)((e=>e.menu),u.bN),A=(0,u.wA)(),g=Number((null===(e=j.values)||void 0===e?void 0:e.step)||0),[f,b]=(0,a.useState)(y.refetch),q=()=>{const e=g+1;j.set("step",e)},_=()=>{const e=g-1;j.set("step",e)};(0,a.useEffect)((()=>{var e;y.refetch&&(e=t,b(!0),m.A.getById(e).then((e=>{var l;let t=e.data.data;A((0,r.Ok)({activeMenu:y,data:{...t,request_id:e.data.id,actualStocks:null===(l=e.data.model)||void 0===l?void 0:l.stocks,model_id:e.data.model_id,model:e.data.model}}))})).finally((()=>{b(!1),A((0,r.km)(y))})))}),[y.refetch,t]);return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(i.A,{title:l("edit.food"),extra:(0,M.jsx)(n.A,{}),children:(0,M.jsx)(d.A,{current:g,onChange:e=>{A((0,r.Ok)({activeMenu:y,data:{...y.data,step:e}})),j.set("step",e)},children:p.C.map((e=>(0,M.jsx)(W,{title:l(e.title)},e.title)))})}),f?(0,M.jsx)("div",{className:"d-flex justify-content-center align-items-center",children:(0,M.jsx)(s.A,{size:"large",className:"py-5"})}):(0,M.jsxs)("div",{children:["First-content"===p.C[g].content&&(0,M.jsx)(x.A,{isRequest:!0,next:q,action_type:"edit"}),"Second-content"===p.C[g].content&&(0,M.jsx)(S.A,{isRequest:!0,next:q,prev:_}),"Third-content"===p.C[g].content&&(0,M.jsx)(O,{isRequest:!0,next:q,prev:_}),"Fourth-content"===p.C[g].content&&(0,M.jsx)(h.A,{isRequest:!0,next:q,prev:_}),"Finish-content"===p.C[g].content&&(0,M.jsx)(k.A,{isRequest:!0,prev:_})]})]})}}}]);