"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[7764],{89281:(e,t,s)=>{s.d(t,{h:()=>u});var a=s(47313),n=s(12279),l=s.n(n),r=s(74294),i=s(72652),d=s(46417);const u=e=>{let{fetchOptions:t,debounceTimeout:s=400,onClear:n,...u}=e;const[o,c]=(0,a.useState)(!1),[m,h]=(0,a.useState)([]),v=(0,a.useMemo)((()=>l()((e=>{h([]),c(!0),t(e).then((e=>{h(e),c(!1)}))}),s)),[t,s]);return(0,d.jsx)(r.Z,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:v,onClear:()=>{v(""),n&&n()},notFoundContent:o?(0,d.jsx)(i.Z,{size:"small"}):"no results",...u,options:m,onFocus:()=>{v("")}})}},57764:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Y});var a=s(47313),n=s(97890),l=s(23560),r=s(10976),i=s(77181),d=s(70816),u=s.n(d),o=s(2717),c=s(90954),m=s(57409),h=s(69660),v=s(24511),p=s(8550),f=s(51282),x=s(4191),Z=s(46417);function Y(){const{t:e}=(0,v.$)(),{activeMenu:t}=(0,o.v9)((e=>e.menu),o.wU),s=(0,o.I0)(),{id:d}=(0,n.UO)(),[Y]=r.Z.useForm(),j=(0,n.s0)(),[g,b]=(0,a.useState)(!1);(0,a.useEffect)((()=>()=>{const e=Y.getFieldsValue(!0),a=JSON.stringify(e.start),n=JSON.stringify(e.end),l={...e,start:a,end:n};s((0,c.nc)({activeMenu:t,data:l}))}),[]),(0,a.useEffect)((()=>{t.refetch&&(b(!0),m.Z.getById(d).then((e=>{let{data:a}=e;const n={price:null===a||void 0===a?void 0:a.price,type:null===a||void 0===a?void 0:a.type,products:null===a||void 0===a?void 0:a.products.map((e=>{var t;return{label:null===e||void 0===e||null===(t=e.translation)||void 0===t?void 0:t.title,value:null===e||void 0===e?void 0:e.id}})),start:u()(null===a||void 0===a?void 0:a.start,"YYYY-MM-DD"),end:u()(null===a||void 0===a?void 0:a.end,"YYYY-MM-DD"),image:[(0,p.Z)(null===a||void 0===a?void 0:a.img)]};Y.setFieldsValue(n),s((0,c.nc)({activeMenu:t,data:{...n,start:null===a||void 0===a?void 0:a.start,end:null===a||void 0===a?void 0:a.end}}))})).finally((()=>{b(!1),s((0,c.A_)(t))})))}),[t.refetch]);return(0,Z.jsx)(i.Z,{title:e("edit.discount"),className:"h-100",children:g?(0,Z.jsx)(f.Z,{}):(0,Z.jsx)(x.Z,{form:Y,handleSubmit:(a,n)=>{var r;if(u()(a.start).format("YYYY-MM-DD")>u()(a.end).format("YYYY-MM-DD"))return l.Am.error(e("start.date.must.be.before.end.date"));const i={price:a.price,type:a.type,products:a.products.map((e=>e.value)),start:a.start?u()(a.start).format("YYYY-MM-DD"):void 0,end:a.end?u()(a.end).format("YYYY-MM-DD"):void 0,images:[null===(r=n[0])||void 0===r?void 0:r.name]},v="seller/discounts";return m.Z.update(d,i).then((()=>{l.Am.success(e("successfully.updated")),(0,o.dC)((()=>{s((0,c.ph)({...t,nextUrl:v})),s((0,h.k)({}))})),j(`/${v}`)}))}})})}},4191:(e,t,s)=>{s.d(t,{Z:()=>Y});var a=s(47313),n=s(10976),l=s(68197),r=s(59624),i=s(74294),d=s(16124),u=s(99096),o=s(59491),c=s(70816),m=s.n(c),h=s(89281),v=s(75868),p=s(24511),f=s(2717),x=s(18333),Z=s(46417);function Y(e){var t,s;let{form:c,handleSubmit:Y}=e;const{t:j}=(0,p.$)(),{activeMenu:g}=(0,f.v9)((e=>e.menu),f.wU),{myShop:b}=(0,f.v9)((e=>e.myShop),f.wU),[y,M]=(0,a.useState)(!1),[D,S]=(0,a.useState)(null!==(t=g.data)&&void 0!==t&&t.image?null===(s=g.data)||void 0===s?void 0:s.image:[]);return(0,Z.jsxs)(n.Z,{name:"discount-form",layout:"vertical",onFinish:e=>{M(!0),Y(e,D).finally((()=>M(!1)))},form:c,initialValues:{...(()=>{var e;const t=g.data;if(null===(e=g.data)||void 0===e||!e.start)return t;const s=g.data.start,a=g.data.end;return{...t,start:m()(s,"YYYY-MM-DD"),end:m()(a,"YYYY-MM-DD")}})()},className:"d-flex flex-column h-100",children:[(0,Z.jsxs)(l.Z,{gutter:12,children:[(0,Z.jsx)(r.Z,{span:12,children:(0,Z.jsx)(n.Z.Item,{label:j("type"),name:"type",rules:[{required:!0,message:j("required")}],children:(0,Z.jsxs)(i.Z,{children:[(0,Z.jsx)(i.Z.Option,{value:"fix",children:j("fix")}),(0,Z.jsx)(i.Z.Option,{value:"percent",children:j("percent")})]})})}),(0,Z.jsx)(r.Z,{span:12,children:(0,Z.jsx)(n.Z.Item,{label:j("price"),name:"price",rules:[{required:!0,message:j("required")}],children:(0,Z.jsx)(d.Z,{min:0,className:"w-100"})})}),(0,Z.jsx)(r.Z,{span:12,children:(0,Z.jsx)(n.Z.Item,{label:j("start.date"),name:"start",rules:[{required:!0,message:j("required")}],children:(0,Z.jsx)(u.Z,{className:"w-100",placeholder:"",disabledDate:e=>m()().add(-1,"days")>=e})})}),(0,Z.jsx)(r.Z,{span:12,children:(0,Z.jsx)(n.Z.Item,{label:j("end.date"),name:"end",rules:[{required:!0,message:j("required")}],children:(0,Z.jsx)(u.Z,{className:"w-100",placeholder:"",disabledDate:e=>m()().add(-1,"days")>=e})})}),(0,Z.jsx)(r.Z,{span:24,children:(0,Z.jsx)(n.Z.Item,{label:j("products"),name:"products",rules:[{required:!0,message:j("required")}],children:(0,Z.jsx)(h.h,{fetchOptions:async function(e){const t={search:e,shop_id:b.id,status:"published",active:1,rest:1};return x.Z.getAll(t).then((e=>{let{data:t}=e;return t.map((e=>{var t;return{label:null===(t=e.translation)||void 0===t?void 0:t.title,value:e.id}}))}))},mode:"multiple"})})}),(0,Z.jsx)(r.Z,{span:24,children:(0,Z.jsx)(n.Z.Item,{label:j("image"),name:"images",rules:[{required:!D.length,message:j("required")}],children:(0,Z.jsx)(v.Z,{type:"discounts",imageList:D,setImageList:S,form:c,multiple:!1,name:"image"})})})]}),(0,Z.jsx)("div",{className:"flex-grow-1 d-flex flex-column justify-content-end",children:(0,Z.jsx)("div",{className:"pb-5",children:(0,Z.jsx)(o.Z,{type:"primary",htmlType:"submit",loading:y,children:j("submit")})})})]})}}}]);