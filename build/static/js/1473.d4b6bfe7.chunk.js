"use strict";(self.webpackChunkjumlajumla_dashboard=self.webpackChunkjumlajumla_dashboard||[]).push([[1473],{8168:(e,l,n)=>{function a(e){switch(e){case"ascend":return"asc";case"descend":return"desc"}}n.d(l,{A:()=>a})},8297:(e,l,n)=>{n.d(l,{A:()=>o});var a=n(9950),s=n(55902),t=n(41397),d=n(60767),i=n(44414);function o(e){let{handleChange:l,defaultValue:n,resetSearch:o,...r}=e;const[c,u]=(0,a.useState)(n),h=(0,a.useMemo)((()=>(0,t.debounce)((e=>{l(e)}),800)),[l]);return(0,a.useEffect)((()=>{u(n)}),[o,n]),(0,i.jsx)(s.A,{value:c,onChange:e=>{u(e.target.value),h(e.target.value)},prefix:(0,i.jsx)(d.A,{}),...r})}},12970:(e,l,n)=>{function a(e){var l,n;let a=null===e||void 0===e?void 0:e.slice(0,1),s=null===e||void 0===e?void 0:e.lastIndexOf("@"),t=null===e||void 0===e?void 0:e.slice(1,s-1);t=null===(l=t)||void 0===l?void 0:l.replace(/./g,"*");let d=null===e||void 0===e?void 0:e.slice(s-1,e.length);return null===a||void 0===a||null===(n=a.concat(t))||void 0===n?void 0:n.concat(d)}n.d(l,{A:()=>a})},21777:(e,l,n)=>{n.d(l,{A:()=>o});n(9950);var a=n(32645),s=n(32312),t=n(48538),d=n(70030),i=n(44414);const o=e=>{let{open:l,handleCancel:n,text:o,click:r,loading:c,subTitle:u}=e;const{t:h}=(0,d.B)();return(0,i.jsxs)(a.A,{closable:!1,visible:l,footer:null,centered:!0,children:[(0,i.jsx)(s.Ay,{status:"warning",title:o,subTitle:u}),(0,i.jsxs)("div",{className:"d-flex justify-content-end",children:[(0,i.jsx)(t.A,{type:"primary",className:"mr-2",onClick:r,loading:c,children:h("yes")}),(0,i.jsx)(t.A,{onClick:()=>n(),children:h("no")})]})]})}},28645:(e,l,n)=>{n.d(l,{A:()=>A});var a=n(9950),s=n(66362),t=n(69216),d=n(80737),i=n(25933),o=n(57811),r=n(81541),c=n(48538),u=n(89323),h=n(70030),v=n(44414);const{Text:m}=s.A,A=e=>{let{columns:l=[],setColumns:n,style:s,size:A="",iconOnly:x}=e;const{t:p}=(0,h.B)(),[j,f]=(0,a.useState)(!1),g=(0,v.jsx)(t.A,{children:null===l||void 0===l?void 0:l.map(((e,a)=>(0,v.jsx)(t.A.Item,{children:(0,v.jsxs)(d.A,{className:"d-flex justify-content-between",children:[(0,v.jsx)(m,{children:e.title}),(0,v.jsx)(i.A,{defaultChecked:!0,onClick:()=>function(e){const a=null===l||void 0===l?void 0:l.map((l=>(l.dataIndex===e.dataIndex&&(l.is_show=!(null!==l&&void 0!==l&&l.is_show)),l)));n(a)}(e),disabled:1===a})]})},e+a)))});return(0,v.jsx)(o.A,{overlay:g,trigger:["click"],onVisibleChange:e=>{f(e)},visible:j,children:(0,v.jsx)(r.A,{title:p("change.columns"),children:(0,v.jsx)(c.A,{style:{...s},size:A,icon:(0,v.jsx)(u.A,{}),children:x?null:p("Columns")})})})}},29190:(e,l,n)=>{n.d(l,{A:()=>o});var a=n(89379),s=n(9950);const t={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M342 88H120c-17.7 0-32 14.3-32 32v224c0 8.8 7.2 16 16 16h48c8.8 0 16-7.2 16-16V168h174c8.8 0 16-7.2 16-16v-48c0-8.8-7.2-16-16-16zm578 576h-48c-8.8 0-16 7.2-16 16v176H682c-8.8 0-16 7.2-16 16v48c0 8.8 7.2 16 16 16h222c17.7 0 32-14.3 32-32V680c0-8.8-7.2-16-16-16zM342 856H168V680c0-8.8-7.2-16-16-16h-48c-8.8 0-16 7.2-16 16v224c0 17.7 14.3 32 32 32h222c8.8 0 16-7.2 16-16v-48c0-8.8-7.2-16-16-16zM904 88H682c-8.8 0-16 7.2-16 16v48c0 8.8 7.2 16 16 16h174v176c0 8.8 7.2 16 16 16h48c8.8 0 16-7.2 16-16V120c0-17.7-14.3-32-32-32z"}}]},name:"expand",theme:"outlined"};var d=n(25085),i=function(e,l){return s.createElement(d.A,(0,a.A)((0,a.A)({},e),{},{ref:l,icon:t}))};i.displayName="ExpandOutlined";const o=s.forwardRef(i)},35116:(e,l,n)=>{n.d(l,{A:()=>r});n(9950);var a=n(48538),s=n(44070),t=n(12449),d=n(70030),i=n(13311),o=n(44414);function r(e){let{size:l="",onClick:n,type:r="default",...c}=e;const{t:u}=(0,d.B)(),{isDemo:h}=(0,i.A)();return(0,o.jsx)(a.A,{size:l,icon:(0,o.jsx)(s.A,{}),onClick:e=>{h?t.oR.warning(u("cannot.work.demo")):n(e)},type:r,...c})}},47992:(e,l,n)=>{n.d(l,{G:()=>r});var a=n(9950),s=n(95491),t=n.n(s),d=n(99674),i=n(90650),o=n(44414);const r=e=>{let{fetchOptions:l,debounceTimeout:n=400,onClear:s,...r}=e;const[c,u]=(0,a.useState)(!1),[h,v]=(0,a.useState)([]),m=(0,a.useMemo)((()=>t()((e=>{v([]),u(!0),l(e).then((e=>{v(e),u(!1)}))}),n)),[l,n]);return(0,o.jsx)(d.A,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:m,onClear:()=>{m(""),s&&s()},notFoundContent:c?(0,o.jsx)(i.A,{size:"small"}):"no results",...r,options:h,onFocus:()=>{m("")}})}},51473:(e,l,n)=>{n.r(l),n.d(l,{default:()=>E});var a=n(9950),s=n(29190),t=n(12678),d=n(24513),i=n(67376),o=n(44070),r=n(53387),c=n(54909),u=n(80737),h=n(48538),v=n(23263),m=n(12203),A=n(13564),x=n(91854),p=n(39539),j=n(8168),f=n(74623),g=n(88986),b=n(69398),y=n(70030),C=n(54318),w=n(8297),k=n(28645),I=n(35116),_=n(55386),S=n(12449),z=n(64272),V=n(76083),N=n(21777),$=n(22875),H=n(53271),M=n(13311),O=n(12970),R=n(44414);const{TabPane:B}=c.A,T=["admin","seller","moderator","manager","cook","deliveryman","waiter","deleted_at"];function E(){var e,l,n,E,U,F,P;const{t:D}=(0,y.B)(),q=(0,x.wA)(),X=(0,A.Zp)(),[K,G]=(0,a.useState)(null),[Q,Z]=(0,a.useState)(null),{setIsModalVisible:J}=(0,a.useContext)(_.o),[L,W]=(0,a.useState)(!1),{activeMenu:Y}=(0,x.d4)((e=>e.menu),x.bN),{users:ee,loading:le,meta:ne,params:ae}=(0,x.d4)((e=>e.user),x.bN),[se,te]=(0,a.useState)(null),[de,ie]=(0,a.useState)(null),[oe,re]=(0,a.useState)("admin"),[ce,ue]=(0,a.useState)(null),he=(null===(e=Y.data)||void 0===e?void 0:e.role)||oe,{user:ve}=(0,x.d4)((e=>e.auth),x.bN),{isDemo:me,demoDeliveryman:Ae,demoSeller:xe,demoAdmin:pe,demoModerator:je,demoMeneger:fe}=(0,M.A)(),ge=Y.data,be="deleted_at"===he?{deleted_at:1,role:null}:{role:he},ye={sort:null===ge||void 0===ge?void 0:ge.sort,column:null===ge||void 0===ge?void 0:ge.column,...be,perPage:null===ge||void 0===ge?void 0:ge.perPage,page:null===ge||void 0===ge?void 0:ge.page,search:null===ge||void 0===ge?void 0:ge.search},[Ce,we]=(0,a.useState)([{title:D("id"),dataIndex:"id",sorter:!0,is_show:!0},{title:D("firstname"),dataIndex:"firstname",is_show:!0},{title:D("lastname"),dataIndex:"lastname",is_show:!0},{title:D("email"),dataIndex:"email",is_show:!0,render:e=>(0,R.jsx)("div",{children:me?(0,O.A)(e):e})},{title:D("role"),dataIndex:"role",is_show:!0},{title:D("options"),dataIndex:"options",is_show:!0,render:(e,l)=>(0,R.jsxs)(u.A,{children:[(0,R.jsx)(h.A,{icon:(0,R.jsx)(s.A,{}),onClick:()=>te(l.uuid),disabled:null===l||void 0===l?void 0:l.deleted_at}),"manager"===ve.role&&"admin"===l.role?void 0:(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(h.A,{icon:(0,R.jsx)(t.A,{}),onClick:()=>(e=>{q((0,f.X4)({url:`/users/user/${e.uuid}`,id:"user_info",name:D("user.info")})),X(`/users/user/${e.uuid}`,{state:{user_id:e.id}})})(l),disabled:null===l||void 0===l?void 0:l.deleted_at}),(0,R.jsx)(h.A,{type:"primary",icon:(0,R.jsx)(d.A,{}),onClick:()=>(e=>{q((0,f.X4)({url:`user/${e.uuid}`,id:"user_edit",name:"User edit"})),X(`/user/${e.uuid}`)})(l),disabled:me&&(null===l||void 0===l?void 0:l.id)==Ae||me&&(null===l||void 0===l?void 0:l.id)==je||me&&(null===l||void 0===l?void 0:l.id)==fe||me&&(null===l||void 0===l?void 0:l.id)==xe||me&&(null===l||void 0===l?void 0:l.id)==pe||(null===l||void 0===l?void 0:l.deleted_at)})]}),"admin"!==(null===l||void 0===l?void 0:l.role)&&(0,R.jsxs)(u.A,{children:[(0,R.jsx)(h.A,{icon:(0,R.jsx)(i.A,{}),onClick:()=>(e=>{q((0,f.X4)({url:`user-clone/${e.uuid}`,id:"user-clone",name:"user.clone"})),X(`/user-clone/${e.uuid}`)})(l),disabled:null===l||void 0===l?void 0:l.deleted_at}),(0,R.jsx)(I.A,{icon:(0,R.jsx)(o.A,{}),onClick:()=>{G([l.id]),J(!0),Z(!0)},disabled:null===l||void 0===l?void 0:l.deleted_at})]})]})}]);(0,a.useEffect)((()=>{Y.refetch&&(q((0,p.hU)(ye)),q((0,f.km)(Y)))}),[Y.refetch]),(0,g.A)((()=>{q((0,p.hU)(ye))}),[Y.data]);const ke=e=>{const l=Y.data;q((0,f.Ok)({activeMenu:Y,data:{...l,...e}}))},Ie={selectedRowKeys:K,onChange:e=>{G(e)}};return(0,R.jsxs)(v.A,{title:D("users"),extra:(0,R.jsxs)(u.A,{wrap:!0,children:["deleted_at"!==(null===(l=Y.data)||void 0===l?void 0:l.role)?(0,R.jsxs)(u.A,{children:[(0,R.jsx)(I.A,{size:"",onClick:()=>{null===K||0===K.length?S.oR.warning(D("select.the.product")):(J(!0),Z(!1))},children:D("delete.selected")}),(0,R.jsx)(I.A,{onClick:()=>ue({delete:!0}),children:D("delete.all")})]}):(0,R.jsx)(I.A,{icon:(0,R.jsx)($.DQ9,{className:"mr-2"}),onClick:()=>ue({restore:!0}),children:D("restore.all")}),(0,R.jsx)(k.A,{columns:Ce,setColumns:we})]}),children:[(0,R.jsx)("div",{className:"d-flex justify-content-between mb-3",children:(0,R.jsx)(w.A,{placeholder:D("search"),className:"w-25",handleChange:e=>{ke({search:e})},defaultValue:null===(n=Y.data)||void 0===n?void 0:n.search,resetSearch:!(null!==(E=Y.data)&&void 0!==E&&E.search)})}),(0,R.jsx)(c.A,{scroll:{x:!0},activeKey:he,onChange:e=>{ke({role:e,page:1}),re(e)},type:"card",children:T.map((e=>(0,R.jsx)(B,{tab:D(e)},e)))}),"admin"!=he&&"seller"!=he&&"deleted_at"!=he?(0,R.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,R.jsx)(h.A,{type:"primary",icon:(0,R.jsx)(r.A,{}),onClick:()=>{return e=he,q((0,f.X4)({id:"user-add-role",url:`user/add/${e}`,name:D(`add.${e}`)})),void X(`/user/add/${e}`);var e},className:"mr-2",children:D(`add.${he}`)})}):null,(0,R.jsx)(m.A,{scroll:{x:!0},rowSelection:Ie,columns:null===Ce||void 0===Ce?void 0:Ce.filter((e=>e.is_show)),dataSource:ee,loading:le,pagination:{pageSize:ae.perPage,page:(null===(U=Y.data)||void 0===U?void 0:U.page)||1,total:ne.total,defaultCurrent:null===(F=Y.data)||void 0===F?void 0:F.page,current:null===(P=Y.data)||void 0===P?void 0:P.page},rowKey:e=>e.id,onChange:function(e,l,n){const{pageSize:a,current:s}=e,{field:t,order:d}=n,i=(0,j.A)(d);q((0,f.Ok)({activeMenu:Y,data:{...Y.data,perPage:a,page:s,column:t,sort:i}}))}}),(0,R.jsx)(V.A,{click:()=>{W(!0);const e={...Object.assign({},...K.map(((e,l)=>({[`ids[${l}]`]:e}))))};z.A.delete(e).then((()=>{S.oR.success(D("successfully.deleted")),q((0,p.hU)(ye)),J(!1),Z([])})).finally((()=>{G(null),W(!1)}))},text:D(Q?"delete":"all.delete"),loading:L,setText:G}),se&&(0,R.jsx)(b.A,{uuid:se,handleCancel:()=>te(null)}),de&&(0,R.jsx)(C.A,{data:de,handleCancel:()=>ie(null)}),ce&&(0,R.jsx)(N.A,{open:ce,handleCancel:()=>ue(null),click:ce.restore?()=>{W(!0),H.A.restoreAll().then((()=>{S.oR.success(D("successfully.restored")),q((0,p.hU)(ye)),ue(null)})).finally((()=>W(!1)))}:()=>{W(!0),H.A.dropAll().then((()=>{S.oR.success(D("successfully.deleted")),q((0,p.hU)()),ue(null)})).finally((()=>W(!1)))},text:ce.restore?D("restore.modal.text"):D("read.carefully"),subTitle:ce.restore?"":D("confirm.deletion"),loading:L,setText:Z})]})}},53387:(e,l,n)=>{n.d(l,{A:()=>o});var a=n(89379),s=n(9950);const t={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"plus-circle",theme:"outlined"};var d=n(25085),i=function(e,l){return s.createElement(d.A,(0,a.A)((0,a.A)({},e),{},{ref:l,icon:t}))};i.displayName="PlusCircleOutlined";const o=s.forwardRef(i)},53774:(e,l,n)=>{n.d(l,{A:()=>s});var a=n(83291);function s(){var e,l;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=arguments.length>1?arguments[1]:void 0,t=arguments.length>2?arguments[2]:void 0;const d=null===(e=a.M.getState())||void 0===e||null===(l=e.currency)||void 0===l?void 0:l.defaultCurrency,i=Number(n).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,"),o=s||(null===d||void 0===d?void 0:d.symbol)||"$";return"after"===(t||(null===d||void 0===d?void 0:d.position)||"before")?`${i} ${o}`:`${o} ${i}`}},54318:(e,l,n)=>{n.d(l,{A:()=>p});var a=n(9950),s=n(3969),t=n(32645),d=n(48538),i=n(99674),o=n(53271),r=n(91854),c=n(39539),u=n(12449),h=n(70030),v=n(3855),m=n(47992),A=n(58547),x=n(44414);function p(e){let{data:l,handleCancel:n}=e;const{t:p}=(0,h.B)(),[j]=s.A.useForm(),f=(0,r.wA)(),[g,b]=(0,a.useState)(!1),[y,C]=(0,a.useState)(l.role),{user:w}=(0,r.d4)((e=>e.auth),r.bN),k=[{label:p("user"),value:"user",key:1},{label:p("manager"),value:"manager",key:2},{label:p("moderator"),value:"moderator",key:3}],I=[{label:p("user"),value:"user",key:4},{label:p("moderator"),value:"moderator",key:5}];return(0,x.jsx)(t.A,{visible:!!l,title:p("change.user.role"),onCancel:n,footer:[(0,x.jsx)(d.A,{type:"primary",onClick:()=>j.submit(),loading:g,children:p("save")}),(0,x.jsx)(d.A,{type:"default",onClick:n,children:p("cancel")})],children:(0,x.jsxs)(s.A,{layout:"vertical",name:"user-role",form:j,onFinish:e=>{!function(e,a){b(!0),o.A.updateRole(e,{role:a}).then((()=>{u.oR.success(p("successfully.updated")),"user"===l.role?f((0,v.$3)()):f((0,c.hU)({role:l.role})),n()})).finally((()=>b(!1)))}(l.uuid,e.role)},initialValues:l,children:[(0,x.jsx)(s.A.Item,{name:"role",label:p("role"),rules:[{required:!0,message:p("required")}],children:(0,x.jsx)(i.A,{className:"w-100",options:"manager"===w.role?I:k,onChange:e=>C(e)})}),"manager"!==y&&"user"!==y?(0,x.jsx)(s.A.Item,{label:p("shop"),name:"shop_id",rules:[{required:!0,message:p("required")}],children:(0,x.jsx)(m.G,{className:"w-100",placeholder:p("select.shop"),fetchOptions:async function(e){const l={search:e,status:"approved"};return A.A.search(l).then((e=>e.data.map((e=>({label:null!==e.translation?e.translation.title:"no name",value:e.id})))))},allowClear:!1})}):void 0]})})}},69398:(e,l,n)=>{n.d(l,{A:()=>f});var a=n(9950),s=n(32645),t=n(48538),d=n(87094),i=n(41988),o=n(91524),r=n(20978),c=n(53271),u=n(69554),h=n(70030),v=n(81446),m=n(91854),A=n(53774),x=n(13311),p=n(12970),j=n(44414);function f(e){var l,n,f;let{uuid:g,handleCancel:b}=e;const[y,C]=(0,a.useState)({}),[w,k]=(0,a.useState)(!1),{t:I}=(0,h.B)(),{defaultCurrency:_}=(0,m.d4)((e=>e.currency),m.bN),{isDemo:S}=(0,x.A)();return(0,a.useEffect)((()=>{!function(e){k(!0),c.A.getById(e).then((e=>C(e.data))).finally((()=>k(!1)))}(g)}),[g]),(0,j.jsx)(s.A,{visible:!!g,title:I("user"),onCancel:b,footer:[(0,j.jsx)(t.A,{type:"default",onClick:b,children:I("cancel")},"cancel")],className:y.shop?"large-modal":"",children:w?(0,j.jsx)(v.A,{}):(0,j.jsxs)(d.A,{gutter:24,children:[(0,j.jsx)(i.A,{span:y.shop?12:24,children:(0,j.jsxs)(o.A,{bordered:!0,children:[(0,j.jsx)(o.A.Item,{span:3,label:I("avatar"),children:(0,j.jsx)(r.A,{src:(0,u.A)(y.img),alt:y.firstname,width:80,className:"rounded"})}),(0,j.jsx)(o.A.Item,{span:3,label:I("user.id"),children:y.id}),(0,j.jsxs)(o.A.Item,{span:3,label:I("name"),children:[y.firstname," ",y.lastname||""]}),(0,j.jsx)(o.A.Item,{span:3,label:I("gender"),children:y.gender}),(0,j.jsx)(o.A.Item,{span:3,label:I("birthday"),children:y.birthday}),(0,j.jsx)(o.A.Item,{span:3,label:I("email"),children:S?(0,p.A)(null===y||void 0===y?void 0:y.email):null===y||void 0===y?void 0:y.email}),(0,j.jsx)(o.A.Item,{span:3,label:I("phone"),children:S?"":y.phone}),(0,j.jsx)(o.A.Item,{span:3,label:I("role"),children:y.role}),(0,j.jsx)(o.A.Item,{span:3,label:I("wallet"),children:(0,A.A)(null===(l=y.wallet)||void 0===l?void 0:l.price,null===_||void 0===_?void 0:_.symbol)})]})}),y.shop?(0,j.jsx)(i.A,{span:12,children:(0,j.jsxs)(o.A,{bordered:!0,children:[(0,j.jsx)(o.A.Item,{span:3,label:I("shop.id"),children:y.shop.id}),(0,j.jsx)(o.A.Item,{span:3,label:I("shop.name"),children:null===(n=y.shop.translation)||void 0===n?void 0:n.title}),(0,j.jsx)(o.A.Item,{span:3,label:I("shop.logo"),children:(0,j.jsx)("img",{src:(0,u.A)(y.shop.logo_img),alt:null===(f=y.shop.translation)||void 0===f?void 0:f.title,width:100,className:"rounded"})}),(0,j.jsx)(o.A.Item,{span:3,label:I("shop.phone"),children:y.shop.phone}),(0,j.jsxs)(o.A.Item,{span:3,label:I("shop.open_close.time"),children:[y.shop.open_time," - ",y.shop.close_time]}),(0,j.jsx)(o.A.Item,{span:3,label:I("delivery.range"),children:y.shop.delivery_range})]})}):""]})})}},89323:(e,l,n)=>{n.d(l,{A:()=>o});var a=n(89379),s=n(9950);const t={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 208H676V232h212v136zm0 224H676V432h212v160zM412 432h200v160H412V432zm200-64H412V232h200v136zm-476 64h212v160H136V432zm0-200h212v136H136V232zm0 424h212v136H136V656zm276 0h200v136H412V656zm476 136H676V656h212v136z"}}]},name:"table",theme:"outlined"};var d=n(25085),i=function(e,l){return s.createElement(d.A,(0,a.A)((0,a.A)({},e),{},{ref:l,icon:t}))};i.displayName="TableOutlined";const o=s.forwardRef(i)}}]);