"use strict";(self.webpackChunkjumlajumla_dashboard=self.webpackChunkjumlajumla_dashboard||[]).push([[5019],{6566:(e,r,l)=>{l.d(r,{A:()=>i});var s=l(83291),a=l(63620);const i=()=>{var e,r;const{google_map_key:l}=null===(e=s.M.getState())||void 0===e||null===(r=e.globalSettings)||void 0===r?void 0:r.settings;return l||a.CJ}},29597:(e,r,l)=>{l.d(r,{A:()=>s});l(63620);function s(e){if(null===e||void 0===e||!e.location)return{lat:47.4143302506288,lng:8.532059477976883};const r=e.location.split(", ");return{lat:Number(null===r||void 0===r?void 0:r[0]),lng:Number(null===r||void 0===r?void 0:r[1])}}},41336:(e,r,l)=>{l.r(r),l.d(r,{default:()=>F});var s=l(9950),a=l(3969),i=l(23263),n=l(87094),o=l(41988),t=l(55902),d=l(8724),m=l(87864),c=l(99674),u=l(40895),v=l(48538),h=l(13564),p=l(12449),j=l(91854),g=l(74623),A=l(53271),x=l(70030),b=l(59051),w=l.n(b),f=l(16254),y=l(47992),P=l(58547),q=l(39539),_=l(64272),E=l(29597),k=l(25933),I=l(78498),N=l(44414);const S=[{label:"Benzine",value:"benzine"},{label:"Diesel",value:"diesel"},{label:"Gas",value:"gas"},{label:"Motorbike",value:"motorbike"},{label:"Bike",value:"bike"},{label:"Foot",value:"foot"},{label:"Electric",value:"electric"}],C=e=>{let{location:r,setLocation:l,form:s,image:i,setImage:m}=e;const{t:u}=(0,x.B)();return(0,N.jsxs)(n.A,{gutter:12,children:[(0,N.jsx)(o.A,{span:12,children:(0,N.jsx)(a.A.Item,{label:u("brand"),name:"brand",rules:[{validator:(e,r)=>r?r&&""===(null===r||void 0===r?void 0:r.trim())?Promise.reject(new Error(u("no.empty.space"))):r&&(null===r||void 0===r?void 0:r.trim().length)<2?Promise.reject(new Error(u("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(u("required")))}],children:(0,N.jsx)(t.A,{})})}),(0,N.jsx)(o.A,{span:12,children:(0,N.jsx)(a.A.Item,{label:u("model"),name:"model",rules:[{validator:(e,r)=>r?r&&""===(null===r||void 0===r?void 0:r.trim())?Promise.reject(new Error(u("no.empty.space"))):r&&(null===r||void 0===r?void 0:r.trim().length)<2?Promise.reject(new Error(u("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(u("required")))}],children:(0,N.jsx)(t.A,{})})}),(0,N.jsx)(o.A,{span:12,children:(0,N.jsx)(a.A.Item,{label:u("type.of.technique"),name:"type_of_technique",rules:[{required:!0,message:u("required")}],children:(0,N.jsx)(c.A,{options:S})})}),(0,N.jsx)(o.A,{span:12,children:(0,N.jsx)(a.A.Item,{label:u("car.number"),name:"number",rules:[{validator:(e,r)=>r?r&&""===(null===r||void 0===r?void 0:r.trim())?Promise.reject(new Error(u("no.empty.space"))):r&&(null===r||void 0===r?void 0:r.trim().length)<2?Promise.reject(new Error(u("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(u("required")))}],children:(0,N.jsx)(t.A,{})})}),(0,N.jsx)(o.A,{span:12,children:(0,N.jsx)(a.A.Item,{label:u("car.color"),name:"color",rules:[{validator:(e,r)=>r?r&&""===(null===r||void 0===r?void 0:r.trim())?Promise.reject(new Error(u("no.empty.space"))):r&&(null===r||void 0===r?void 0:r.trim().length)<2?Promise.reject(new Error(u("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(u("required")))}],children:(0,N.jsx)(t.A,{})})}),(0,N.jsx)(o.A,{span:12,children:(0,N.jsx)(a.A.Item,{label:u("height"),name:"height",rules:[{validator:(e,r)=>r||0===r?!r||r<1?Promise.reject(new Error(u("min.1"))):Promise.resolve():Promise.reject(new Error(u("required")))}],children:(0,N.jsx)(d.A,{className:"w-100",addonAfter:"sm"})})}),(0,N.jsx)(o.A,{span:12,children:(0,N.jsx)(a.A.Item,{label:u("weight"),name:"kg",rules:[{validator:(e,r)=>r||0===r?!r||r<1?Promise.reject(new Error(u("min.1"))):Promise.resolve():Promise.reject(new Error(u("required")))}],children:(0,N.jsx)(d.A,{className:"w-100",addonAfter:"kg"})})}),(0,N.jsx)(o.A,{span:12,children:(0,N.jsx)(a.A.Item,{label:u("length"),name:"length",rules:[{validator:(e,r)=>r||0===r?!r||r<1?Promise.reject(new Error(u("min.1"))):Promise.resolve():Promise.reject(new Error(u("required")))}],children:(0,N.jsx)(d.A,{className:"w-100",addonAfter:"sm"})})}),(0,N.jsx)(o.A,{span:12,children:(0,N.jsx)(a.A.Item,{label:u("width"),name:"width",rules:[{validator:(e,r)=>r||0===r?!r||r<1?Promise.reject(new Error(u("min.1"))):Promise.resolve():Promise.reject(new Error(u("required")))}],children:(0,N.jsx)(d.A,{className:"w-100",addonAfter:"sm"})})}),(0,N.jsx)(o.A,{span:12,children:(0,N.jsx)(a.A.Item,{label:u("image"),name:"images",rules:[{validator:()=>0===(null===i||void 0===i?void 0:i.length)?Promise.reject(new Error(u("required"))):Promise.resolve()}],children:(0,N.jsx)(f.A,{type:"deliveryman/settings",imageList:i,setImageList:m,form:s,length:"1",multiple:!0})})}),(0,N.jsx)(o.A,{span:6,children:(0,N.jsx)(a.A.Item,{label:u("online"),name:"online",rules:[{required:!0,message:u("required")}],valuePropName:"checked",children:(0,N.jsx)(k.A,{})})}),(0,N.jsx)(o.A,{span:24,children:(0,N.jsx)(a.A.Item,{label:u("map"),name:"location",children:(0,N.jsx)(I.A,{location:r,setLocation:l})})})]})};var L=l(76372);function F(){var e,r;const{t:l}=(0,x.B)(),[b]=a.A.useForm(),[k,I]=(0,s.useState)(),[S,F]=(0,s.useState)(null),[O,z]=(0,s.useState)(!1),M=(0,h.Zp)(),B=(0,j.d4)((e=>e.user),j.bN),{role:G}=(0,h.g)(),{settings:V}=(0,j.d4)((e=>e.globalSettings),j.bN),[J,R]=(0,s.useState)((0,E.A)(V));(0,s.useEffect)((()=>()=>{const e=b.getFieldsValue(!0);e.birthday=JSON.stringify(null===e||void 0===e?void 0:e.birthday),T((0,g.Ok)({activeMenu:K,data:{...K.data,...e}}))}),[]);const $=(0,h.zy)(),K=(0,j.d4)((e=>e.menu.activeMenu)),T=(0,j.wA)(),[U,D]=(0,s.useState)(null!==K&&void 0!==K&&null!==(e=K.data)&&void 0!==e&&e.image?[null===K||void 0===K||null===(r=K.data)||void 0===r?void 0:r.image]:[]),[Z,W]=(0,s.useState)([]);async function H(e){const r={search:e,status:"approved"};return P.A.search(r).then((e=>e.data.map((e=>({label:null!==e.translation?e.translation.title:"no name",value:e.id})))))}return(0,N.jsx)(i.A,{title:l("add.user"),children:(0,N.jsx)(a.A,{form:b,layout:"vertical",initialValues:{online:!0,gender:"male",...(()=>{var e,r;if(null===(e=K.data)||void 0===e||!e.birthday)return{};const l=JSON.parse(null===(r=K.data)||void 0===r?void 0:r.birthday);return{birthday:w()(l)}})()},onFinish:e=>{var r,s;z(!0);const a={firstname:e.firstname,lastname:e.lastname,email:e.user_email,phone:e.phone,birthday:k,gender:e.gender,password_confirmation:e.password_confirmation,password:e.password,images:U[0]?[null===(r=U[0])||void 0===r?void 0:r.name]:void 0,shop_id:null!==e&&void 0!==e&&e.shop_id?void 0!==(null===e||void 0===e?void 0:e.shop_id.length)?null===e||void 0===e||null===(s=e.shop_id)||void 0===s?void 0:s.map((e=>e.value)):[null===e||void 0===e?void 0:e.shop_id.value]:void 0,role:G||void 0,online:Number(e.online),height:e.height,kg:e.kg,length:e.length,price:e.price,price_per_km:e.price_per_km,width:e.width},i=$.pathname.search("/user/delivery/")?"deliveries/list":"users/admin";console.log(i),A.A.create(a).then((r=>{let{data:s}=r;if("deliveryman"===G){const r={color:e.color,number:e.number,type_of_technique:e.type_of_technique,brand:e.brand,model:e.model,user_id:s.id,images:U.map((e=>e.name)),location:{latitude:J.lat,longitude:J.lng},online:Number(e.online),height:e.height,kg:e.kg,length:e.length,price:e.price,price_per_km:e.price_per_km,width:e.width};_.A.create(r).then((()=>{p.oR.success(l("successfully.created")),T((0,g.EK)({...K,nextUrl:i})),M(`/${i}`),T($.pathname.search("/user/delivery/")?(0,L.N)():(0,q.hU)({role:G}))}))}else{const e="users/admin",r={...B.params,role:s.role};T((0,g.EK)({...K,menu:e})),M(`/${e}`),T((0,q.hU)(r))}b.resetFields()})).catch((e=>{var r,l,s,a,i,n,o,t,d;null!==e&&void 0!==e&&null!==(r=e.response)&&void 0!==r&&null!==(l=r.data)&&void 0!==l&&l.params&&(p.oR.dismiss(),null===(o=Object.values(null===e||void 0===e||null===(t=e.response)||void 0===t||null===(d=t.data)||void 0===d?void 0:d.params))||void 0===o||o.map((e=>p.oR.error(e[0]))));console.log(null===e||void 0===e||null===(s=e.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.params),F(null===e||void 0===e||null===(i=e.response)||void 0===i||null===(n=i.data)||void 0===n?void 0:n.params)})).finally((()=>z(!1)))},children:(0,N.jsxs)(n.A,{gutter:12,children:[(0,N.jsx)(o.A,{span:24,children:(0,N.jsx)(a.A.Item,{rules:[{validator:()=>0===(null===U||void 0===U?void 0:U.length)?Promise.reject(new Error(l("required"))):Promise.resolve()}],name:"images",label:l("avatar"),children:(0,N.jsx)(f.A,{type:"users",imageList:U,setImageList:D,form:b,multiple:!1})})}),(0,N.jsx)(o.A,{span:12,children:(0,N.jsx)(a.A.Item,{label:l("firstname"),name:"firstname",help:null!==S&&void 0!==S&&S.firstname?S.firstname[0]:null,validateStatus:null!==S&&void 0!==S&&S.firstname?"error":"success",rules:[{validator:(e,r)=>r?r&&""===(null===r||void 0===r?void 0:r.trim())?Promise.reject(new Error(l("no.empty.space"))):r&&(null===r||void 0===r?void 0:r.trim().length)<2?Promise.reject(new Error(l("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(l("required")))}],children:(0,N.jsx)(t.A,{})})}),(0,N.jsx)(o.A,{span:12,children:(0,N.jsx)(a.A.Item,{label:"lastname",name:"lastname",help:null!==S&&void 0!==S&&S.lastname?S.lastname[0]:null,validateStatus:null!==S&&void 0!==S&&S.lastname?"error":"success",rules:[{validator:(e,r)=>r?r&&""===(null===r||void 0===r?void 0:r.trim())?Promise.reject(new Error(l("no.empty.space"))):r&&(null===r||void 0===r?void 0:r.trim().length)<2?Promise.reject(new Error(l("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(l("required")))}],children:(0,N.jsx)(t.A,{})})}),(0,N.jsx)(o.A,{span:12,children:(0,N.jsx)(a.A.Item,{label:l("phone"),name:"phone",help:null!==S&&void 0!==S&&S.phone?S.phone[0]:null,validateStatus:null!==S&&void 0!==S&&S.phone?"error":"success",rules:[{required:!0,message:l("required")}],children:(0,N.jsx)(d.A,{min:0,className:"w-100"})})}),(0,N.jsx)(o.A,{span:12,children:(0,N.jsx)(a.A.Item,{label:l("birthday"),name:"birthday",rules:[{required:!0,message:l("required")}],children:(0,N.jsx)(m.A,{onChange:(e,r)=>I(r),className:"w-100",disabledDate:e=>w()().add(-18,"years")<=e,defaultPickerValue:w()().add(-18,"years")})})}),(0,N.jsx)(o.A,{span:12,children:(0,N.jsx)(a.A.Item,{label:l("gender"),name:"gender",rules:[{required:!0,message:l("required")}],children:(0,N.jsxs)(c.A,{picker:"dayTime",className:"w-100",children:[(0,N.jsx)(c.A.Option,{value:"male",children:l("male")}),(0,N.jsx)(c.A.Option,{value:"female",children:l("female")})]})})}),(0,N.jsx)(o.A,{span:12,children:(0,N.jsx)(a.A.Item,{label:l("email"),name:"user_email",help:null!==S&&void 0!==S&&S.email?S.email[0]:null,validateStatus:null!==S&&void 0!==S&&S.email?"error":"success",rules:[{required:!0,message:l("required")},{type:"email",message:l("invalid.email")}],children:(0,N.jsx)(t.A,{type:"email"})})}),(0,N.jsx)(o.A,{span:12,children:(0,N.jsx)(a.A.Item,{label:l("password"),name:"password",help:null!==S&&void 0!==S&&S.password?S.password[0]:null,validateStatus:null!==S&&void 0!==S&&S.password?"error":"success",rules:[{required:!0,message:l("required")},{validator:(e,r)=>r&&(null===r||void 0===r?void 0:r.length)<6?Promise.reject(new Error(l("min.6.letters"))):Promise.resolve()}],normalize:e=>""===(null===e||void 0===e?void 0:e.trim())?null===e||void 0===e?void 0:e.trim():e,children:(0,N.jsx)(t.A.Password,{type:"password",className:"w-100"})})}),"admin"!==G&&"manager"!==G&&"moderator"!==G&&"seller"!==G&&"cook"!==G&&"user"!==G&&(0,N.jsx)(o.A,{span:12,children:(0,N.jsx)(a.A.Item,{label:l("shop"),name:"shop_id",rules:[{required:!0,message:l("required")}],children:(0,N.jsx)(y.G,{mode:"multiple",className:"w-100",placeholder:l("select.shop"),fetchOptions:H,allowClear:!1})})}),"cook"===G&&(0,N.jsx)(o.A,{span:12,children:(0,N.jsx)(a.A.Item,{label:l("shop"),name:"shop_id",rules:[{required:!0,message:l("required")}],children:(0,N.jsx)(y.G,{fetchOptions:H,className:"w-100",placeholder:l("select.shop"),allowClear:!1})})}),"moderator"===G&&(0,N.jsx)(o.A,{span:12,children:(0,N.jsx)(a.A.Item,{label:l("branches"),name:"shop_id",rules:[{required:!0,message:l("required")}],children:(0,N.jsx)(y.G,{fetchOptions:H,className:"w-100",placeholder:l("select.shop"),allowClear:!1})})}),(0,N.jsx)(o.A,{span:12,children:(0,N.jsx)(a.A.Item,{label:l("password.confirmation"),help:null!==S&&void 0!==S&&S.password_confirmation?S.password_confirmation[0]:null,validateStatus:null!==S&&void 0!==S&&S.password_confirmation?"error":"success",name:"password_confirmation",dependencies:["password"],hasFeedback:!0,rules:[{required:!0,message:l("required")},e=>{let{getFieldValue:r}=e;return{validator:(e,s)=>s&&r("password")!==s?Promise.reject(l("two.passwords.dont.match")):Promise.resolve()}}],normalize:e=>""===(null===e||void 0===e?void 0:e.trim())?null===e||void 0===e?void 0:e.trim():e,children:(0,N.jsx)(t.A.Password,{type:"password"})})}),"deliveryman"===G&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(u.A,{className:"pt-3 pb-3",dashed:!0,orientation:"left",plain:!0,children:l("deliveryman.settings")}),(0,N.jsx)(C,{setLocation:R,location:J,setImage:W,image:Z,form:b})]}),(0,N.jsx)(o.A,{span:24,children:(0,N.jsx)(v.A,{type:"primary",htmlType:"submit",loading:O,children:l("save")})})]})})})}},47992:(e,r,l)=>{l.d(r,{G:()=>d});var s=l(9950),a=l(95491),i=l.n(a),n=l(99674),o=l(90650),t=l(44414);const d=e=>{let{fetchOptions:r,debounceTimeout:l=400,onClear:a,...d}=e;const[m,c]=(0,s.useState)(!1),[u,v]=(0,s.useState)([]),h=(0,s.useMemo)((()=>i()((e=>{v([]),c(!0),r(e).then((e=>{v(e),c(!1)}))}),l)),[r,l]);return(0,t.jsx)(n.A,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:h,onClear:()=>{h(""),a&&a()},notFoundContent:m?(0,t.jsx)(o.A,{size:"small"}):"no results",...d,options:u,onFocus:()=>{h("")}})}},78498:(e,r,l)=>{l.d(r,{A:()=>j});var s=l(9950),a=l(97239);const i=l.p+"static/media/pin.0e41858db80c699cd8a2.png";var n=l(96011),o=l.n(n),t=l(63620);async function d(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.CJ,l={latlng:`${null===e||void 0===e?void 0:e.lat},${null===e||void 0===e?void 0:e.lng}`,key:r};return o().get("https://maps.googleapis.com/maps/api/geocode/json",{params:l}).then((e=>{var r;let{data:l}=e;return null===(r=l.results[0])||void 0===r?void 0:r.formatted_address})).catch((e=>"not found"))}var m=l(52423),c=l(12449),u=l(70030),v=l(6566),h=l(44414);const p=(0,v.A)();const j=(0,a.GoogleApiWrapper)({apiKey:p,libraries:["places","geometry"]})((function(e){var r,l;const[n,o]=(0,s.useState)(),{t:t}=(0,u.B)(),v=async()=>{await navigator.geolocation.getCurrentPosition((function(e){const r={lat:e.coords.latitude,lng:e.coords.longitude};o(r)}),(function(e){c.oR.warning(t("turn.on.gps"))}))};(0,s.useEffect)((()=>{v()}),[]);const j=[{lat:Number(null===e||void 0===e||null===(r=e.location)||void 0===r?void 0:r.lat)||0,lng:Number(null===e||void 0===e||null===(l=e.location)||void 0===l?void 0:l.lng)||0}];for(var g=new e.google.maps.LatLngBounds,A=0;A<j.length;A++)g.extend(j[A]);return(0,h.jsxs)("div",{className:"map-container",style:{height:400,width:"100%"},children:[(0,h.jsx)("button",{className:"map-button",type:"button",onClick:()=>{v(),n&&(async r=>{const l={lat:null===r||void 0===r?void 0:r.lat,lng:null===r||void 0===r?void 0:r.lng};e.setLocation(l);const s=await d(l,p);e.setAddress(s)})(n)},children:(0,h.jsx)(m.uFi,{})}),(0,h.jsx)(a.Map,{cursor:"pointer",onClick:async(r,l,s)=>{const{latLng:a}=s,i={lat:a.lat(),lng:a.lng()};e.setLocation(i);const n=await d(i,p);e.setAddress(n)},google:e.google,defaultZoom:12,zoom:10,className:"clickable",initialCenter:e.location,center:e.location,children:(0,h.jsx)(a.Marker,{position:e.location,icon:{url:i,scaledSize:new e.google.maps.Size(32,32)},className:"marker"})})]})}))}}]);