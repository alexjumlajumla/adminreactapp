"use strict";(self.webpackChunkjumlajumla_dashboard=self.webpackChunkjumlajumla_dashboard||[]).push([[5962],{85962:(e,t,s)=>{s.r(t),s.d(t,{default:()=>P});var a=s(9950),i=s(66362),l=s(23263),n=s(99985),r=s(12203),d=s(90650),o=s(48538),c=s(87094),u=s(41988),x=s(1007),p=s(24843),h=s(63611),y=s(40895),m=s(12916),j=s(37866),v=s(31598),A=s(41967),g=s(3911),f=s(79378),_=s(57560),b=s(89379);const w={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M625.9 115c-5.9 0-11.9 1.6-17.4 5.3L254 352H90c-8.8 0-16 7.2-16 16v288c0 8.8 7.2 16 16 16h164l354.5 231.7c5.5 3.6 11.6 5.3 17.4 5.3 16.7 0 32.1-13.3 32.1-32.1V147.1c0-18.8-15.4-32.1-32.1-32.1zM586 803L293.4 611.7l-18-11.7H146V424h129.4l17.9-11.7L586 221v582zm348-327H806c-8.8 0-16 7.2-16 16v40c0 8.8 7.2 16 16 16h128c8.8 0 16-7.2 16-16v-40c0-8.8-7.2-16-16-16zm-41.9 261.8l-110.3-63.7a15.9 15.9 0 00-21.7 5.9l-19.9 34.5c-4.4 7.6-1.8 17.4 5.8 21.8L856.3 800a15.9 15.9 0 0021.7-5.9l19.9-34.5c4.4-7.6 1.7-17.4-5.8-21.8zM760 344a15.9 15.9 0 0021.7 5.9L892 286.2c7.6-4.4 10.2-14.2 5.8-21.8L878 230a15.9 15.9 0 00-21.7-5.9L746 287.8a15.99 15.99 0 00-5.8 21.8L760 344z"}}]},name:"sound",theme:"outlined"};var I=s(25085),S=function(e,t){return a.createElement(I.A,(0,b.A)((0,b.A)({},e),{},{ref:t,icon:w}))};S.displayName="SoundOutlined";const T=a.forwardRef(S);var k=s(40271);const q={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M925.9 804l-24-199.2c-.8-6.6-8.9-9.4-13.6-4.7L829 659.5 557.7 388.3c-6.3-6.2-16.4-6.2-22.6 0L433.3 490 156.6 213.3a8.03 8.03 0 00-11.3 0l-45 45.2a8.03 8.03 0 000 11.3L422 591.7c6.2 6.3 16.4 6.3 22.6 0L546.4 490l226.1 226-59.3 59.3a8.01 8.01 0 004.7 13.6l199.2 24c5.1.7 9.5-3.7 8.8-8.9z"}}]},name:"fall",theme:"outlined"};var L=function(e,t){return a.createElement(I.A,(0,b.A)((0,b.A)({},e),{},{ref:t,icon:q}))};L.displayName="FallOutlined";const R=a.forwardRef(L);var z=s(82371),F=(s(59051),s(44414));const{Title:N,Text:E}=i.A,M=e=>{let{title:t,data:s,type:a}=e;return(0,F.jsxs)(l.A,{title:t,className:"chart-fallback",children:[(0,F.jsx)(n.A,{message:("line"===a?"Line":"Pie")+" chart could not be displayed",description:"The chart visualization library could not be loaded. Showing data in tabular format instead.",type:"info",showIcon:!0,style:{marginBottom:15}}),"line"===a?(0,F.jsx)("div",{children:(0,F.jsx)(r.A,{dataSource:s||[],columns:[{title:"Date",dataIndex:"date",key:"date"},{title:"Type",dataIndex:"type",key:"type"},{title:"Count",dataIndex:"count",key:"count"}],size:"small",pagination:!1,rowKey:e=>`${e.date}-${e.type}`})}):(0,F.jsx)("div",{children:(0,F.jsx)(r.A,{dataSource:s||[],columns:[{title:"Type",dataIndex:"type",key:"type"},{title:"Value",dataIndex:"value",key:"value"}],size:"small",pagination:!1,rowKey:"type"})})]})},C=e=>{let{children:t,fallback:s,title:i,data:l,type:n}=e;const[r,d]=(0,a.useState)(!1);return r?s||(0,F.jsx)(M,{title:i,data:l,type:n}):(0,F.jsx)("div",{onError:()=>d(!0),children:t})},P=()=>{const[e,t]=(0,a.useState)({}),[i,r]=(0,a.useState)([]),[b,w]=(0,a.useState)([]),[I,S]=(0,a.useState)(!0),[q,L]=(0,a.useState)(null),[P,D]=(0,a.useState)(!1),[B,U]=(0,a.useState)(null),[$,H]=(0,a.useState)(null);(0,a.useEffect)((()=>{(async()=>{try{const e=await Promise.all([s.e(1397),s.e(8027)]).then(s.bind(s,10408)).catch((e=>{throw console.error("Error importing charts package:",e.message),new Error("Charts package not available")}));if(!(e&&e.Line&&e.Pie))throw new Error("Required chart components not found in package");U((()=>e.Line)),H((()=>e.Pie)),D(!0)}catch(e){console.error("Error loading chart components:",e),D(!1)}})()}),[]);const O=async()=>{S(!0),L(null);try{const e=await z.A.get("/api/v1/dashboard/admin/ai-assistant/statistics"),s=await z.A.get("/api/v1/dashboard/admin/ai-assistant/top-filters"),a=await z.A.get("/api/v1/dashboard/admin/ai-assistant/top-exclusions");t(e.data.data||{}),r(s.data.data||[]),w(a.data.data||[])}catch(a){var e,s;console.error("Error fetching AI Assistant data:",a),L("Failed to load AI Assistant statistics: "+((null===(e=a.response)||void 0===e||null===(s=e.data)||void 0===s?void 0:s.message)||a.message))}finally{S(!1)}};(0,a.useEffect)((()=>{O()}),[]);const V=()=>{O()};if(I)return(0,F.jsxs)("div",{style:{textAlign:"center",padding:"50px"},children:[(0,F.jsx)(d.A,{size:"large"}),(0,F.jsx)("p",{children:"Loading AI Assistant statistics..."})]});const K=(null===e||void 0===e?void 0:e.total_requests)>0?(e.successful_requests/e.total_requests*100).toFixed(1):0,G={data:(null===e||void 0===e?void 0:e.usage_by_date)||[],xField:"date",yField:"count",seriesField:"type",legend:{position:"top"},smooth:!0,animation:{appear:{animation:"path-in",duration:1e3}}},J={appendPadding:10,data:(null===e||void 0===e?void 0:e.request_types)||[],angleField:"value",colorField:"type",radius:.75,label:{type:"spider",labelHeight:28,content:"{name}: {percentage}"},interactions:[{type:"element-active"}]};return(0,F.jsxs)("div",{className:"ai-assistant-dashboard",children:[(0,F.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[(0,F.jsxs)("div",{children:[(0,F.jsx)(N,{level:2,children:"AI Assistant Dashboard"}),(0,F.jsx)(E,{type:"secondary",children:"Overview of AI voice ordering and assistance system"})]}),(0,F.jsx)(o.A,{type:"primary",icon:(0,F.jsx)(j.A,{}),onClick:V,loading:I,children:"Refresh"})]}),q&&(0,F.jsx)(n.A,{message:"Error",description:q,type:"error",showIcon:!0,style:{marginBottom:20},action:(0,F.jsx)(o.A,{size:"small",type:"primary",onClick:V,children:"Try Again"})}),(0,F.jsxs)(c.A,{gutter:[24,24],className:"mt-4",children:[(0,F.jsx)(u.A,{xs:24,sm:12,md:6,children:(0,F.jsx)(l.A,{children:(0,F.jsx)(x.A,{title:"Total Requests",value:(null===e||void 0===e?void 0:e.total_requests)||0,prefix:(0,F.jsx)(v.A,{})})})}),(0,F.jsx)(u.A,{xs:24,sm:12,md:6,children:(0,F.jsxs)(l.A,{children:[(0,F.jsx)(x.A,{title:"Success Rate",value:K||0,suffix:"%",prefix:(0,F.jsx)(A.A,{style:{color:"#52c41a"}})}),(0,F.jsx)(p.A,{percent:K||0,size:"small",status:K>=75?"success":K>=50?"normal":"exception",showInfo:!1,style:{marginTop:8}})]})}),(0,F.jsx)(u.A,{xs:24,sm:12,md:6,children:(0,F.jsx)(l.A,{children:(0,F.jsx)(x.A,{title:"Avg Processing Time",value:(null===e||void 0===e?void 0:e.avg_processing_time)||0,suffix:"ms",prefix:(0,F.jsx)(g.A,{})})})}),(0,F.jsx)(u.A,{xs:24,sm:12,md:6,children:(0,F.jsx)(l.A,{children:(0,F.jsx)(x.A,{title:"Active Users",value:(null===e||void 0===e?void 0:e.active_users)||0,prefix:(0,F.jsx)(f.A,{}),valueStyle:{color:"#1890ff"}})})})]}),(0,F.jsxs)(c.A,{gutter:[24,24],style:{marginTop:24},children:[(0,F.jsx)(u.A,{xs:24,lg:12,children:P&&B?(0,F.jsx)(l.A,{title:"Usage by Date",children:(0,F.jsx)(C,{title:"Usage by Date",data:(null===e||void 0===e?void 0:e.usage_by_date)||[],type:"line",children:(0,F.jsx)(B,{...G})})}):(0,F.jsx)(M,{title:"Usage by Date",data:(null===e||void 0===e?void 0:e.usage_by_date)||[],type:"line"})}),(0,F.jsx)(u.A,{xs:24,lg:12,children:P&&$?(0,F.jsx)(l.A,{title:"Request Types",children:(0,F.jsx)(C,{title:"Request Types",data:(null===e||void 0===e?void 0:e.request_types)||[],type:"pie",children:(0,F.jsx)($,{...J})})}):(0,F.jsx)(M,{title:"Request Types",data:(null===e||void 0===e?void 0:e.request_types)||[],type:"pie"})})]}),(0,F.jsxs)(c.A,{gutter:[24,24],className:"mt-4",children:[(0,F.jsx)(u.A,{xs:24,md:12,children:(0,F.jsx)(l.A,{title:"Top Food Filters",className:"card-with-list",children:(0,F.jsx)(h.Ay,{dataSource:i||[],renderItem:e=>(0,F.jsx)(h.Ay.Item,{children:(0,F.jsx)(h.Ay.Item.Meta,{title:e.filter,description:(0,F.jsx)(p.A,{percent:e.percentage||0,size:"small",format:()=>`${e.count||0} times`})})}),locale:{emptyText:"No filter data available"}})})}),(0,F.jsx)(u.A,{xs:24,md:12,children:(0,F.jsx)(l.A,{title:"Top Food Exclusions",className:"card-with-list",children:(0,F.jsx)(h.Ay,{dataSource:b||[],renderItem:e=>(0,F.jsx)(h.Ay.Item,{children:(0,F.jsx)(h.Ay.Item.Meta,{title:e.exclusion,description:(0,F.jsx)(p.A,{percent:e.percentage||0,size:"small",format:()=>`${e.count||0} times`,strokeColor:"#f5222d"})})}),locale:{emptyText:"No exclusion data available"}})})})]}),(0,F.jsxs)(c.A,{gutter:[24,24],className:"mt-4",children:[(0,F.jsx)(u.A,{xs:24,lg:8,children:(0,F.jsxs)(l.A,{title:"Recent Status",children:[(0,F.jsxs)(c.A,{gutter:[16,16],children:[(0,F.jsx)(u.A,{span:12,children:(0,F.jsx)(x.A,{title:"Successful",value:(null===e||void 0===e?void 0:e.successful_requests)||0,valueStyle:{color:"#3f8600"},prefix:(0,F.jsx)(A.A,{})})}),(0,F.jsx)(u.A,{span:12,children:(0,F.jsx)(x.A,{title:"Failed",value:(null===e||void 0===e?void 0:e.failed_requests)||0,valueStyle:{color:"#cf1322"},prefix:(0,F.jsx)(_.A,{})})})]}),(0,F.jsx)(y.A,{}),(0,F.jsxs)(c.A,{gutter:[16,16],children:[(0,F.jsx)(u.A,{span:12,children:(0,F.jsx)(x.A,{title:"Voice Orders",value:(null===e||void 0===e?void 0:e.voice_order_count)||0,prefix:(0,F.jsx)(T,{})})}),(0,F.jsx)(u.A,{span:12,children:(0,F.jsx)(x.A,{title:"Text Chats",value:(null===e||void 0===e?void 0:e.text_chat_count)||0,prefix:(0,F.jsx)(f.A,{})})})]})]})}),(0,F.jsx)(u.A,{xs:24,lg:8,children:(0,F.jsxs)(l.A,{title:"Daily Metrics",children:[(0,F.jsx)(x.A,{title:"Today's Requests",value:(null===e||void 0===e?void 0:e.today_requests)||0,valueStyle:{color:"#1890ff"}}),(0,F.jsxs)("div",{style:{marginTop:10},children:[(0,F.jsx)(E,{type:"secondary",children:"Compared to yesterday:"}),(0,F.jsx)("div",{style:{display:"flex",alignItems:"center",marginTop:5},children:(null===e||void 0===e?void 0:e.today_vs_yesterday)>0?(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(k.A,{style:{color:"#3f8600",marginRight:8}}),(0,F.jsxs)(E,{style:{color:"#3f8600"},children:[Math.abs(e.today_vs_yesterday),"% increase"]})]}):(null===e||void 0===e?void 0:e.today_vs_yesterday)<0?(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(R,{style:{color:"#cf1322",marginRight:8}}),(0,F.jsxs)(E,{style:{color:"#cf1322"},children:[Math.abs(e.today_vs_yesterday),"% decrease"]})]}):(0,F.jsx)(E,{children:"No change"})})]}),(0,F.jsx)(y.A,{}),(0,F.jsx)(x.A,{title:"Avg Request Time (today)",value:(null===e||void 0===e?void 0:e.today_avg_time)||0,suffix:"ms"})]})}),(0,F.jsx)(u.A,{xs:24,lg:8,children:(0,F.jsx)(l.A,{title:"Most Recommended Products",children:null!==e&&void 0!==e&&e.top_products&&e.top_products.length>0?(0,F.jsx)(h.Ay,{dataSource:e.top_products,renderItem:e=>(0,F.jsxs)(h.Ay.Item,{children:[(0,F.jsx)(h.Ay.Item.Meta,{title:e.product_name||"Unknown Product",description:`Recommended ${e.count||0} times`}),(0,F.jsx)(m.A,{color:"green",children:e.category||"N/A"})]})}):(0,F.jsx)("div",{style:{textAlign:"center",padding:"40px 0"},children:(0,F.jsx)(E,{type:"secondary",children:"No product recommendation data available"})})})})]})]})}}}]);