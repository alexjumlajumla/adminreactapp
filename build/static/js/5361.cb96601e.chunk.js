"use strict";(self.webpackChunkjumlajumla_dashboard=self.webpackChunkjumlajumla_dashboard||[]).push([[5361],{5361:(e,s,l)=>{l.r(s),l.d(s,{default:()=>Z});var i=l(9950),d=l(20978),n=l(23263),a=l(80737),r=l(48538),o=l(87094),t=l(41988),c=l(66362),v=l(74522),u=l(86366),x=l(90650),m=l(12916),j=l(12203),h=l(14936),p=l(74947),A=l(81419),y=l(24513),N=l(13564),b=l(26689),f=l(69554),g=l(91854),_=l(74623),k=l(3969),w=l(32645),C=l(99674),I=l(70030),z=l(51912),q=l(15249),B=l(44414);function M(e){let{orderDetails:s,handleCancel:l,status:d}=e;const{activeMenu:n}=(0,g.d4)((e=>e.menu),g.bN),[a]=k.A.useForm(),c=(0,g.wA)(),{t:v}=(0,I.B)(),[u,x]=(0,i.useState)(!1),[m,j]=(0,i.useState)(s.status);return(0,B.jsx)(w.A,{visible:!!s,title:v("refund"),closable:!1,footer:[(0,B.jsx)(r.A,{type:"primary",onClick:()=>a.submit(),loading:u,children:v("save")},"save-form"),(0,B.jsx)(r.A,{type:"default",onClick:l,children:v("cancel")},"cansel-modal")],children:(0,B.jsx)(k.A,{form:a,layout:"vertical",onFinish:e=>{x(!0);const i={...e};z.A.update(s.id,i).then((()=>{l(),c((0,_.Ms)(n))})).finally((()=>x(!1)))},initialValues:{status:s.status},children:(0,B.jsx)(o.A,{gutter:12,children:(0,B.jsxs)(t.A,{span:24,children:[(0,B.jsx)(k.A.Item,{label:v("status"),name:"status",rules:[{required:!0,message:v("required")}],children:(0,B.jsx)(C.A,{onChange:e=>j(e),children:d.map(((e,s)=>(0,B.jsx)(C.A.Option,{value:e,children:v(e)},s)))})}),"accepted"!==m&&(0,B.jsx)(k.A.Item,{label:v("answer"),name:"answer",rules:[{required:!0,message:v("required")}],children:(0,B.jsx)(q.A,{rows:4})})]})})})})}var Y=l(29514),$=l(53774),H=l(90352),S=l(50327),D=l(16339),T=l(63620),E=l(29949),F=l(52423),O=l(59051),R=l.n(O);const V=["pending","accepted","canceled"];function Z(){var e,s,l,k,w,C,q,O,Z,K,L,G,J,P,Q,U,W,X,ee,se,le,ie,de,ne,ae,re,oe,te,ce,ve,ue,xe,me,je,he,pe,Ae;const{activeMenu:ye}=(0,g.d4)((e=>e.menu),g.bN),{defaultCurrency:Ne}=(0,g.d4)((e=>e.currency),g.bN),be=null===ye||void 0===ye||null===(e=ye.data)||void 0===e?void 0:e.order,{t:fe}=(0,I.B)(),{id:ge}=(0,N.g)(),_e=(0,g.wA)(),ke=(0,i.useRef)(),we=(0,i.useRef)(),[Ce,Ie]=(0,i.useState)(!1),[ze,qe]=(0,i.useState)(null),{statusList:Be}=(0,g.d4)((e=>e.orderStatus),g.bN),Me=[{title:fe("id"),dataIndex:"id",key:"id",render:(e,s)=>{var l;return null===(l=s.stock)||void 0===l?void 0:l.id}},{title:fe("product.name"),dataIndex:"product",key:"product",render:(e,s)=>{var l,i,d;return null===(l=s.stock)||void 0===l||null===(i=l.product)||void 0===i||null===(d=i.translation)||void 0===d?void 0:d.title}},{title:fe("image"),dataIndex:"img",key:"img",render:(e,s)=>{var l,i;return(0,B.jsx)(d.A,{src:(0,f.A)(null===(l=s.stock)||void 0===l||null===(i=l.product)||void 0===i?void 0:i.img),alt:"product",width:100,height:"auto",className:"rounded",preview:!0,placeholder:!0})}},{title:fe("price"),dataIndex:"origin_price",key:"origin_price",render:(e,s)=>(0,$.A)(null===s||void 0===s?void 0:s.origin_price,null===Ne||void 0===Ne?void 0:Ne.symbol)},{title:fe("quantity"),dataIndex:"quantity",key:"quantity"},{title:fe("discount"),dataIndex:"discount",key:"discount",render:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=arguments.length>1?arguments[1]:void 0;return(0,$.A)(e/s.quantity,null===Ne||void 0===Ne?void 0:Ne.symbol)}},{title:fe("tax"),dataIndex:"tax",key:"tax",render:(e,s)=>(0,$.A)(e/s.quantity,null===Ne||void 0===Ne?void 0:Ne.symbol)},{title:fe("total.price"),dataIndex:"total_price",key:"total_price",render:(e,s)=>(0,$.A)(null===s||void 0===s?void 0:s.total_price,null===Ne||void 0===Ne?void 0:Ne.symbol)}],Ye=[{title:fe("date"),dataIndex:"date",key:"date"},{title:fe("document"),dataIndex:"document",key:"document"},{title:fe("number"),dataIndex:"number",key:"number"},{title:fe("total.price"),dataIndex:"price",key:"price"}],$e=[{price:(0,$.A)(null===be||void 0===be?void 0:be.total_price,null===Ne||void 0===Ne?void 0:Ne.symbol),number:(0,B.jsxs)(b.N_,{to:`/orders/generate-invoice/${null===be||void 0===be?void 0:be.id}`,children:["#",null===be||void 0===be?void 0:be.id]}),document:fe("invoice"),date:null===be||void 0===be?void 0:be.delivery_date},{price:"-",number:(0,B.jsxs)(b.N_,{to:`/orders/generate-invoice/${null===be||void 0===be?void 0:be.id}`,children:["#",null===be||void 0===be?void 0:be.id]}),document:fe("delivery.reciept"),date:null===be||void 0===be?void 0:be.delivery_date}];return(0,i.useEffect)((()=>{ye.refetch&&(Ie(!0),z.A.getById(ge).then((e=>{let{data:s}=e;_e((0,_.Ok)({activeMenu:ye,data:s}))})).finally((()=>{Ie(!1),_e((0,_.km)(ye))})),_e((0,H.nr)()),_e((0,Y.d8)()))}),[ye.refetch]),(0,B.jsxs)("div",{className:"order_details",children:[(0,B.jsx)(n.A,{className:"order-details-info",title:(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(D.iHs,{className:"mr-2 icon"}),`${fe("order")} ${null!==be&&void 0!==be&&be.id?`#${null===be||void 0===be?void 0:be.id} `:""}`," ",fe("from.order")," ",null===be||void 0===be||null===(s=be.user)||void 0===s?void 0:s.firstname," ",(null===be||void 0===be||null===(l=be.user)||void 0===l?void 0:l.lastname)||""]}),extra:"delivered"!==(null===be||void 0===be?void 0:be.status)&&"canceled"!==(null===be||void 0===be?void 0:be.status)?(0,B.jsx)(a.A,{children:"delivered"!==(null===be||void 0===be?void 0:be.status)&&"canceled"!==(null===be||void 0===be?void 0:be.status)?(0,B.jsx)(r.A,{type:"primary",onClick:()=>qe(be),children:fe("change.status")}):null}):""}),(0,B.jsxs)(o.A,{gutter:24,children:[(0,B.jsx)(t.A,{span:24,children:(0,B.jsx)(n.A,{children:(0,B.jsxs)(a.A,{className:"justify-content-between w-100",children:[(0,B.jsxs)(a.A,{className:"align-items-start",children:[(0,B.jsx)(A.A,{className:"order-card-icon"}),(0,B.jsxs)("div",{className:"d-flex flex-column",children:[(0,B.jsx)(c.A.Text,{children:fe("delivery.date")}),Ce?(0,B.jsx)(v.A.Button,{size:16}):(0,B.jsxs)(c.A.Text,{className:"order-card-title",children:[null===be||void 0===be?void 0:be.delivery_date," ",null===be||void 0===be?void 0:be.delivery_time]})]})]}),(0,B.jsxs)(a.A,{className:"align-items-start",onClick:()=>we.current.scrollIntoView({behavior:"smooth"}),children:[(0,B.jsx)(F.aOb,{className:"order-card-icon"}),(0,B.jsxs)("div",{className:"d-flex flex-column",children:[(0,B.jsx)(c.A.Text,{children:fe("total.price")}),Ce?(0,B.jsx)(v.A.Button,{size:16,loading:Ce}):(0,B.jsx)(c.A.Text,{className:"order-card-title",children:(0,$.A)(null===be||void 0===be?void 0:be.total_price,null===Ne||void 0===Ne?void 0:Ne.symbol)})]})]}),(0,B.jsxs)(a.A,{className:"align-items-start",children:[(0,B.jsx)(F.j6C,{className:"order-card-icon"}),(0,B.jsxs)("div",{className:"d-flex flex-column",children:[(0,B.jsx)(c.A.Text,{children:fe("messages")}),Ce?(0,B.jsx)(v.A.Button,{size:16}):(0,B.jsx)(c.A.Text,{className:"order-card-title",children:null!==be&&void 0!==be&&be.review?1:0})]})]}),(0,B.jsxs)(a.A,{className:"align-items-start",onClick:()=>ke.current.scrollIntoView({behavior:"smooth"}),children:[(0,B.jsx)(D.iHs,{className:"order-card-icon"}),(0,B.jsxs)("div",{className:"d-flex flex-column",children:[(0,B.jsx)(c.A.Text,{children:fe("products")}),Ce?(0,B.jsx)(v.A.Button,{size:16}):(0,B.jsx)(c.A.Text,{className:"order-card-title",children:null===be||void 0===be||null===(k=be.details)||void 0===k?void 0:k.reduce(((e,s)=>e+s.quantity),0)})]})]})]})})}),"canceled"!==(null===be||void 0===be?void 0:be.status)&&(0,B.jsx)(t.A,{span:24,children:(0,B.jsx)(n.A,{children:(0,B.jsx)(u.A,{current:null===Be||void 0===Be?void 0:Be.findIndex((e=>e.name===(null===be||void 0===be?void 0:be.status))),children:null===Be||void 0===Be?void 0:Be.slice(0,-1).map((e=>(0,B.jsx)(u.A.Step,{title:fe(e.name)},e.id)))})})}),(0,B.jsxs)(t.A,{span:16,children:[(0,B.jsx)(x.A,{spinning:Ce,children:(0,B.jsx)(n.A,{style:{minHeight:"200px"},children:(0,B.jsxs)(o.A,{hidden:Ce,className:"mb-3 order_detail",children:[(0,B.jsxs)(t.A,{span:12,children:[(0,B.jsxs)("div",{children:[fe("created.date.&.time"),":",(0,B.jsxs)("span",{className:"ml-2",children:[(0,B.jsx)(E.cCc,{className:"mr-1"})," ",R()(null===be||void 0===be?void 0:be.created_at).format("YYYY-MM-DD HH:mm")," "]})]}),(0,B.jsx)("br",{}),(0,B.jsxs)("div",{children:[fe("delivery.date.&.time"),":",(0,B.jsxs)("span",{className:"ml-2",children:[(0,B.jsx)(E.cCc,{className:"mr-1"})," ",null===be||void 0===be?void 0:be.delivery_date," ",null===be||void 0===be?void 0:be.delivery_time]})]}),(0,B.jsx)("br",{}),(0,B.jsxs)("div",{children:[fe("payment.status"),":",(0,B.jsx)("span",{className:"ml-2",children:fe(null===be||void 0===be||null===(w=be.transaction)||void 0===w?void 0:w.status)})]}),(0,B.jsx)("br",{}),(0,B.jsxs)("div",{children:[fe("cause"),":",(0,B.jsx)("span",{className:"ml-2",style:{color:"red"},children:null===(C=ye.data)||void 0===C?void 0:C.cause})]}),(0,B.jsx)("br",{}),(0,B.jsxs)("div",{children:[fe("answer"),":",(0,B.jsx)("span",{className:"ml-2",children:null===(q=ye.data)||void 0===q?void 0:q.answer})]})]}),(0,B.jsxs)(t.A,{span:12,children:[(0,B.jsxs)("div",{children:[fe("status"),":",(0,B.jsxs)("span",{className:"ml-2",children:["pending"===(null===(O=ye.data)||void 0===O?void 0:O.status)?(0,B.jsx)(m.A,{color:"blue",children:fe(null===(Z=ye.data)||void 0===Z?void 0:Z.status)}):"canceled"===(null===(K=ye.data)||void 0===K?void 0:K.status)?(0,B.jsx)(m.A,{color:"error",children:fe(null===(L=ye.data)||void 0===L?void 0:L.status)}):(0,B.jsx)(m.A,{color:"cyan",children:fe(null===(G=ye.data)||void 0===G?void 0:G.status)}),"canceled"!==(null===(J=ye.data)||void 0===J?void 0:J.status)&&(0,B.jsx)(y.A,{onClick:()=>qe(null===ye||void 0===ye?void 0:ye.data)})]})]}),(0,B.jsx)("br",{}),(0,B.jsxs)("div",{children:[fe("delivery.type"),":",(0,B.jsx)("span",{className:"ml-2",children:null===be||void 0===be?void 0:be.delivery_type})]}),(0,B.jsx)("br",{}),(0,B.jsxs)("div",{children:[fe("payment.type"),":",(0,B.jsx)("span",{className:"ml-2",children:fe(null===be||void 0===be||null===(P=be.transaction)||void 0===P||null===(Q=P.payment_system)||void 0===Q?void 0:Q.tag)})]}),(0,B.jsx)("br",{}),(0,B.jsxs)("div",{children:[fe("address"),":",(0,B.jsx)("span",{className:"ml-2",children:null===be||void 0===be||null===(U=be.address)||void 0===U?void 0:U.address})]})]})]})})}),(0,B.jsx)(n.A,{title:fe("documents"),children:(0,B.jsx)(j.A,{columns:Ye,dataSource:$e||[],pagination:!1,loading:Ce})}),(0,B.jsxs)(n.A,{className:"w-100 order-table",children:[(0,B.jsx)(j.A,{ref:ke,scroll:{x:!0},columns:Me,dataSource:(null===(W=ye.data)||void 0===W||null===(X=W.order)||void 0===X?void 0:X.details)||[],loading:Ce,rowKey:e=>e.id,pagination:!1}),(0,B.jsxs)(a.A,{size:100,className:"d-flex justify-content-end w-100 order-table__summary",children:[(0,B.jsxs)("div",{children:[(0,B.jsxs)("span",{children:[fe("delivery.fee"),":"]}),(0,B.jsx)("br",{}),(0,B.jsxs)("span",{children:[fe("order.tax"),":"]}),(0,B.jsx)("br",{}),(0,B.jsxs)("span",{children:[fe("product"),":"]}),(0,B.jsx)("br",{}),(0,B.jsxs)("span",{children:[fe("coupon"),":"]}),(0,B.jsx)("br",{}),(0,B.jsxs)("span",{children:[fe("discount"),":"]}),(0,B.jsx)("br",{}),(0,B.jsxs)("h3",{children:[fe("total.price"),":"]})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("span",{children:(0,$.A)(null===be||void 0===be?void 0:be.delivery_fee,null===Ne||void 0===Ne?void 0:Ne.symbol)}),(0,B.jsx)("br",{}),(0,B.jsx)("span",{children:(0,$.A)(null===be||void 0===be?void 0:be.tax,null===Ne||void 0===Ne?void 0:Ne.symbol)}),(0,B.jsx)("br",{}),(0,B.jsx)("span",{children:(0,$.A)(null===be||void 0===be||null===(ee=be.details)||void 0===ee?void 0:ee.reduce(((e,s)=>e+s.total_price),0),null===Ne||void 0===Ne?void 0:Ne.symbol)}),(0,B.jsx)("br",{}),(0,B.jsx)("span",{children:(0,$.A)(null===be||void 0===be||null===(se=be.coupon)||void 0===se?void 0:se.price,null===Ne||void 0===Ne?void 0:Ne.symbol)}),(0,B.jsx)("br",{}),(0,B.jsx)("span",{children:(0,$.A)(null===be||void 0===be?void 0:be.total_discount,null===Ne||void 0===Ne?void 0:Ne.symbol)}),(0,B.jsx)("br",{}),(0,B.jsx)("h3",{ref:we,children:(0,$.A)(null===be||void 0===be?void 0:be.total_price,null===Ne||void 0===Ne?void 0:Ne.symbol)})]})]})]})]}),(0,B.jsxs)(t.A,{span:8,className:"order_info",children:["ready"===(null===be||void 0===be?void 0:be.status)&&"pickup"!==(null===be||void 0===be?void 0:be.delivery_type)&&(0,B.jsx)(n.A,{title:fe("deliveryman"),extra:"ready"===(null===be||void 0===be?void 0:be.status)&&"pickup"!==(null===be||void 0===be?void 0:be.delivery_type)&&(0,B.jsxs)(r.A,{children:[fe("change"),(0,B.jsx)(y.A,{})]}),children:(null===be||void 0===be?void 0:be.deliveryman)&&(0,B.jsxs)(a.A,{children:[(0,B.jsx)(h.A,{shape:"square",size:64,src:T.sE+(null===be||void 0===be||null===(le=be.deliveryman)||void 0===le?void 0:le.img)}),(0,B.jsxs)("div",{children:[(0,B.jsxs)("h5",{children:[null===be||void 0===be||null===(ie=be.deliveryman)||void 0===ie?void 0:ie.firstname," ",(null===be||void 0===be||null===(de=be.deliveryman)||void 0===de?void 0:de.lastname)||""]}),(0,B.jsxs)("span",{className:"delivery-info",children:[(0,B.jsx)(E.s91,{}),null===be||void 0===be||null===(ne=be.deliveryman)||void 0===ne?void 0:ne.phone]}),(0,B.jsxs)("div",{className:"delivery-info",children:[(0,B.jsx)("b",{children:(0,B.jsx)(S.mm2,{size:16})}),(0,B.jsx)("span",{children:null===be||void 0===be||null===(ae=be.deliveryman)||void 0===ae?void 0:ae.email})]})]})]})}),(0,B.jsx)(n.A,{title:(0,B.jsx)(a.A,{children:fe("customer.info")}),children:(0,B.jsxs)("div",{className:"d-flex w-100 customer-info-container",children:[Ce?(0,B.jsx)(v.A.Avatar,{size:64,shape:"square"}):(0,B.jsx)(h.A,{shape:"square",size:64,src:T.sE+(null===be||void 0===be||null===(re=be.deliveryman)||void 0===re?void 0:re.img)}),(0,B.jsx)("h5",{className:"customer-name",children:Ce?(0,B.jsx)(v.A.Button,{size:20,style:{width:70}}):(null===be||void 0===be||null===(oe=be.user)||void 0===oe?void 0:oe.firstname)+" "+((null===be||void 0===be||null===(te=be.user)||void 0===te?void 0:te.lastname)||"")}),(0,B.jsxs)("div",{className:"customer-info-detail",children:[(0,B.jsxs)("div",{className:"customer-info",children:[(0,B.jsx)("span",{className:"title",children:fe("phone")}),(0,B.jsxs)("span",{className:"description",children:[(0,B.jsx)(E.s91,{}),Ce?(0,B.jsx)(v.A.Button,{size:16}):(null===be||void 0===be||null===(ce=be.user)||void 0===ce?void 0:ce.phone)||"none"]})]}),(0,B.jsxs)("div",{className:"customer-info",children:[(0,B.jsx)("span",{className:"title",children:fe("email")}),(0,B.jsxs)("span",{className:"description",children:[(0,B.jsx)(S.mm2,{}),Ce?(0,B.jsx)(v.A.Button,{size:16}):null===be||void 0===be||null===(ve=be.user)||void 0===ve?void 0:ve.email]})]}),(0,B.jsxs)("div",{className:"customer-info",children:[(0,B.jsx)("span",{className:"title",children:fe("registration.date")}),(0,B.jsxs)("span",{className:"description",children:[(0,B.jsx)(E.cCc,{}),Ce?(0,B.jsx)(v.A.Button,{size:16}):R()(null===be||void 0===be||null===(ue=be.user)||void 0===ue?void 0:ue.created_at).format("DD-MM-YYYY, HH:mm")]})]}),(0,B.jsxs)("div",{className:"customer-info",children:[(0,B.jsx)("span",{className:"title",children:fe("orders.count")}),(0,B.jsx)("span",{className:"description",children:Ce?(0,B.jsx)(v.A.Button,{size:16}):(0,B.jsx)(p.A,{showZero:!0,style:{backgroundColor:"#3d7de3"},count:(null===be||void 0===be||null===(xe=be.user)||void 0===xe?void 0:xe.orders_count)||0})})]}),(0,B.jsxs)("div",{className:"customer-info",children:[(0,B.jsx)("span",{className:"title",children:fe("spent.since.registration")}),(0,B.jsx)("span",{className:"description",children:Ce?(0,B.jsx)(v.A.Button,{size:16}):(0,B.jsx)(p.A,{showZero:!0,style:{backgroundColor:"#48e33d"},count:(0,$.A)(null===be||void 0===be||null===(me=be.user)||void 0===me?void 0:me.orders_sum_total_price,null===Ne||void 0===Ne?void 0:Ne.symbol)})})]})]})]})}),(null===be||void 0===be?void 0:be.review)&&!Ce&&(0,B.jsx)(n.A,{title:fe("messages"),children:(0,B.jsxs)("div",{className:"order-message",children:[(0,B.jsx)("span",{className:"message",children:null===be||void 0===be?void 0:be.review.comment}),(0,B.jsx)(a.A,{className:"w-100 justify-content-end",children:(0,B.jsx)("span",{className:"date",children:R()(null===be||void 0===be?void 0:be.review.created_at).format("YYYY-MM-DD HH:mm")})})]})}),(0,B.jsx)(n.A,{title:fe("store.information"),children:Ce?(0,B.jsx)(v.A,{avatar:!0,shape:"square",paragraph:{rows:2}}):(0,B.jsxs)(a.A,{className:"w-100",children:[(0,B.jsx)(h.A,{shape:"square",size:64,src:T.sE+(null===be||void 0===be||null===(je=be.shop)||void 0===je?void 0:je.logo_img)}),(0,B.jsxs)("div",{children:[(0,B.jsx)("h5",{children:null===be||void 0===be||null===(he=be.shop)||void 0===he?void 0:he.translation.title}),(0,B.jsxs)("div",{className:"delivery-info",children:[(0,B.jsx)("b",{children:(0,B.jsx)(E.s91,{})}),(0,B.jsx)("span",{children:null===be||void 0===be||null===(pe=be.shop)||void 0===pe?void 0:pe.phone})]}),(0,B.jsxs)("div",{className:"delivery-info",children:[(0,B.jsx)("b",{children:(0,B.jsx)(F.cMR,{size:16})}),(0,B.jsx)("span",{children:null===be||void 0===be||null===(Ae=be.shop)||void 0===Ae?void 0:Ae.price})]})]})]})})]})]}),ze&&(0,B.jsx)(M,{orderDetails:ze,handleCancel:()=>qe(null),status:V})]})}},53774:(e,s,l)=>{l.d(s,{A:()=>d});var i=l(83291);function d(){var e,s;let l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,d=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;const a=null===(e=i.M.getState())||void 0===e||null===(s=e.currency)||void 0===s?void 0:s.defaultCurrency,r=Number(l).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,"),o=d||(null===a||void 0===a?void 0:a.symbol)||"$";return"after"===(n||(null===a||void 0===a?void 0:a.position)||"before")?`${r} ${o}`:`${o} ${r}`}}}]);