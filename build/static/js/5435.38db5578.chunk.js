(self.webpackChunkjumlajumla_dashboard=self.webpackChunkjumlajumla_dashboard||[]).push([[5435],{1662:(l,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>b});var d=i(9950),o=i(86366),n=i(23263),t=i(90650),a=i(71999),r=i(13564),v=i(67231),u=i(91854),s=i(74623),c=i(70030),p=i(65820),m=i(88986),x=i(11906),h=i(26405),y=i(79019),g=i(62425),j=i(76092),A=i(34293),k=i(44414);const{Step:f}=o.A,b=()=>{var l;const{t:e}=(0,c.B)(),{uuid:i}=(0,r.g)(),b=(0,p.s)(),_=(0,u.wA)(),{activeMenu:C}=(0,u.d4)((l=>l.menu),u.bN),{languages:q}=(0,u.d4)((l=>l.formLang),u.bN),[N,P]=(0,d.useState)(C.refetch),$=Number((null===(l=b.values)||void 0===l?void 0:l.step)||0);(0,d.useEffect)((()=>{w(i)}),[]),(0,m.A)((()=>{C.refetch&&w(i)}),[C.refetch]);const F=()=>{const l=$+1;b.set("step",l)},S=()=>{const l=$-1;b.set("step",l)},I=l=>{var e;return l?{label:null!==l&&void 0!==l&&l.translation?null===l||void 0===l||null===(e=l.translation)||void 0===e?void 0:e.title:null===l||void 0===l?void 0:l.title,value:null===l||void 0===l?void 0:l.id}:null},w=l=>{P(!0),v.A.getById(l).then((l=>{var e,i,d,o,n,t,a,r,v,u,c,p;const m={};null===l||void 0===l||null===(e=l.data)||void 0===e||null===(i=e.stocks)||void 0===i||i.forEach((l=>{var e;null===l||void 0===l||null===(e=l.extras)||void 0===e||e.forEach((e=>{var i,d,o,n,t,a,r,v,u,s;(null===e||void 0===e?void 0:e.extra_group_id)in m?null!==m&&void 0!==m&&null!==(i=m[null===e||void 0===e?void 0:e.extra_group_id])&&void 0!==i&&null!==(d=i.values)&&void 0!==d&&d.some((l=>(null===l||void 0===l?void 0:l.value)===(null===e||void 0===e?void 0:e.id)))||null===m||void 0===m||null===(o=m[null===e||void 0===e?void 0:e.extra_group_id])||void 0===o||null===(n=o.values)||void 0===n||n.push({value:null===e||void 0===e?void 0:e.id,label:null===e||void 0===e?void 0:e.value,stock_id:null===l||void 0===l?void 0:l.id,group:null===e||void 0===e||null===(t=e.group)||void 0===t||null===(a=t.translation)||void 0===a?void 0:a.title}):m[null===e||void 0===e?void 0:e.extra_group_id]={label:null===e||void 0===e||null===(r=e.group)||void 0===r||null===(v=r.translation)||void 0===v?void 0:v.title,value:null===e||void 0===e?void 0:e.extra_group_id,id:null===e||void 0===e?void 0:e.extra_group_id,stock_id:null===l||void 0===l?void 0:l.id,values:[{value:null===e||void 0===e?void 0:e.id,label:null===e||void 0===e?void 0:e.value,stock_id:null===l||void 0===l?void 0:l.id,group:null===e||void 0===e||null===(u=e.group)||void 0===u||null===(s=u.translation)||void 0===s?void 0:s.title}]}}))}));const x={...null===l||void 0===l?void 0:l.data,...B(null===l||void 0===l?void 0:l.data),category:I(null===l||void 0===l||null===(d=l.data)||void 0===d?void 0:d.category),brand:I(null===l||void 0===l||null===(o=l.data)||void 0===o?void 0:o.brand),kitchen:I(null===l||void 0===l||null===(n=l.data)||void 0===n?void 0:n.kitchen),unit:I(null===l||void 0===l||null===(t=l.data)||void 0===t?void 0:t.unit),images:(h=null===l||void 0===l||null===(a=l.data)||void 0===a?void 0:a.galleries,h.map((l=>({uid:null===l||void 0===l?void 0:l.id,name:null===l||void 0===l?void 0:l.path,url:null===l||void 0===l?void 0:l.path})))),product_id:null===l||void 0===l||null===(r=l.data)||void 0===r?void 0:r.id,extras:Object.values(m),stocks:null===l||void 0===l||null===(v=l.data)||void 0===v||null===(u=v.stocks)||void 0===u?void 0:u.map((l=>({...l,...Object.assign({},...null===l||void 0===l?void 0:l.extras.map(((l,e)=>{var i,d;return{[`extras[${e}]`]:{label:null===l||void 0===l?void 0:l.value,value:null===l||void 0===l?void 0:l.id,group:null===l||void 0===l||null===(i=l.group)||void 0===i||null===(d=i.translation)||void 0===d?void 0:d.title}}}))),quantity:(null===l||void 0===l?void 0:l.quantity)||0,extras:void 0}))),properties:null===l||void 0===l||null===(c=l.data)||void 0===c||null===(p=c.properties)||void 0===p?void 0:p.map(((l,e)=>({id:e,[`key[${null===l||void 0===l?void 0:l.locale}]`]:null===l||void 0===l?void 0:l.key,[`value[${l.locale}]`]:null===l||void 0===l?void 0:l.value}))),translation:void 0,translations:void 0};var h;_((0,s.Ok)({activeMenu:C,data:x}))})).finally((()=>{P(!1),_((0,s.km)(C))}))},B=l=>{if(null===l||void 0===l||!l.translations)return{};const{translations:e}=l,i=null===q||void 0===q?void 0:q.map((l=>{var i,d;return{[`title[${null===l||void 0===l?void 0:l.locale}]`]:null===e||void 0===e||null===(i=e.find((e=>(null===e||void 0===e?void 0:e.locale)===(null===l||void 0===l?void 0:l.locale))))||void 0===i?void 0:i.title,[`description[${null===l||void 0===l?void 0:l.locale}]`]:null===e||void 0===e||null===(d=e.find((e=>(null===e||void 0===e?void 0:e.locale)===(null===l||void 0===l?void 0:l.locale))))||void 0===d?void 0:d.description}}));return Object.assign({},...i)};return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(n.A,{title:e("edit.food"),extra:(0,k.jsx)(a.A,{}),children:(0,k.jsx)(o.A,{current:$,onChange:l=>{_((0,s.Ok)({activeMenu:C,data:{...C.data,step:l}})),b.set("step",l)},children:h.C.map((l=>(0,k.jsx)(f,{title:e(l.title)},l.title)))})}),N?(0,k.jsx)("div",{className:"d-flex justify-content-center align-items-center",children:(0,k.jsx)(t.A,{size:"large",className:"py-5"})}):(0,k.jsxs)("div",{children:["First-content"===h.C[$].content&&(0,k.jsx)(A.A,{next:F,action_type:"edit"}),"Second-content"===h.C[$].content&&(0,k.jsx)(j.A,{next:F,prev:S,mode:"edit"}),"Third-content"===h.C[$].content&&(0,k.jsx)(x.A,{next:F,prev:S,userRole:"seller"}),"Fourth-content"===h.C[$].content&&(0,k.jsx)(y.A,{next:F,prev:S,mode:"edit"}),"Finish-content"===h.C[$].content&&(0,k.jsx)(g.A,{prev:S,mode:"edit"})]})]})}},42634:()=>{},65820:(l,e,i)=>{"use strict";i.d(e,{s:()=>t});var d=i(13564),o=i(21215),n=i.n(o);const t=()=>{const l=(0,d.Zp)(),e=(0,d.zy)(),i=n().parse(e.search,{ignoreQueryPrefix:!0});return{values:i,set:(e,d)=>l({search:n().stringify({...i,[e]:d})}),reset:e=>{const d={...i};d[e]&&delete d[e],l({search:n().stringify({...d})})},clear:()=>l({search:n().stringify({})}),merge:e=>l({search:n().stringify({...i,...e})}),get:l=>i[l],setMultiple:e=>{const d={...i,...e};l({search:n().stringify(d)})},resetMultiple:e=>{const d={...i};e.forEach((l=>{d[l]&&delete d[l]})),l({search:n().stringify(d)})}}}},79019:(l,e,i)=>{"use strict";i.d(e,{A:()=>N});var d=i(91854),o=i(9950),n=i(68387),t=i(32645),a=i(23263),r=i(80737),v=i(48538),u=i(70030),s=i(67231),c=i(12449),p=i(13564),m=i(74623),x=i(12203),h=i(24513),y=i(44070),g=i(35116),j=i(44414);const A=l=>{let{properties:e,editSelectedProperty:i,deleteProperty:d,loading:o=!1}=l;const{t:n}=(0,u.B)(),t=[{title:n("key"),dataIndex:"key",key:"key"},{title:n("value"),dataIndex:"value",key:"value"},{title:n("options"),key:"options",render:(l,e)=>(0,j.jsxs)(r.A,{children:[(0,j.jsx)(v.A,{type:"primary",icon:(0,j.jsx)(h.A,{}),onClick:()=>i(e)}),(0,j.jsx)(g.A,{type:"primary",danger:!0,icon:(0,j.jsx)(y.A,{}),onClick:()=>d(null===e||void 0===e?void 0:e.id)})]})}];return(0,j.jsx)(a.A,{loading:o,children:(0,j.jsx)(x.A,{dataSource:e,columns:t,pagination:!1})})};var k=i(3969),f=i(87094),b=i(41988),_=i(55902);const C=l=>{let{addNewProperty:e,loading:i=!1}=l;const{t:o}=(0,u.B)(),[t]=k.A.useForm(),{defaultLang:r,languages:s}=(0,d.d4)((l=>l.formLang),d.bN);return(0,j.jsx)(a.A,{loading:i,children:(0,j.jsx)(k.A,{form:t,layout:"vertical",onFinish:l=>{const i={key:null===l||void 0===l?void 0:l[`key[${r}]`],value:null===l||void 0===l?void 0:l[`value[${r}]`]},d=s.map((e=>({id:(0,n.P)(),locale:null===e||void 0===e?void 0:e.locale,key:(null===l||void 0===l?void 0:l[`key[${null===e||void 0===e?void 0:e.locale}]`])||(null===i||void 0===i?void 0:i.key),value:(null===l||void 0===l?void 0:l[`value[${e.locale}]`])||(null===i||void 0===i?void 0:i.value)})));e(d),t.resetFields()},children:(0,j.jsxs)(f.A,{gutter:12,children:[(0,j.jsx)(b.A,{span:8,children:s.map((l=>(0,j.jsx)(k.A.Item,{label:o("key"),name:`key[${(null===l||void 0===l?void 0:l.locale)||"en"}]`,hidden:(null===l||void 0===l?void 0:l.locale)!==r,rules:[{required:(null===l||void 0===l?void 0:l.locale)===r,message:o("required")},{type:"string",min:2,max:200,message:o("min.2.max.200.chars")}],children:(0,j.jsx)(_.A,{})},null===l||void 0===l?void 0:l.locale)))}),(0,j.jsx)(b.A,{span:8,children:s.map((l=>(0,j.jsx)(k.A.Item,{label:o("value"),name:`value[${(null===l||void 0===l?void 0:l.locale)||"en"}]`,hidden:(null===l||void 0===l?void 0:l.locale)!==r,rules:[{required:(null===l||void 0===l?void 0:l.locale)===r,message:o("required")},{type:"string",min:2,max:200,message:o("min.2.max.200.chars")}],children:(0,j.jsx)(_.A,{})},null===l||void 0===l?void 0:l.locale)))}),(0,j.jsx)(b.A,{children:(0,j.jsx)(k.A.Item,{label:" ",children:(0,j.jsx)(v.A,{type:"primary",htmlType:"submit",children:o("add")})})})]})})})},q=l=>{let{property:e,editProperty:i}=l;const{t:d}=(0,u.B)(),[o]=k.A.useForm();return(0,j.jsx)(a.A,{children:(0,j.jsx)(k.A,{form:o,layout:"vertical",onFinish:l=>{i({...e,...l})},initialValues:{key:null===e||void 0===e?void 0:e.key,value:null===e||void 0===e?void 0:e.value},children:(0,j.jsxs)(f.A,{gutter:12,children:[(0,j.jsx)(b.A,{span:24,children:(0,j.jsx)(k.A.Item,{label:d("key"),name:"key",rules:[{required:!0,message:d("required")},{type:"string",min:2,max:200,message:d("min.2.max.200.chars")}],children:(0,j.jsx)(_.A,{})})}),(0,j.jsx)(b.A,{span:24,children:(0,j.jsx)(k.A.Item,{label:d("value"),name:"value",rules:[{required:!0,message:d("required")},{type:"string",min:2,max:200,message:d("min.2.max.200.chars")}],children:(0,j.jsx)(_.A,{})})}),(0,j.jsx)(b.A,{span:24,children:(0,j.jsx)(v.A,{type:"primary",htmlType:"submit",className:"w-100",children:d("edit")})})]})})})},N=l=>{var e;let{prev:i,next:x,isRequest:h=!1}=l;const{t:y}=(0,u.B)(),{uuid:g}=(0,p.g)(),k=(0,d.wA)(),{defaultLang:f}=(0,d.d4)((l=>l.formLang),d.bN),{activeMenu:b}=(0,d.d4)((l=>l.menu),d.bN),[_,N]=(0,o.useState)(h&&(null===(e=b.data)||void 0===e?void 0:e.properties)||[]),[P,$]=(0,o.useState)(null),[F,S]=(0,o.useState)(!1),[I,w]=(0,o.useState)(!1);(0,o.useEffect)((()=>{h||B(g)}),[]);const B=l=>{S(!0),s.A.getById(l).then((l=>{var e,i;N(null===l||void 0===l||null===(e=l.data)||void 0===e||null===(i=e.properties)||void 0===i?void 0:i.map((l=>({...l,id:(0,n.P)()}))))})).finally((()=>{S(!1)}))};return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(C,{loading:F,addNewProperty:l=>{N([..._,...l])}}),(0,j.jsx)(A,{loading:F,properties:null===_||void 0===_?void 0:_.filter((l=>(null===l||void 0===l?void 0:l.locale)===f)),editSelectedProperty:$,deleteProperty:l=>{t.A.confirm({title:y("are.you.sure?"),okText:y("yes"),onOk:()=>{N((e=>e.filter((e=>e.id!==l))))}})}}),(0,j.jsx)(a.A,{children:(0,j.jsxs)(r.A,{children:[(0,j.jsx)(v.A,{onClick:i,disabled:F,children:y("prev")}),(0,j.jsx)(v.A,{type:"primary",onClick:()=>{const l={key:[],value:[]};if(null===_||void 0===_||_.map((e=>{l.key.push({[null===e||void 0===e?void 0:e.locale]:null===e||void 0===e?void 0:e.key}),l.value.push({[null===e||void 0===e?void 0:e.locale]:null===e||void 0===e?void 0:e.value})})),h)return k((0,m.Ok)({activeMenu:b,data:{...b.data,properties:_,props:l}})),void x();w(!0),s.A.properties(g,l).then((()=>{c.oR.success(y("successfully.updated")),x()})).finally((()=>{w(!1)}))},disabled:F,loading:I,children:y("next")})]})}),!!P&&(0,j.jsx)(t.A,{visible:!!P,onCancel:()=>{$(null)},footer:!1,children:(0,j.jsx)(q,{property:P,editProperty:l=>{N((e=>e.map((e=>e.id===l.id?l:e)))),$(null)}})})]})}}}]);