(self.webpackChunkjumlajumla_dashboard=self.webpackChunkjumlajumla_dashboard||[]).push([[946],{6566:(e,l,i)=>{"use strict";i.d(l,{A:()=>t});var n=i(83291),a=i(63620);const t=()=>{var e,l;const{google_map_key:i}=null===(e=n.M.getState())||void 0===e||null===(l=e.globalSettings)||void 0===l?void 0:l.settings;return i||a.CJ}},38633:(e,l,i)=>{"use strict";i.r(l),i.d(l,{default:()=>R});var n=i(54909),a=i(23263),t=i(70030),o=i(9950),s=i(65820),r=i(66209),d=i(62466),u=i(91854),v=i(13564),c=i(88986),m=i(74623),g=i(59051),h=i.n(g),p=i(3969),b=i(87094),x=i(41988),y=i(55902),j=i(8724),A=i(87864),f=i(99674),k=i(25933),C=i(48538),S=i(16254),w=i(13311),q=i(12449),I=i(47992),M=i(63672),_=i(91422),N=i(44414);const z=e=>{var l,i,n,a,s,d,v;let{data:c}=e;const[m]=p.A.useForm(),{t:g}=(0,t.B)(),{isDemo:z}=(0,w.A)(),{myShop:P}=(0,u.d4)((e=>e.myShop),u.bN),[F,O]=(0,o.useState)((null===c||void 0===c?void 0:c.avatar)||[]),[W,L]=(0,o.useState)(!1),R={...c,kitchen:null!==c&&void 0!==c&&c.kitchen?{label:null===c||void 0===c||null===(l=c.kitchen)||void 0===l||null===(i=l.translation)||void 0===i?void 0:i.title,value:null===c||void 0===c||null===(n=c.kitchen)||void 0===n?void 0:n.id,key:null===c||void 0===c||null===(a=c.kitchen)||void 0===a?void 0:a.id}:null,table:null!==c&&void 0!==c&&c.table?{label:null===c||void 0===c||null===(s=c.table)||void 0===s?void 0:s.name,value:null===c||void 0===c||null===(d=c.table)||void 0===d?void 0:d.id,key:null===c||void 0===c||null===(v=c.table)||void 0===v?void 0:v.id}:null,isWork:!(null===c||void 0===c||!c.isWork)};return(0,N.jsx)(p.A,{form:m,layout:"vertical",initialValues:R,onFinish:e=>{var l,i,n,a;const t={images:null!==F&&void 0!==F&&F[0]?[null===F||void 0===F||null===(l=F[0])||void 0===l?void 0:l.name]:void 0,firstname:null===e||void 0===e?void 0:e.firstname,lastname:null===e||void 0===e?void 0:e.lastname,email:z||null===e||void 0===e?void 0:e.email,phone:z||null===e||void 0===e?void 0:e.phone,birthday:null!==e&&void 0!==e&&e.birthday?h()(null===e||void 0===e?void 0:e.birthday).format("YYYY-MM-DD"):void 0,gender:null===e||void 0===e||null===(i=e.gender)||void 0===i?void 0:i.value,role:null===c||void 0===c?void 0:c.role,shop_id:[null===P||void 0===P?void 0:P.id],kitchen_id:"cook"===(null===c||void 0===c?void 0:c.role)?null===e||void 0===e||null===(n=e.kitchen)||void 0===n?void 0:n.value:void 0,table_id:"deliveryman"===(null===c||void 0===c?void 0:c.role)?null===e||void 0===e||null===(a=e.table)||void 0===a?void 0:a.value:void 0,isWork:"waiter"===(null===c||void 0===c?void 0:c.role)?!(null===e||void 0===e||!e.isWork):void 0};L(!0),r.A.update(null===c||void 0===c?void 0:c.uuid,t).then((()=>{q.oR.success(g("successfully.updated"))})).finally((()=>{L(!1)}))},children:(0,N.jsxs)(b.A,{gutter:12,children:[(0,N.jsx)(x.A,{span:24,children:(0,N.jsx)(p.A.Item,{name:"avatar",label:g("avatar"),rules:[{required:!(null!==F&&void 0!==F&&F.length),message:g("required")}],children:(0,N.jsx)(S.A,{type:"restaurant/logo",imageList:F,setImageList:O,form:m,multiple:!1,name:"avatar"})})}),(0,N.jsx)(x.A,{span:12,children:(0,N.jsx)(p.A.Item,{name:"firstname",label:g("firstname"),rules:[{required:!0,message:g("required")},{type:"string",min:2,max:200,message:g("min.2.max.200.chars")}],children:(0,N.jsx)(y.A,{})})}),(0,N.jsx)(x.A,{span:12,children:(0,N.jsx)(p.A.Item,{name:"lastname",label:g("lastname"),rules:[{required:!0,message:g("required")},{type:"string",min:2,max:200,message:g("min.2.max.200.chars")}],children:(0,N.jsx)(y.A,{})})}),(0,N.jsx)(x.A,{span:12,children:(0,N.jsx)(p.A.Item,{label:g("phone"),name:"phone",rules:[{required:!z,message:g("required")}],children:(0,N.jsx)(j.A,{min:0,className:"w-100"})})}),(0,N.jsx)(x.A,{span:12,children:(0,N.jsx)(p.A.Item,{label:g("birthday"),name:"birthday",rules:[{required:!0,message:g("required")}],children:(0,N.jsx)(A.A,{className:"w-100",disabledDate:e=>h()().add(-18,"years")<=e,defaultPickerValue:h()().add(-18,"years")})})}),(0,N.jsx)(x.A,{span:12,children:(0,N.jsx)(p.A.Item,{label:g("gender"),name:"gender",rules:[{required:!0,message:g("required")}],children:(0,N.jsx)(f.A,{options:[{label:g("male"),value:"male",key:"male"},{label:g("female"),value:"female",key:"female"}],labelInValue:!0})})}),(0,N.jsx)(x.A,{span:12,children:(0,N.jsx)(p.A.Item,{label:g("email"),name:"email",rules:[{required:!z,message:g("required")},{type:"email",message:g("invalid.email")}],children:(0,N.jsx)(y.A,{type:"email",disabled:z})})}),"cook"===(null===c||void 0===c?void 0:c.role)&&(0,N.jsx)(x.A,{span:12,children:(0,N.jsx)(p.A.Item,{name:"kitchen",label:g("kitchen"),children:(0,N.jsx)(I.G,{fetchOptions:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const l={search:null!==e&&void 0!==e&&e.length?e:void 0,page:1,perPage:20,active:1};return M.A.getAll(l).then((e=>{var l;return null===e||void 0===e||null===(l=e.data)||void 0===l?void 0:l.map((e=>{var l;return{label:null===e||void 0===e||null===(l=e.translation)||void 0===l?void 0:l.title,value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id}}))}))},placeholder:g("select.kitchen")})})}),"deliveryman"===(null===c||void 0===c?void 0:c.role)&&(0,N.jsx)(x.A,{span:12,children:(0,N.jsx)(p.A.Item,{name:"table",label:g("table"),children:(0,N.jsx)(I.G,{fetchOptions:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const l={search:null!==e&&void 0!==e&&e.length?e:void 0,page:1,perPage:20,active:1};return _.A.getAll(l).then((e=>{var l;return null===e||void 0===e||null===(l=e.data)||void 0===l?void 0:l.map((e=>({label:null===e||void 0===e?void 0:e.name,value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id})))}))},placeholder:g("select.table")})})}),"waiter"===(null===c||void 0===c?void 0:c.role)&&(0,N.jsx)(x.A,{children:(0,N.jsx)(p.A.Item,{name:"isWork",label:g("is.work"),valuePropName:"checked",children:(0,N.jsx)(k.A,{})})}),(0,N.jsx)(x.A,{span:24,children:(0,N.jsx)(C.A,{type:"primary",htmlType:"submit",loading:W,children:g("save")})})]})})};var P=i(51359),F=i(70948);const O=e=>{var l,i;let{data:n}=e;const[a]=p.A.useForm(),{t:s}=(0,t.B)(),d=(0,u.wA)(),{activeMenu:v}=(0,u.d4)((e=>e.menu),u.bN),[c,g]=(0,o.useState)(null!==n&&void 0!==n&&null!==(l=n.delivery_man_delivery_zone)&&void 0!==l&&l.length?null===n||void 0===n||null===(i=n.delivery_man_delivery_zone)||void 0===i?void 0:i.map((e=>({lat:null===e||void 0===e?void 0:e[0],lng:null===e||void 0===e?void 0:e[1]}))):[]),[h,y]=(0,o.useState)(null),[j,A]=(0,o.useState)(!1);return(0,N.jsxs)(p.A,{layout:"vertical",form:a,onFinish:()=>{if(null===n||void 0===n||!n.id)return void q.oR.error(s("no.user.id"));if(c.length<3)return void q.oR.warning(s("place.selected.map"));if(!h)return void q.oR.warning(s("place.selected.map"));const e={user_id:null===n||void 0===n?void 0:n.id,address:c.map((e=>({0:e.lat,1:e.lng})))};A(!0),r.A.createAndUpdateDeliverymanZone(e).then((()=>{d((0,m.Ms)(v)),q.oR.success(s("successfully.updated"))})).finally((()=>{A(!1)}))},children:[(0,N.jsxs)(b.A,{gutter:12,children:[(0,N.jsx)(x.A,{span:12,children:(0,N.jsx)("img",{src:P,alt:s("map.gif"),style:{object:"contain"}})}),(0,N.jsx)(x.A,{span:24,children:(0,N.jsx)(F.A,{triangleCoords:c,settriangleCoords:g,setMerge:y})})]}),(0,N.jsx)(C.A,{type:"primary",htmlType:"submit",loading:j,className:"mt-4",children:s("save")})]})},{TabPane:W}=n.A,L=()=>{const{t:e}=(0,t.B)(),l=(0,s.s)(),i=(0,u.wA)(),{uuid:g}=(0,v.g)(),{activeMenu:p}=(0,u.d4)((e=>e.menu),u.bN),[b,x]=(0,o.useState)(l.get("tab")||"details"),[y,j]=(0,o.useState)({}),[A,f]=(0,o.useState)(!1);(0,o.useEffect)((()=>{k()}),[g]),(0,c.A)((()=>{p.refetch&&k()}),[p.refetch]);const k=()=>{g&&((e=>{f(!0),r.A.getById(e).then((e=>{var l,i,n,a;const t={...null===e||void 0===e?void 0:e.data,avatar:null!==e&&void 0!==e&&null!==(l=e.data)&&void 0!==l&&l.img?[(0,d.A)(null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i.img)]:[],birthday:null!==e&&void 0!==e&&null!==(n=e.data)&&void 0!==n&&n.birthday?h()(null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.birthday):null};j(t)})).finally((()=>{f(!1)}))})(g),i((0,m.km)(p)))};return(0,N.jsx)(a.A,{title:e("edit.user"),children:(0,N.jsxs)(n.A,{activeKey:b,onChange:e=>{x(e),l.set("tab",e)},tabPosition:"left",size:"small",children:[(0,N.jsx)(W,{tab:e("edit.user"),children:(0,N.jsx)(a.A,{loading:A,children:(0,N.jsx)(z,{data:y})})},"details"),"deliveryman"===(null===y||void 0===y?void 0:y.role)&&(0,N.jsx)(W,{tab:e("deliveryman.zone"),children:(0,N.jsx)(a.A,{loading:A,children:(0,N.jsx)(O,{data:y})})},"deliverymanzone")]})})},R=()=>(0,N.jsx)(L,{})},42634:()=>{},47992:(e,l,i)=>{"use strict";i.d(l,{G:()=>d});var n=i(9950),a=i(95491),t=i.n(a),o=i(99674),s=i(90650),r=i(44414);const d=e=>{let{fetchOptions:l,debounceTimeout:i=400,onClear:a,...d}=e;const[u,v]=(0,n.useState)(!1),[c,m]=(0,n.useState)([]),g=(0,n.useMemo)((()=>t()((e=>{m([]),v(!0),l(e).then((e=>{m(e),v(!1)}))}),i)),[l,i]);return(0,r.jsx)(o.A,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:g,onClear:()=>{g(""),a&&a()},notFoundContent:u?(0,r.jsx)(s.A,{size:"small"}):"no results",...d,options:c,onFocus:()=>{g("")}})}},51359:(e,l,i)=>{"use strict";e.exports=i.p+"static/media/map.f2e0b3013d676ba09c88.gif"},65820:(e,l,i)=>{"use strict";i.d(l,{s:()=>o});var n=i(13564),a=i(21215),t=i.n(a);const o=()=>{const e=(0,n.Zp)(),l=(0,n.zy)(),i=t().parse(l.search,{ignoreQueryPrefix:!0});return{values:i,set:(l,n)=>e({search:t().stringify({...i,[l]:n})}),reset:l=>{const n={...i};n[l]&&delete n[l],e({search:t().stringify({...n})})},clear:()=>e({search:t().stringify({})}),merge:l=>e({search:t().stringify({...i,...l})}),get:e=>i[e],setMultiple:l=>{const n={...i,...l};e({search:t().stringify(n)})},resetMultiple:l=>{const n={...i};l.forEach((e=>{n[e]&&delete n[e]})),e({search:t().stringify(n)})}}}},70948:(e,l,i)=>{"use strict";i.d(l,{A:()=>m});var n=i(97239),a=i(9950),t=i(52423),o=i(6566),s=i(83291),r=i(63620);const d=()=>{var e,l,i;const n=null===(e=s.M.getState())||void 0===e||null===(l=e.globalSettings)||void 0===l||null===(i=l.settings)||void 0===i?void 0:i.location;if(null!==n&&void 0!==n&&n.length){const e=null===n||void 0===n?void 0:n.split(",");return{lat:parseFloat(null===e||void 0===e?void 0:e[0]),lng:parseFloat(null===e||void 0===e?void 0:e[1])}}return{lat:r.it,lng:r.cz}};var u=i(44414);const v=(0,o.A)(),c=d(),m=(0,n.GoogleApiWrapper)({apiKey:v,libraries:["places"]})((e=>{var l,i;const[o,s]=(0,a.useState)(c),[r,d]=(0,a.useState)(e.triangleCoords?e.triangleCoords:[]),[v,m]=(0,a.useState)(!!e.triangleCoords),[g,h]=(0,a.useState)(null);e.setMerge(v);(0,a.useEffect)((()=>{h(!0)}),[]);const p=e.triangleCoords.map((e=>({lat:Number(e.lat||"0"),lng:Number(e.lng||"0")})));for(var b=new e.google.maps.LatLngBounds(o),x=0;x<p.length;x++)b.extend(p[x]);return(0,u.jsxs)("div",{className:"map-container",style:{height:500,width:"100%"},children:[(0,u.jsx)("button",{className:"map-button",type:"button",onClick:()=>{navigator.geolocation.getCurrentPosition((function(e){s({lat:e.coords.latitude,lng:e.coords.longitude})}))},children:(0,u.jsx)(t.uFi,{})}),(0,u.jsxs)(n.Map,{options:{minZoom:15,maxZoom:15},cursor:"pointer",onClick:(l,i,n)=>{h(!1);const{latLng:a}=n,t=a.lat(),o=a.lng();v?(d([]),e.settriangleCoords([{lat:t,lng:o}]),s({lat:t,lng:o}),m(!1)):e.settriangleCoords((e=>[...e,{lat:t,lng:o}]))},maxZoom:16,minZoom:2,google:e.google,initialCenter:c,center:o,onReady:function(e,l){l.setOptions({draggableCursor:"crosshair",draggingCursor:"grab"})},bounds:g&&b,className:"clickable",children:[null===(l=e.triangleCoords)||void 0===l?void 0:l.map(((l,i)=>(0,u.jsx)(n.Marker,{onClick:l=>(l=>{var i,n;m(!(null===e||void 0===e||!e.triangleCoords)),(null===(i=e.triangleCoords[0])||void 0===i?void 0:i.lat)===(null===(n=l.position)||void 0===n?void 0:n.lat)&&e.triangleCoords.length>1&&(d(e.triangleCoords),e.setLocation(e.triangleCoords),m(!0),h(!0))})(l),position:l,icon:{url:"https://upload.wikimedia.org/wikipedia/commons/9/94/Circle-image.svg",scaledSize:new e.google.maps.Size(10,10)},className:"marker"},i))),null!==r&&void 0!==r&&r.length?(0,u.jsx)(n.Polygon,{path:e.triangleCoords,strokeColor:"black",strokeOpacity:.8,strokeWeight:3,fillColor:"black",fillOpacity:.35},null===r||void 0===r?void 0:r.length):(0,u.jsx)(n.Polyline,{path:e.triangleCoords,strokeColor:"black",strokeOpacity:.8,strokeWeight:3,fillColor:"black",fillOpacity:.35},null===(i=e.triangleCoords)||void 0===i?void 0:i.length)]})]})}))}}]);