"use strict";(self.webpackChunkjumlajumla_dashboard=self.webpackChunkjumlajumla_dashboard||[]).push([[6600],{56600:(e,a,s)=>{s.r(a),s.d(a,{default:()=>I});var l=s(9950),r=s(3969),i=s(23263),n=s(87094),t=s(41988),m=s(55902),d=s(8724),c=s(25933),u=s(48538),o=s(12449),p=s(13564),h=s(51201),x=s(91854),A=s(74623),j=s(70030),g=s(62466),v=s(81446),_=s(16254),b=s(99016),f=s(62335),w=s(79406),q=s(44414);function I(){var e,a;const{t:s}=(0,j.B)(),I=(0,p.Zp)(),{id:y}=(0,p.g)(),N=(0,x.wA)(),[k]=r.A.useForm(),{activeMenu:E}=(0,x.d4)((e=>e.menu),x.bN),[S,F]=(0,l.useState)(!1),[P,C]=(0,l.useState)(!1),[O,V]=(0,l.useState)((null===E||void 0===E||null===(e=E.data)||void 0===e?void 0:e.image)||[]),[B,M]=(0,l.useState)(null===E||void 0===E||null===(a=E.data)||void 0===a?void 0:a.special);(0,l.useEffect)((()=>()=>{const e=k.getFieldsValue(!0);N((0,A.Ok)({activeMenu:E,data:{...E.data,...e}}))}),[]);return(0,l.useEffect)((()=>{E.refetch&&y&&(e=>{F(!0),h.A.getById(e).then((e=>{let a=e.data;V([(0,g.A)(a.img)]),M(a.special),k.setFieldsValue({...a,image:[(0,g.A)(a.img)],options:null===a||void 0===a?void 0:a.options.map((e=>{var a;return{label:null===(a=e.translation)||void 0===a?void 0:a.title,value:e.id}}))})})).finally((()=>{F(!1),N((0,A.km)(E))}))})(y)}),[E.refetch]),(0,q.jsx)(i.A,{title:s(y?"edit.parcel.type":"add.parcel.type"),children:S?(0,q.jsx)(v.A,{}):(0,q.jsxs)(r.A,{form:k,name:"parcel-type",layout:"vertical",initialValues:{...E.data},onFinish:e=>{var a;C(!0);const l={...e,special:Boolean(e.special),special_price:e.special_price||0,special_price_per_km:e.special_price_per_km||0,images:null===O||void 0===O?void 0:O.map((e=>e.name)),image:void 0,options:null===(a=e.options)||void 0===a?void 0:a.map((e=>e.value))},r="parcel-types";y?h.A.update(y,l).then((()=>{N((0,b.b)()),o.oR.success(s("successfully.updated")),N((0,A.EK)({...E,nextUrl:r})),I(`/${r}`)})).finally((()=>C(!1))):h.A.create(l).then((()=>{N((0,b.b)()),o.oR.success(s("successfully.created")),N((0,A.EK)({...E,nextUrl:r})),I(`/${r}`)})).finally((()=>C(!1)))},children:[(0,q.jsxs)(n.A,{gutter:12,children:[(0,q.jsx)(t.A,{span:12,children:(0,q.jsx)(r.A.Item,{label:s("title"),name:"type",rules:[{validator:(e,a)=>a?a&&""===(null===a||void 0===a?void 0:a.trim())?Promise.reject(new Error(s("no.empty.space"))):a&&(null===a||void 0===a?void 0:a.trim().length)<2?Promise.reject(new Error(s("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(s("required")))}],children:(0,q.jsx)(m.A,{})})}),(0,q.jsx)(t.A,{span:12,children:(0,q.jsx)(r.A.Item,{label:s("image"),name:"images",rules:[{validator:()=>0===(null===O||void 0===O?void 0:O.length)?Promise.reject(new Error(s("required"))):Promise.resolve()}],children:(0,q.jsx)(_.A,{type:"languages",imageList:O,setImageList:V,form:k,multiple:!1})})}),(0,q.jsx)(t.A,{span:12,children:(0,q.jsx)(r.A.Item,{label:s("start.price"),name:"price",rules:[{required:!0,message:s("required")}],children:(0,q.jsx)(d.A,{min:0,className:"w-100"})})}),(0,q.jsx)(t.A,{span:12,children:(0,q.jsx)(r.A.Item,{label:s("price.per.km"),name:"price_per_km",rules:[{required:!0,message:s("required")}],children:(0,q.jsx)(d.A,{min:0,className:"w-100"})})}),(0,q.jsx)(t.A,{span:12,children:(0,q.jsx)(r.A.Item,{label:s("min_width"),name:"min_width",rules:[{required:!0,message:s("required")}],children:(0,q.jsx)(d.A,{min:0,max:32678,className:"w-100",addonAfter:"sm"})})}),(0,q.jsx)(t.A,{span:12,children:(0,q.jsx)(r.A.Item,{label:s("max_width"),name:"max_width",rules:[{required:!0,message:s("required")}],children:(0,q.jsx)(d.A,{min:0,max:32678,className:"w-100",addonAfter:"sm"})})}),(0,q.jsx)(t.A,{span:12,children:(0,q.jsx)(r.A.Item,{label:s("min_height"),name:"min_height",rules:[{required:!0,message:s("required")}],children:(0,q.jsx)(d.A,{min:0,max:32678,className:"w-100",addonAfter:"sm"})})}),(0,q.jsx)(t.A,{span:12,children:(0,q.jsx)(r.A.Item,{label:s("max_height"),name:"max_height",rules:[{required:!0,message:s("required")}],children:(0,q.jsx)(d.A,{min:0,max:32678,className:"w-100",addonAfter:"sm"})})}),(0,q.jsx)(t.A,{span:12,children:(0,q.jsx)(r.A.Item,{label:s("min_length"),name:"min_length",rules:[{required:!0,message:s("required")}],children:(0,q.jsx)(d.A,{min:0,max:32678,className:"w-100",addonAfter:"sm"})})}),(0,q.jsx)(t.A,{span:12,children:(0,q.jsx)(r.A.Item,{label:s("max_length"),name:"max_length",rules:[{required:!0,message:s("required")}],children:(0,q.jsx)(d.A,{min:0,max:32678,className:"w-100",addonAfter:"sm"})})}),(0,q.jsx)(t.A,{span:12,children:(0,q.jsx)(r.A.Item,{label:s("min_weight"),name:"min_g",rules:[{required:!0,message:s("required")}],children:(0,q.jsx)(d.A,{min:0,max:32678,className:"w-100",addonAfter:"gramm"})})}),(0,q.jsx)(t.A,{span:12,children:(0,q.jsx)(r.A.Item,{label:s("max_weight"),name:"max_g",rules:[{required:!0,message:s("required")}],children:(0,q.jsx)(d.A,{min:0,max:2147e6,className:"w-100",addonAfter:"gramm"})})}),(0,q.jsx)(t.A,{span:12,children:(0,q.jsx)(r.A.Item,{label:s("options"),name:"options",children:(0,q.jsx)(w.a,{fetchOptions:async e=>f.A.getAll({search:e}).then((e=>{let{data:a}=e;return a.map((e=>{var a;return{label:null===(a=e.translation)||void 0===a?void 0:a.title,value:e.id}}))})),mode:"multiple"})})}),(0,q.jsx)(t.A,{span:12,children:(0,q.jsx)(r.A.Item,{label:s("max.range"),name:"max_range",children:(0,q.jsx)(d.A,{min:0,className:"w-100",addonAfter:"km"})})}),(0,q.jsx)(t.A,{span:24,children:(0,q.jsx)(r.A.Item,{label:s("special"),name:"special",valuePropName:"checked",children:(0,q.jsx)(c.A,{onChange:e=>M(e)})})}),!!B&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(t.A,{span:12,children:(0,q.jsx)(r.A.Item,{label:s("start.price"),name:"special_price",rules:[{required:!0,message:s("required")}],children:(0,q.jsx)(d.A,{min:0,className:"w-100"})})}),(0,q.jsx)(t.A,{span:12,children:(0,q.jsx)(r.A.Item,{label:s("price.per.km"),name:"special_price_per_km",rules:[{required:!0,message:s("required")}],children:(0,q.jsx)(d.A,{min:0,className:"w-100"})})})]})]}),(0,q.jsx)(u.A,{type:"primary",htmlType:"submit",loading:P,children:s("save")})]})})}},79406:(e,a,s)=>{s.d(a,{a:()=>d});var l=s(9950),r=s(95491),i=s.n(r),n=s(99674),t=s(90650),m=s(44414);const d=e=>{let{fetchOptions:a,debounceTimeout:s=400,refetch:r=!1,...d}=e;const[c,u]=(0,l.useState)(!1),[o,p]=(0,l.useState)([]),h=(0,l.useMemo)((()=>i()((e=>{p([]),u(!0),a(e).then((e=>{p(e),u(!1)}))}),s)),[a,s]);return(0,m.jsx)(n.A,{showSearch:!0,allowClear:!0,labelInValue:!0,onClear:()=>h(""),filterOption:!1,onSearch:h,notFoundContent:c?(0,m.jsx)(t.A,{size:"small"}):"no results",...d,options:o,onFocus:()=>{h("")}})}}}]);