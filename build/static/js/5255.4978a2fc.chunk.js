"use strict";(self.webpackChunkjumlajumla_dashboard=self.webpackChunkjumlajumla_dashboard||[]).push([[5255],{75255:(e,a,t)=>{t.r(a),t.d(a,{default:()=>S});var l=t(9950),r=t(99674),n=t(12916),i=t(48538),s=t(23263),c=t(55902),d=t(12203),o=t(32645),g=t(3969),u=t(87094),h=t(41988),p=t(20978),m=t(24513),v=t(89379);const x={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 632H136v-39.9l138.5-164.3 150.1 178L658.1 489 888 761.6V792zm0-129.8L664.2 396.8c-3.2-3.8-9-3.8-12.2 0L424.6 666.4l-144-170.7c-3.2-3.8-9-3.8-12.2 0L136 652.7V232h752v430.2zM304 456a88 88 0 100-176 88 88 0 000 176zm0-116c15.5 0 28 12.5 28 28s-12.5 28-28 28-28-12.5-28-28 12.5-28 28-28z"}}]},name:"picture",theme:"outlined"};var A=t(25085),j=function(e,a){return l.createElement(A.A,(0,v.A)((0,v.A)({},e),{},{ref:a,icon:x}))};j.displayName="PictureOutlined";const b=l.forwardRef(j);var y=t(82371),_=t(44414);const{Option:f}=r.A,S=()=>{const[e,a]=(0,l.useState)([]),[t,v]=(0,l.useState)(!0),[x,A]=(0,l.useState)(""),[j,f]=(0,l.useState)({current:1,pageSize:10,total:0}),[S,w]=(0,l.useState)(!1),[I,k]=(0,l.useState)(null),[C,z]=(0,l.useState)({calories:"",ingredient_tags:[],allergen_flags:[],representative_image:""});(0,l.useEffect)((()=>{E()}),[j.current,x]);const E=async()=>{v(!0);try{const e={page:j.current,per_page:j.pageSize,search:x},t=await y.A.get("/api/v1/dashboard/admin/products",{params:e});a(t.data.data||[]),f({...j,total:t.data.total})}catch(e){console.error("Error fetching products:",e)}finally{v(!1)}},F=e=>{z({...C,[e.target.name]:e.target.value})},L=(e,a)=>{z({...C,[a]:e})},P=[{title:"ID",dataIndex:"id",key:"id",width:60},{title:"Product Name",dataIndex:"name",key:"name"},{title:"Calories",dataIndex:"calories",key:"calories",render:e=>e||"-"},{title:"Ingredients",dataIndex:"ingredient_tags",key:"ingredient_tags",render:e=>(0,_.jsx)(_.Fragment,{children:e&&e.length>0?e.map((e=>(0,_.jsx)(n.A,{color:"blue",children:e},e))):"-"})},{title:"Allergens",dataIndex:"allergen_flags",key:"allergen_flags",render:e=>(0,_.jsx)(_.Fragment,{children:e&&e.length>0?e.map((e=>(0,_.jsx)(n.A,{color:"orange",children:e},e))):"-"})},{title:"Popularity Score",dataIndex:"popularity_score",key:"popularity_score",render:e=>e||0},{title:"Actions",key:"actions",render:(e,a)=>(0,_.jsx)(i.A,{type:"primary",icon:(0,_.jsx)(m.A,{}),size:"small",onClick:()=>{return k(e=a),z({calories:e.calories||"",ingredient_tags:e.ingredient_tags||[],allergen_flags:e.allergen_flags||[],representative_image:e.representative_image||""}),void w(!0);var e}})}];return(0,_.jsxs)("div",{children:[(0,_.jsx)("h2",{className:"mb-4",children:"AI Product Metadata"}),(0,_.jsxs)(s.A,{className:"mb-4",children:[(0,_.jsx)("div",{style:{marginBottom:16},children:(0,_.jsx)(c.A.Search,{placeholder:"Search products...",value:x,onChange:e=>{A(e.target.value),f({...j,current:1})},onSearch:()=>E(),style:{width:300}})}),(0,_.jsx)(d.A,{columns:P,dataSource:e,rowKey:"id",loading:t,pagination:{current:j.current,pageSize:j.pageSize,total:j.total,onChange:e=>{f({...j,current:e})}}})]}),(0,_.jsx)(o.A,{title:`Edit AI Metadata - ${null===I||void 0===I?void 0:I.name}`,open:S,onCancel:()=>w(!1),onOk:async()=>{try{const t={calories:C.calories,ingredient_tags:C.ingredient_tags,allergen_flags:C.allergen_flags,representative_image:C.representative_image};await y.A.put(`/api/v1/dashboard/admin/ai-assistant/product-metadata/${I.id}`,t),a(e.map((e=>e.id===I.id?{...e,...t}:e))),w(!1)}catch(t){console.error("Error updating product metadata:",t)}},width:800,children:(0,_.jsxs)(g.A,{layout:"vertical",children:[(0,_.jsxs)(u.A,{gutter:16,children:[(0,_.jsx)(h.A,{span:12,children:(0,_.jsx)(g.A.Item,{label:"Calories",children:(0,_.jsx)(c.A,{type:"number",name:"calories",placeholder:"Enter calories per serving",value:C.calories,onChange:F})})}),(0,_.jsx)(h.A,{span:12,children:(0,_.jsxs)(g.A.Item,{label:"Representative Image URL",children:[(0,_.jsx)(c.A,{name:"representative_image",placeholder:"Image URL",value:C.representative_image,onChange:F,addonAfter:(0,_.jsx)(i.A,{type:"text",icon:(0,_.jsx)(b,{}),onClick:async()=>{try{const e=await y.A.post(`/api/v1/dashboard/admin/ai-assistant/generate-product-image/${I.id}`);e.data&&e.data.image_url&&z({...C,representative_image:e.data.image_url})}catch(e){console.error("Error generating product image:",e)}}})}),(0,_.jsx)("div",{className:"text-muted",style:{fontSize:"12px"},children:"Click the icon to generate an AI image (if available)"})]})})]}),(0,_.jsxs)(u.A,{gutter:16,children:[(0,_.jsx)(h.A,{span:12,children:(0,_.jsx)(g.A.Item,{label:"Ingredient Tags",children:(0,_.jsx)(r.A,{mode:"multiple",placeholder:"Select or type ingredients...",value:C.ingredient_tags,onChange:e=>L(e,"ingredient_tags"),style:{width:"100%"},options:[{value:"vegetarian",label:"Vegetarian"},{value:"vegan",label:"Vegan"},{value:"gluten-free",label:"Gluten Free"},{value:"dairy-free",label:"Dairy Free"},{value:"sugar-free",label:"Sugar Free"},{value:"organic",label:"Organic"},{value:"low-carb",label:"Low Carb"},{value:"high-protein",label:"High Protein"}],allowClear:!0})})}),(0,_.jsx)(h.A,{span:12,children:(0,_.jsx)(g.A.Item,{label:"Allergen Flags",children:(0,_.jsx)(r.A,{mode:"multiple",placeholder:"Select allergens...",value:C.allergen_flags,onChange:e=>L(e,"allergen_flags"),style:{width:"100%"},options:[{value:"peanut",label:"Peanuts"},{value:"tree-nuts",label:"Tree Nuts"},{value:"milk",label:"Milk"},{value:"egg",label:"Eggs"},{value:"wheat",label:"Wheat"},{value:"soy",label:"Soy"},{value:"fish",label:"Fish"},{value:"shellfish",label:"Shellfish"},{value:"sesame",label:"Sesame"}],allowClear:!0})})})]}),C.representative_image&&(0,_.jsx)(u.A,{children:(0,_.jsx)(h.A,{span:24,style:{textAlign:"center"},children:(0,_.jsx)(p.A,{src:C.representative_image,alt:"Product",style:{maxHeight:"200px"}})})})]})})]})}}}]);