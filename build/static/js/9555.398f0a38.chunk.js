"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[9555],{29555:(t,e,i)=>{i.r(e),i.d(e,{default:()=>b});var a=i(47313),l=i(97890),n=i(23560),s=i(83999),o=i(10976),r=i(77181),d=i(72652),c=i(97421),u=i(2717),v=i(90954),g=i(24511),p=i(73431),h=i(10596),m=i(12545),f=i(46417);const{Step:_}=s.Z,b=()=>{var t,e,i;const{t:b}=(0,g.$)(),{activeMenu:y}=(0,u.v9)((t=>t.menu),u.wU),{id:j}=(0,l.UO)(),k=(0,u.I0)(),{defaultLang:x}=(0,u.v9)((t=>t.formLang),u.wU),[S,Z]=(0,a.useState)((null===(t=y.data)||void 0===t?void 0:t.step)||0),w=t=>({name:t,url:c.bV+t}),[F,O]=(0,a.useState)(null!==(e=y.data)&&void 0!==e&&e.galleries[0]?[w(y.data.galleries[0].path)]:[]),[U,V]=(0,a.useState)(null!==(i=y.data)&&void 0!==i&&i.galleries[1]?[w(y.data.galleries[1].path)]:[]),I=()=>{Z(S+1)},M=()=>{Z(S-1)},[N]=o.Z.useForm(),$=(0,l.s0)(),[q,A]=(0,a.useState)(!1),[B,C]=(0,a.useState)(!1);(0,a.useEffect)((()=>()=>{const t=N.getFieldsValue(!0);k((0,v.nc)({activeMenu:y,data:t}))}),[]);const E=[...F,...U];return(0,a.useEffect)((()=>{y.refetch&&(t=>{A(!0),m.Z.getById(t).then((t=>{var e,i,a;let l=t.data;N.setFieldsValue({...l,title:{[x]:l.translation.title},description:{[x]:l.translation.description},instruction:Object.assign({},...l.instructions.map((t=>({[t.locale]:t.title})))),ingredient:Object.assign({},...l.ingredients.map((t=>({[t.locale]:t.title})))),nutrition:null===(e=l.nutritions)||void 0===e?void 0:e.map((t=>{var e;return{percentage:null===t||void 0===t||null===(e=t.percentage)||void 0===e?void 0:e.toString(),weight:t.weight,...Object.assign({},...t.translations.flatMap((t=>({[t.locale]:t.title}))))}})),category_id:{value:l.category.id,label:null===(i=l.category.translation)||void 0===i?void 0:i.title},shop_id:{value:l.shop.id,label:null===(a=l.shop.translation)||void 0===a?void 0:a.title},stocks:l.stocks.map((t=>{var e,i;return{stock_id:{value:t.id,label:null===t||void 0===t||null===(e=t.product)||void 0===e||null===(i=e.translation)||void 0===i?void 0:i.title},...t}}))}),O([w(l.galleries[0].path)]),V([w(l.galleries[1].path)])})).finally((()=>{A(!1),k((0,v.A_)(y))}))})(j)}),[y.refetch]),(0,f.jsx)(r.Z,{title:b("edit.recepe"),extra:(0,f.jsx)(p.Z,{}),children:q?(0,f.jsx)("div",{className:"d-flex justify-content-center align-items-center",children:(0,f.jsx)(d.Z,{size:"large",className:"py-5"})}):(0,f.jsxs)(o.Z,{layout:"vertical",onFinish:t=>{var e;N.validateFields();const i={...t,category_id:t.category_id.value,images:E.map((t=>t.name)),shop_id:t.shop_id.value,active_time:t.active_time.toString(),total_time:t.total_time.toString(),nutrition:t.nutrition.map((t=>({...t,percentage:String(t.percentage),weight:String(t.weight)}))),stocks:null===(e=t.stocks)||void 0===e?void 0:e.map((t=>({min_quantity:t.min_quantity,stock_id:t.stock_id.value})))};C(!0);const a="catalog/recept";m.Z.update(j,i).then((()=>{n.Am.success(b("successfully.updated")),$(`/${a}`),k((0,v.ph)({...y,nextUrl:a}))})).finally((()=>C(!1)))},form:N,initialValues:{active:!0,...y.data},children:[(0,f.jsx)(s.Z,{current:S,children:h.S.map((t=>(0,f.jsx)(_,{title:b(t.title)},t.title)))}),h.S.map((t=>{const e=t.content;return(0,f.jsx)("div",{className:`steps-content ${t.step!==S+1&&"hidden"}`,children:(0,f.jsx)(e,{next:I,prev:M,loading:B,image:F,setImage:O,back:U,setBack:V})},t.title)}))]})})}}}]);