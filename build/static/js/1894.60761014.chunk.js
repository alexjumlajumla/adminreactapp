"use strict";(self.webpackChunkjumlajumla_dashboard=self.webpackChunkjumlajumla_dashboard||[]).push([[1894],{25183:(e,l,s)=>{s.d(l,{A:()=>j});var t=s(9950),a=s(3969),n=s(87094),u=s(41988),i=s(8724),o=s(87864),r=s(25933),d=s(48538),c=s(59051),m=s.n(c),v=s(70030),h=s(91854),p=s(67231),x=s(80905),b=s(44414);function j(e){let{form:l,handleSubmit:s}=e;const{t:c}=(0,v.B)(),{activeMenu:j}=(0,h.d4)((e=>e.menu),h.bN),[f,A]=(0,t.useState)({bonusStock:!1}),[g,_]=(0,t.useState)(!1);return(0,b.jsxs)(a.A,{name:"bonus-form",layout:"vertical",onFinish:e=>{_(!0),s(e).finally((()=>_(!1)))},form:l,initialValues:{status:!0,...j.data,...(()=>{var e,l;if(null===(e=j.data)||void 0===e||!e.expired_at)return{};const s=JSON.parse(null===(l=j.data)||void 0===l?void 0:l.expired_at);return{expired_at:m()(s,"HH:mm:ss")}})()},className:"d-flex flex-column h-100",children:[(0,b.jsxs)(n.A,{gutter:12,children:[(0,b.jsx)(u.A,{span:12,children:(0,b.jsx)(a.A.Item,{label:c("order_amount"),name:"value",rules:[{required:!0,message:c("required")},{type:"number",min:1,message:c("min.1")}],children:(0,b.jsx)(i.A,{className:"w-100"})})}),(0,b.jsx)(u.A,{span:12,children:(0,b.jsx)(a.A.Item,{label:c("bonus.product.stock"),name:"bonus_stock_id",rules:[{required:!0,message:c("required")}],children:(0,b.jsx)(x.j,{fetchOptions:function(e){let{page:l,search:s}=e;const t={active:1,status:"published",page:l,search:null!==s&&void 0!==s&&s.length?s:void 0};return p.A.getStock(t).then((e=>{var l,s;return A({...f,bonusStock:(null===e||void 0===e||null===(l=e.meta)||void 0===l?void 0:l.current_page)<=(null===e||void 0===e||null===(s=e.meta)||void 0===s?void 0:s.last_page)}),e.data.map((e=>{var l,s,t,a,n;return{label:`${null===e||void 0===e||null===(l=e.product)||void 0===l||null===(s=l.translation)||void 0===s?void 0:s.title} ${null!==e&&void 0!==e&&null!==(t=e.extras)&&void 0!==t&&t.length?` => ${null===e||void 0===e||null===(a=e.extras)||void 0===a||null===(n=a.map((e=>{var l,s;return`${null===e||void 0===e||null===(l=e.group)||void 0===l||null===(s=l.translation)||void 0===s?void 0:s.title}: ${null===e||void 0===e?void 0:e.value}`})))||void 0===n?void 0:n.join(", ")}`:""}`,value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id}}))}))},hasMore:null===f||void 0===f?void 0:f.bonusStock,allowClear:!1})})}),(0,b.jsx)(u.A,{span:12,children:(0,b.jsx)(a.A.Item,{label:c("bonus.product.quantity"),name:"bonus_quantity",rules:[{required:!0,message:c("required")},{type:"number",min:1,message:c("min.1")}],children:(0,b.jsx)(i.A,{className:"w-100"})})}),(0,b.jsx)(u.A,{span:12,children:(0,b.jsx)(a.A.Item,{name:"expired_at",label:c("expired.at"),rules:[{required:!0,message:c("required")}],children:(0,b.jsx)(o.A,{className:"w-100",placeholder:"",disabledDate:e=>m()().add(-1,"days")>=e})})}),(0,b.jsx)(u.A,{span:12,children:(0,b.jsx)(a.A.Item,{label:c("active"),name:"status",valuePropName:"checked",children:(0,b.jsx)(r.A,{})})})]}),(0,b.jsx)("div",{className:"flex-grow-1 d-flex flex-column justify-content-end",children:(0,b.jsx)("div",{className:"pb-5",children:(0,b.jsx)(d.A,{type:"primary",htmlType:"submit",loading:g,children:c("submit")})})})]})}},41894:(e,l,s)=>{s.r(l),s.d(l,{default:()=>b});var t=s(9950),a=s(13564),n=s(12449),u=s(3969),i=s(23263),o=s(91854),r=s(74623),d=s(70030),c=s(59051),m=s.n(c),v=s(58358),h=s(39095),p=s(25183),x=s(44414);const b=()=>{const{t:e}=(0,d.B)(),{activeMenu:l}=(0,o.d4)((e=>e.menu),o.bN),s=(0,o.wA)(),[c]=u.A.useForm(),b=(0,a.Zp)(),{myShop:j}=(0,o.d4)((e=>e.myShop),o.bN);(0,t.useEffect)((()=>()=>{const e=c.getFieldsValue(!0);e.expired_at=JSON.stringify(null===e||void 0===e?void 0:e.expired_at),s((0,r.Ok)({activeMenu:l,data:e}))}),[]);return(0,x.jsx)(i.A,{title:e("add.bonus"),className:"h-100",children:(0,x.jsx)(p.A,{form:c,handleSubmit:t=>{const a={expired_at:m()(t.expired_at).format("YYYY-MM-DD"),status:t.status,type:"sum",value:t.value,bonus_stock_id:t.bonus_stock_id.value,bonus_quantity:t.bonus_quantity,bonusable_id:j.id},u="seller/bonus/shop";return h.A.create(a).then((()=>{n.oR.success(e("successfully.created")),(0,o.vA)((()=>{s((0,r.EK)({...l,nextUrl:u})),s((0,v.S)({}))})),b(`/${u}`)}))}})})}},80905:(e,l,s)=>{s.d(l,{j:()=>r});var t=s(9950),a=s(95491),n=s.n(a),u=s(99674),i=s(90650),o=s(44414);const r=e=>{let{fetchOptions:l,debounceTimeout:s=400,hasMore:a,refetchOnFocus:r=!1,...d}=e;const[c,m]=(0,t.useState)(!1),[v,h]=(0,t.useState)([]),[p,x]=(0,t.useState)(!1),[b,j]=(0,t.useState)(null),[f,A]=(0,t.useState)(1),g=(0,t.useMemo)((()=>n()((e=>{h([]),j(e),m(!0),l({search:e}).then((e=>{h(e),A(2),m(!1)})).finally((()=>x(!1)))}),s)),[l,s,f]);return(0,o.jsxs)(u.A,{showSearch:!0,allowClear:!0,onPopupScroll:async e=>{const s=e.target;p||s.scrollTop+s.offsetHeight!==s.scrollHeight||a&&(x(!0),l({search:b,page:f}).then((e=>{A((e=>e+1)),h([...v,...e])})).finally((()=>x(!1))))},labelInValue:!0,filterOption:!1,onSearch:g,notFoundContent:c?(0,o.jsx)(i.A,{size:"small"}):"no results",onFocus:()=>{r?g(""):null!==v&&void 0!==v&&v.length||g("")},...d,children:[v.map(((e,l)=>(0,o.jsx)(u.A.Option,{value:e.value,children:e.label},l))),p&&(0,o.jsx)(u.A.Option,{children:(0,o.jsx)(i.A,{size:"small"})})]})}}}]);