"use strict";(self.webpackChunkjumlajumla_dashboard=self.webpackChunkjumlajumla_dashboard||[]).push([[218],{4399:(e,t,a)=>{a.d(t,{A:()=>r});var n=a(89379),l=a(9950);const o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M117 368h231v64H117zm559 0h241v64H676zm-264 0h200v64H412zm0 224h200v64H412zm264 0h241v64H676zm-559 0h231v64H117zm295-160V179h-64v666h64V592zm264-64V179h-64v666h64V432z"}}]},name:"borderless-table",theme:"outlined"};var s=a(25085),i=function(e,t){return l.createElement(s.A,(0,n.A)((0,n.A)({},e),{},{ref:t,icon:o}))};i.displayName="BorderlessTableOutlined";const r=l.forwardRef(i)},8297:(e,t,a)=>{a.d(t,{A:()=>r});var n=a(9950),l=a(55902),o=a(41397),s=a(60767),i=a(44414);function r(e){let{handleChange:t,defaultValue:a,resetSearch:r,...d}=e;const[c,u]=(0,n.useState)(a),v=(0,n.useMemo)((()=>(0,o.debounce)((e=>{t(e)}),800)),[t]);return(0,n.useEffect)((()=>{u(a)}),[r,a]),(0,i.jsx)(l.A,{value:c,onChange:e=>{u(e.target.value),v(e.target.value)},prefix:(0,i.jsx)(s.A,{}),...d})}},14691:(e,t,a)=>{a.d(t,{A:()=>m});var n=a(58168),l=a(64467),o=a(80045),s=a(89379),i=a(23029),r=a(92901),d=a(85501),c=a(29426),u=a(9950),v=a(48383),p=a.n(v),h=function(e){(0,d.A)(a,e);var t=(0,c.A)(a);function a(e){var n;(0,i.A)(this,a),(n=t.call(this,e)).handleChange=function(e){var t=n.props,a=t.disabled,l=t.onChange;a||("checked"in n.props||n.setState({checked:e.target.checked}),l&&l({target:(0,s.A)((0,s.A)({},n.props),{},{checked:e.target.checked}),stopPropagation:function(){e.stopPropagation()},preventDefault:function(){e.preventDefault()},nativeEvent:e.nativeEvent}))},n.saveInput=function(e){n.input=e};var l="checked"in e?e.checked:e.defaultChecked;return n.state={checked:l},n}return(0,r.A)(a,[{key:"focus",value:function(){this.input.focus()}},{key:"blur",value:function(){this.input.blur()}},{key:"render",value:function(){var e,t=this.props,a=t.prefixCls,s=t.className,i=t.style,r=t.name,d=t.id,c=t.type,v=t.disabled,h=t.readOnly,m=t.tabIndex,f=t.onClick,x=t.onFocus,y=t.onBlur,g=t.onKeyDown,A=t.onKeyPress,b=t.onKeyUp,j=t.autoFocus,C=t.value,k=t.required,w=(0,o.A)(t,["prefixCls","className","style","name","id","type","disabled","readOnly","tabIndex","onClick","onFocus","onBlur","onKeyDown","onKeyPress","onKeyUp","autoFocus","value","required"]),M=Object.keys(w).reduce((function(e,t){return"aria-"!==t.substr(0,5)&&"data-"!==t.substr(0,5)&&"role"!==t||(e[t]=w[t]),e}),{}),_=this.state.checked,S=p()(a,s,(e={},(0,l.A)(e,"".concat(a,"-checked"),_),(0,l.A)(e,"".concat(a,"-disabled"),v),e));return u.createElement("span",{className:S,style:i},u.createElement("input",(0,n.A)({name:r,id:d,type:c,required:k,readOnly:h,disabled:v,tabIndex:m,className:"".concat(a,"-input"),checked:!!_,onClick:f,onFocus:x,onBlur:y,onKeyUp:b,onKeyDown:g,onKeyPress:A,onChange:this.handleChange,autoFocus:j,ref:this.saveInput,value:C},M)),u.createElement("span",{className:"".concat(a,"-inner")}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return"checked"in e?(0,s.A)((0,s.A)({},t),{},{checked:e.checked}):null}}]),a}(u.Component);h.defaultProps={prefixCls:"rc-checkbox",className:"",style:{},type:"checkbox",defaultChecked:!1,onFocus:function(){},onBlur:function(){},onChange:function(){},onKeyDown:function(){},onKeyPress:function(){},onKeyUp:function(){}};const m=h},17811:(e,t,a)=>{a.d(t,{Ay:()=>I});var n=a(64467),l=a(58168),o=a(9950),s=a(14691),i=a(48383),r=a.n(i),d=a(41929),c=a(77643),u=a(12578),v=o.createContext(null),p=v.Provider;const h=v;var m=o.createContext(null),f=m.Provider,x=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var l=0;for(n=Object.getOwnPropertySymbols(e);l<n.length;l++)t.indexOf(n[l])<0&&Object.prototype.propertyIsEnumerable.call(e,n[l])&&(a[n[l]]=e[n[l]])}return a},y=function(e,t){var a,i=o.useContext(h),v=o.useContext(m),p=o.useContext(u.QO),f=p.getPrefixCls,y=p.direction,g=o.useRef(),A=(0,d.K4)(t,g),b=(0,o.useContext)(c.$W).isFormItemInput,j=e.prefixCls,C=e.className,k=e.children,w=e.style,M=x(e,["prefixCls","className","children","style"]),_=f("radio",j),S="button"===((null===i||void 0===i?void 0:i.optionType)||v)?"".concat(_,"-button"):_,O=(0,l.A)({},M);i&&(O.name=i.name,O.onChange=function(t){var a,n;null===(a=e.onChange)||void 0===a||a.call(e,t),null===(n=null===i||void 0===i?void 0:i.onChange)||void 0===n||n.call(i,t)},O.checked=e.value===i.value,O.disabled=e.disabled||i.disabled);var D=r()("".concat(S,"-wrapper"),(a={},(0,n.A)(a,"".concat(S,"-wrapper-checked"),O.checked),(0,n.A)(a,"".concat(S,"-wrapper-disabled"),O.disabled),(0,n.A)(a,"".concat(S,"-wrapper-rtl"),"rtl"===y),(0,n.A)(a,"".concat(S,"-wrapper-in-form-item"),b),a),C);return o.createElement("label",{className:D,style:w,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave},o.createElement(s.A,(0,l.A)({},O,{type:"radio",prefixCls:S,ref:A})),void 0!==k?o.createElement("span",null,k):null)},g=o.forwardRef(y);g.displayName="Radio";const A=g;var b=a(5544),j=a(71207),C=a(87126),k=a(27373),w=o.forwardRef((function(e,t){var a=o.useContext(u.QO),s=a.getPrefixCls,i=a.direction,d=o.useContext(C.A),c=(0,j.A)(e.defaultValue,{value:e.value}),v=(0,b.A)(c,2),h=v[0],m=v[1];return o.createElement(p,{value:{onChange:function(t){var a=h,n=t.target.value;"value"in e||m(n);var l=e.onChange;l&&n!==a&&l(t)},value:h,disabled:e.disabled,name:e.name,optionType:e.optionType}},function(){var a,c=e.prefixCls,u=e.className,v=void 0===u?"":u,p=e.options,m=e.buttonStyle,f=void 0===m?"outline":m,x=e.disabled,y=e.children,g=e.size,b=e.style,j=e.id,C=e.onMouseEnter,w=e.onMouseLeave,M=s("radio",c),_="".concat(M,"-group"),S=y;p&&p.length>0&&(S=p.map((function(e){return"string"===typeof e||"number"===typeof e?o.createElement(A,{key:e.toString(),prefixCls:M,disabled:x,value:e,checked:h===e},e):o.createElement(A,{key:"radio-group-value-options-".concat(e.value),prefixCls:M,disabled:e.disabled||x,value:e.value,checked:h===e.value,style:e.style},e.label)})));var O=g||d,D=r()(_,"".concat(_,"-").concat(f),(a={},(0,n.A)(a,"".concat(_,"-").concat(O),O),(0,n.A)(a,"".concat(_,"-rtl"),"rtl"===i),a),v);return o.createElement("div",(0,l.A)({},(0,k.A)(e),{className:D,style:b,onMouseEnter:C,onMouseLeave:w,id:j,ref:t}),S)}())}));const M=o.memo(w);var _=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var l=0;for(n=Object.getOwnPropertySymbols(e);l<n.length;l++)t.indexOf(n[l])<0&&Object.prototype.propertyIsEnumerable.call(e,n[l])&&(a[n[l]]=e[n[l]])}return a},S=function(e,t){var a=o.useContext(u.QO).getPrefixCls,n=e.prefixCls,s=_(e,["prefixCls"]),i=a("radio",n);return o.createElement(f,{value:"button"},o.createElement(A,(0,l.A)({prefixCls:i},s,{type:"radio",ref:t})))};const O=o.forwardRef(S);var D=A;D.Button=O,D.Group=M;const I=D},26714:(e,t,a)=>{a.d(t,{A:()=>g});var n=a(9950),l=a(48946),o=a(39362),s=a.n(o),i=a(81446),r=a(23263),d=a(32645),c=a(48538),u=a(87094),v=a(41988),p=a(70030),h=a(29949),m=a(38310),f=a(13564),x=a(44414);const y=r.A.Meta,g=e=>{let{id:t,handleCancel:a}=e;const[o,g]=(0,n.useState)(null),{t:A}=(0,p.B)(),b=(0,f.Zp)();return(0,x.jsx)(x.Fragment,{children:o?(0,x.jsx)(i.A,{}):(0,x.jsx)(d.A,{visible:!!t,title:A("selected.download"),closable:!1,handleCancel:a,footer:[(0,x.jsx)(c.A,{type:"default",onClick:a,children:A("cancel")},"cancelBtn")],children:(0,x.jsxs)(u.A,{children:[(0,x.jsx)(v.A,{span:12,children:(0,x.jsx)(r.A,{title:A("download.pdf"),onClick:()=>function(e){g(!0),l.A.orderExport(e).then((t=>{s()(t,`invoice_${e}.pdf`,"application/pdf"),a()})).finally((()=>g(!1)))}(t),className:"text-center cursor-pointer",children:(0,x.jsx)(y,{className:"d-flex align-items-center justify-content-center",title:(0,x.jsx)(h.yos,{size:80})})})}),(0,x.jsx)(v.A,{span:12,children:(0,x.jsx)(r.A,{title:A("download.check"),onClick:()=>(e=>{b(`/orders/generate-invoice/${e}`)})(t),className:"text-center cursor-pointer",children:(0,x.jsx)(y,{className:"d-flex align-items-center justify-content-center",title:(0,x.jsx)(m.TBA,{size:85})})})})]})})})}},48946:(e,t,a)=>{a.d(t,{A:()=>l});var n=a(82371);const l={orderExport:(e,t)=>n.A.get(`dashboard/user/export/order/${e}/pdf`,{params:t,responseType:"blob"})}},52864:(e,t,a)=>{a.d(t,{A:()=>x});var n=a(3969),l=a(87094),o=a(41988),s=a(99674),i=a(40895),r=a(80737),d=a(48538),c=a(70030),u=a(80415),v=a(9950),p=a(23758),h=a(91854),m=a(74623),f=a(44414);const x=e=>{let{onCancel:t,refreshOrders:a,data:x}=e;const[y]=n.A.useForm(),{t:g}=(0,c.B)(),A=(0,h.wA)(),{activeMenu:b}=(0,h.d4)((e=>e.menu),h.bN),[j,C]=(0,v.useState)(!1),k=u.HF.map((e=>({label:g(e),value:e,key:e})));return(0,f.jsx)(n.A,{form:y,layout:"vertical",initialValues:{status:x.status},onFinish:e=>{var n;const l={status:null===e||void 0===e||null===(n=e.status)||void 0===n?void 0:n.value,transaction_id:x.id};C(!0),p.A.updateTransactionStatus(null===x||void 0===x?void 0:x.payable_id,l).finally((()=>{C(!1),t(),a?a():A((0,m.Ms)(b))}))},children:(0,f.jsxs)(l.A,{gutter:12,children:[(0,f.jsx)(o.A,{span:24,children:(0,f.jsx)(n.A.Item,{label:g("status"),name:"status",rules:[{required:!0,message:g("required")}],children:(0,f.jsx)(s.A,{options:k,labelInValue:!0})})}),(0,f.jsx)(i.A,{}),(0,f.jsx)(o.A,{span:24,children:(0,f.jsxs)(r.A,{style:{display:"flex",justifyContent:"end"},children:[(0,f.jsx)(d.A,{onClick:t,children:g("cancel")}),(0,f.jsx)(d.A,{type:"primary",htmlType:"submit",loading:j,children:g("save")})]})})]})})}},53387:(e,t,a)=>{a.d(t,{A:()=>r});var n=a(89379),l=a(9950);const o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"plus-circle",theme:"outlined"};var s=a(25085),i=function(e,t){return l.createElement(s.A,(0,n.A)((0,n.A)({},e),{},{ref:t,icon:o}))};i.displayName="PlusCircleOutlined";const r=l.forwardRef(i)},60218:(e,t,a)=>{a.r(t),a.d(t,{default:()=>me});var n=a(9950),l=a(87864),o=a(80737),s=a(48538),i=a(23263),r=a(32645),d=a(13564),c=a(53387),u=a(13700),v=a(91854),p=a(74623),h=a(70030),m=a(88986),f=a(53177),x=a(90352),y=a(8297),g=a(51242),A=a(47992),b=a(53271),j=a(56592),C=a(23283),k=a(38635),w=a(26714),M=a(12449),_=a(23758),S=a(55386),O=a(76083),D=a(59051),I=a.n(D),T=a(58547),N=a(36059),P=a(90650),Y=a(79378),E=a(76074),$=a(18411),z=a(46809),B=a(4399),F=a(24513),V=a(19826),H=a(44070),L=a(98114),K=a(12678),R=a(74522),U=a(14936),q=a(63611),G=a(53774),Z=a(52423),Q=a(13311),X=a(44414);const{Meta:J}=i.A,W=e=>{var t,a,n,l,s,r,d,c,u,v,p;let{data:m,goToShow:f,loading:x,setLocationsMap:y,setId:g,setIsModalVisible:A,setText:b,setDowloadModal:j,setTabType:C,setIsTransactionModalOpen:k}=e;const{t:w}=(0,h.B)(),_=(null===(t=m.transactions)||void 0===t?void 0:t.at(-1))||{},S=[{title:"Client",icon:(0,X.jsx)(Y.A,{}),data:null!==m&&void 0!==m&&m.user?`${(null===(a=m.user)||void 0===a?void 0:a.firstname)||"-"} ${(null===(n=m.user)||void 0===n?void 0:n.lastname)||"-"}`:w("deleted.user")},{title:"Deliveryman",icon:(0,X.jsx)(E.A,{}),data:`${(null===(l=m.deliveryman)||void 0===l?void 0:l.firstname)||"-"} ${(null===(s=m.deliveryman)||void 0===s?void 0:s.lastname)||"-"}`},{title:"Amount",icon:(0,X.jsx)($.A,{}),data:(0,G.A)(null===m||void 0===m?void 0:m.total_price,null===(r=m.currency)||void 0===r?void 0:r.symbol,null===m||void 0===m||null===(d=m.currency)||void 0===d?void 0:d.position)},{title:"Last Payment type",icon:(0,X.jsx)(z.A,{}),data:(null===_||void 0===_||null===(c=_.payment_system)||void 0===c?void 0:c.tag)||"-"},{title:"Last payment status",icon:(0,X.jsx)(B.A,{}),data:null!==_&&void 0!==_&&_.status?(0,X.jsxs)("div",{style:{cursor:"pointer"},onClick:e=>{e.stopPropagation(),k(_)},children:[null===_||void 0===_?void 0:_.status," ",(0,X.jsx)(F.A,{disabled:null===m||void 0===m?void 0:m.deleted_at})]}):"-"},{title:"Delivery date",icon:(0,X.jsx)(V.A,{}),data:I()(null===m||void 0===m?void 0:m.delivery_date).format("YYYY-MM-DD")||"-"},{title:"Created at",icon:(0,X.jsx)(V.A,{}),data:I()(null===m||void 0===m?void 0:m.created_at).format("YYYY-MM-DD")||"-"}],{isDemo:O}=(0,Q.A)(),D=[(0,X.jsx)(Z.kMs,{size:20,onClick:e=>{e.stopPropagation(),y(m.id)}}),(0,X.jsx)(H.A,{onClick:e=>{O?M.oR.warning(w("cannot.work.demo")):(e.stopPropagation(),g([m.id]),A(!0),b(!0),C(m.status))}}),(0,X.jsx)(L.A,{onClick:e=>{e.stopPropagation(),j(m.id)}}),(0,X.jsx)(K.A,{onClick:e=>{e.stopPropagation(),f(m)}})];return(0,X.jsx)(i.A,{actions:D,className:"order-card",children:(0,X.jsxs)(R.A,{loading:x,avatar:!0,active:!0,children:[(0,X.jsx)(J,{avatar:(0,X.jsx)(U.A,{src:null===m||void 0===m||null===(u=m.shop)||void 0===u?void 0:u.logo_img}),description:`#${m.id}`,title:null===m||void 0===m||null===(v=m.shop)||void 0===v||null===(p=v.translation)||void 0===p?void 0:p.title}),(0,X.jsx)(q.Ay,{itemLayout:"horizontal",dataSource:S,renderItem:(e,t)=>(0,X.jsx)(q.Ay.Item,{children:(0,X.jsxs)(o.A,{children:[null===e||void 0===e?void 0:e.icon,(0,X.jsxs)("span",{children:[`${null===e||void 0===e?void 0:e.title}:`,null===e||void 0===e?void 0:e.data]})]})},t)})]})})};var ee=a(69466),te=a(2260),ae=a(80415),ne=a(73041),le=a(81446),oe=a(54209),se=a(99985),ie=a(12916);const re=e=>{let{children:t,title:a,name:n,isDropDisabled:l,total:s=0,loading:i=!1,reloadOrder:r}=e;const{t:d}=(0,h.B)();return(0,X.jsxs)(X.Fragment,{children:[(0,X.jsx)(se.A,{message:(0,X.jsxs)(o.A,{children:[(0,X.jsx)(oe.A,{size:20,style:{cursor:"pointer"},spin:i,onClick:r}),d(a),(0,X.jsx)(ie.A,{children:i?(0,X.jsx)(oe.A,{spin:!0}):s})]}),className:`mb-4 ${n}`,style:{textAlign:"center",fontSize:16,textTransform:"capitalize"}}),(0,X.jsx)(N.gL,{droppableId:n,isDropDisabled:l,children:e=>(0,X.jsx)("div",{ref:e.innerRef,className:"h-screen",style:{opacity:l?.6:1},children:(0,X.jsxs)(X.Fragment,{children:[t,e.placeholder]})})})]})},de=e=>{let{goToEdit:t,goToShow:a,fetchOrderAllItem:l,fetchOrders:o,setLocationsMap:s,setId:i,setIsModalVisible:r,setText:c,setDowloadModal:u,type:m,setTabType:x,setIsTransactionModalOpen:y}=e;const{t:g}=(0,h.B)(),A=(0,v.wA)(),b=(0,d.Zp)(),{statusList:j,loading:C}=(0,v.d4)((e=>e.orderStatus),v.bN),{items:k}=(0,v.d4)((e=>e.orders),v.bN),w=(0,v.d4)((e=>e.globalSettings.settings),v.bN),S=(0,v.d4)((e=>e.orders),v.bN),[O,D]=(0,n.useState)(""),[I,T]=(0,n.useState)({}),[Y,E]=(0,n.useState)({}),$=null===j||void 0===j?void 0:j.map((e=>null===e||void 0===e?void 0:e.name)),z=(e,t)=>{_.A.updateStatus(e,t).then((t=>{var a;A((0,f.gw)()),l(),"1"===(null===w||void 0===w?void 0:w.auto_print_order)&&"accepted"===(null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.status)&&(e=>{const t=`orders/generate-invoice/${e}`;A((0,p.X4)({url:t,id:"generate-invoice ",name:g("generate.invoice")})),b(`/${t}?print=true`)})(e),M.oR.success(`#${e} ${g("order.status.changed")}`)}))},B=e=>{if(!e.destination)return;e.destination&&I.source.droppableId!==e.destination.droppableId&&z(e.draggableId,{status:e.destination.droppableId});const t={...k},a=t[e.source.droppableId],[n,l]=((e,t)=>{const a=Array.from(e),[n]=a.splice(t,1);return[n,a]})(a,e.source.index);t[e.source.droppableId]=l;const o=t[e.destination.droppableId];t[e.destination.droppableId]=((e,t,a)=>{const n=Array.from(e);return n.splice(t,0,a),n})(o,e.destination.index,n),A((0,f.jb)(t)),E(null)},F=e=>(0!==e||Y!==$.length-1)&&!!Boolean(Y>e);(0,n.useEffect)((()=>{A((0,f.gw)()),l()}),[m]);return(0,X.jsx)(X.Fragment,{children:C?(0,X.jsx)("div",{children:(0,X.jsx)(le.A,{})}):(0,X.jsx)(N.JY,{onDragEnd:B,onDragStart:e=>{const t=$.findIndex((t=>t===e.source.droppableId));T(e),E(t)},children:(0,X.jsx)("div",{className:"order-board",children:null===$||void 0===$?void 0:$.map(((e,n)=>{var l,d,v,p;return(0,X.jsx)("div",{className:"dnd-column",children:(0,X.jsx)(re,{title:e,onDragEnd:B,name:e,isDropDisabled:F(n),total:null===(l=k[e])||void 0===l?void 0:l.length,loading:S[e].loading,reloadOrder:()=>(e=>{A((0,f.yT)(e)),o({status:e})})(e),children:(0,X.jsxs)(ee.Ay,{onScroll:t=>((e,t)=>{const a=e.target.lastChild,n=e.target.clientHeight+e.target.scrollTop;a&&n>a.offsetTop+a.clientHeight+19.9&&S[t].meta.last_page>S[t].meta.current_page&&!S[t].loading&&(D(t),o({page:S[t].meta.current_page+1,perPage:5,status:t}))})(t,e),autoHeight:!0,autoHeightMin:"75vh",autoHeightMax:"75vh",autoHide:!0,id:e,children:[Boolean(S[e].loading&&!(null!==(d=k[e])&&void 0!==d&&d.length))?null===(p=ae.LH[e])||void 0===p?void 0:p.map((()=>(0,X.jsx)(ne.A,{loading:!0}))):null===(v=k[e])||void 0===v?void 0:v.map(((e,n)=>(0,X.jsx)(X.Fragment,{children:(0,X.jsx)(N.sx,{draggableId:e.id.toString(),index:n,children:n=>(0,X.jsx)("div",{ref:n.innerRef,...n.draggableProps,...n.dragHandleProps,children:(0,X.jsx)(W,{data:e,goToEdit:t,goToShow:a,setLocationsMap:s,setId:i,setIsModalVisible:r,setText:c,setDowloadModal:u,setTabType:x,setIsTransactionModalOpen:y})})},e.id)}))),S[e].loading&&e===O&&(0,X.jsx)(P.A,{indicator:(0,X.jsx)(te.A,{style:{fontSize:24},spin:!0})})]})})},e)}))})})})};var ce=a(91258),ue=a(14382),ve=a(63620),pe=a(52864);const{RangePicker:he}=l.A;function me(){var e,t,a,l;const D=(0,v.wA)(),N=(0,d.Zp)(),{t:P}=(0,h.B)(),{type:Y}=(0,d.g)(),{statusList:E}=(0,v.d4)((e=>e.orderStatus),v.bN),[$,z]=(0,n.useState)(null),[B,F]=(0,n.useState)(null),[V,H]=(0,n.useState)(null),[L,K]=(0,n.useState)(null),[R,U]=(0,n.useState)(!1),[q,G]=(0,n.useState)(null),[Z,Q]=(0,n.useState)(null),{setIsModalVisible:J}=(0,n.useContext)(S.o),{activeMenu:W}=(0,v.d4)((e=>e.menu),v.bN),[ee,te]=(0,n.useState)(null),[ae,ne]=(0,n.useState)(null),[le,oe]=(0,n.useState)(!1),[se,ie]=(0,n.useState)(null),re=null===W||void 0===W?void 0:W.data,me={search:null!==re&&void 0!==re&&re.search?re.search:void 0,perPage:(null===re||void 0===re?void 0:re.perPage)||5,page:(null===re||void 0===re?void 0:re.page)||1,user_id:null===re||void 0===re?void 0:re.client_id,status:"deleted_at"!==(null===re||void 0===re?void 0:re.role)&&(null===re||void 0===re?void 0:re.role),shop_id:null!==(null===(e=W.data)||void 0===e?void 0:e.shop_id)?null===(t=W.data)||void 0===t?void 0:t.shop_id:null,delivery_type:"scheduled"!==Y?Y:void 0,delivery_date_from:"scheduled"===Y?I()().add(1,"day").format("YYYY-MM-DD"):void 0,date_from:(null===se||void 0===se||null===(a=se[0])||void 0===a?void 0:a.format("YYYY-MM-DD"))||void 0,date_to:(null===se||void 0===se||null===(l=se[1])||void 0===l?void 0:l.format("YYYY-MM-DD"))||void 0};(0,m.A)((()=>{D((0,f.gw)()),ge()}),[re,se]);const fe=(e,t)=>{(0,v.vA)((()=>{D((0,f.gw)()),D((0,p.Ok)({activeMenu:W,data:{...re,[t]:e}}))}))};const xe=()=>{z(null),G(null),F(null),H(null)};const ye=e=>{var t,a,n,l;const o={...e,delivery_type:"scheduled"!==Y?Y:void 0,delivery_date_from:"scheduled"===Y?I()().add(1,"day").format("YYYY-MM-DD"):void 0,search:null!==re&&void 0!==re&&re.search?re.search:void 0,user_id:null===re||void 0===re?void 0:re.client_id,status:null===e||void 0===e?void 0:e.status,shop_id:null!==(null===(t=W.data)||void 0===t?void 0:t.shop_id)?null===(a=W.data)||void 0===a?void 0:a.shop_id:null,date_from:(null===se||void 0===se||null===(n=se[0])||void 0===n?void 0:n.format("YYYY-MM-DD"))||void 0,date_to:(null===se||void 0===se||null===(l=se[1])||void 0===l?void 0:l.format("YYYY-MM-DD"))||void 0};switch(null===e||void 0===e?void 0:e.status){case"new":D((0,f.wy)(o));break;case"accepted":D((0,f.tB)(o));break;case"ready":D((0,f.xR)(o));break;case"on_a_way":D((0,f.n7)(o));break;case"delivered":D((0,f.Cg)(o));break;case"canceled":D((0,f.xm)(o));break;case"cooking":D((0,f.yC)(o));break;default:console.log("Sorry, we are out of")}},ge=()=>{D((0,f.gw)()),ye({status:"new"}),ye({status:"accepted"}),ye({status:"ready"}),ye({status:"on_a_way"}),ye({status:"delivered"}),ye({status:"canceled"}),ye({status:"cooking"})};return(0,n.useEffect)((()=>{null!==W&&void 0!==W&&W.refetch&&(D((0,f.Gb)(me)),D((0,p.km)(W)),D((0,x.rA)({})),D((0,x.nr)({})))}),[null===W||void 0===W?void 0:W.refetch]),(0,X.jsxs)(X.Fragment,{children:[(0,X.jsxs)(o.A,{className:"w-100 justify-content-end mb-3",children:[(0,X.jsx)(ce.A,{listType:"orders-board"}),(0,X.jsx)(s.A,{type:"primary",icon:(0,X.jsx)(c.A,{}),onClick:()=>{D((0,g.Uy)()),D((0,p.wr)({id:"pos.system_01",url:"pos-system",name:"pos.system",icon:"laptop",data:W.data,refetch:!0})),N("/pos-system")},style:{width:"100%"},children:P("add.order")})]}),(0,X.jsx)(i.A,{children:(0,X.jsxs)(o.A,{wrap:!0,children:[(0,X.jsx)(y.A,{defaultValue:null===re||void 0===re?void 0:re.search,resetSearch:!(null!==re&&void 0!==re&&re.search),placeholder:P("search"),handleChange:e=>fe(e,"search"),style:{width:200}}),(0,X.jsx)(A.G,{placeholder:P("select.shop"),fetchOptions:async function(e){const t={search:e,status:"approved"};return T.A.getAll(t).then((e=>{let{data:t}=e;return t.map((e=>{var t;return{label:null===(t=e.translation)||void 0===t?void 0:t.title,value:e.id}}))}))},style:{width:200},onClear:()=>fe(null,"shop_id"),onSelect:e=>fe(e.value,"shop_id"),onDeselect:()=>fe(null,"shop_id"),allowClear:!0,value:null===re||void 0===re?void 0:re.shop_id}),(0,X.jsx)(A.G,{placeholder:P("select.client"),fetchOptions:async function(e){const t={search:e,perPage:10};return b.A.search(t).then((e=>{let{data:t}=e;return t.map((e=>({label:`${e.firstname} ${e.lastname}`,value:e.id})))}))},onSelect:e=>fe(e.value,"client_id"),onDeselect:()=>fe(null,"client_id"),onClear:()=>fe(null,"client_id"),style:{width:200},value:null===re||void 0===re?void 0:re.client_id}),(0,X.jsx)(he,{defaultValue:se,onChange:e=>{fe(JSON.stringify(e),"data_time"),ie(e)},onClear:()=>{fe(null,"data_time"),ie(null)},allowClear:!0,style:{width:250}}),(0,X.jsxs)(s.A,{onClick:()=>{U(!0),_.A.export(me).then((e=>{const t=ve.bb+e.data.file_name;window.location.href=t})).finally((()=>U(!1)))},loading:R,style:{width:"100%"},children:[(0,X.jsx)(ue.$tV,{className:"mr-2"}),P("export")]}),(0,X.jsx)(s.A,{icon:(0,X.jsx)(u.A,{}),onClick:()=>{(0,v.vA)((()=>{D((0,f.gw)()),D((0,p.Ok)({activeMenu:W,data:null}))})),ge()},style:{width:"100%"},children:P("clear")})]})}),(0,X.jsx)(de,{goToEdit:e=>{D((0,g.Uy)()),D((0,p.X4)({url:`order/${e.id}`,id:"order_edit",name:P("edit.order")})),N(`/order/${e.id}`)},goToShow:e=>{D((0,p.X4)({url:`order/details/${e.id}`,id:"order_details",name:P("order.details")})),N(`/order/details/${e.id}`)},fetchOrderAllItem:ge,fetchOrders:ye,setLocationsMap:F,setId:te,setIsModalVisible:J,setText:ne,setDowloadModal:H,type:Y,setTabType:Q,setIsTransactionModalOpen:K}),$&&(0,X.jsx)(j.A,{orderDetails:$,handleCancel:xe,status:E}),q&&(0,X.jsx)(C.A,{orderDetails:q,handleCancel:xe}),B&&(0,X.jsx)(k.A,{id:B,handleCancel:xe}),V&&(0,X.jsx)(w.A,{id:V,handleCancel:xe}),!!L&&(0,X.jsx)(r.A,{visible:!!L,footer:!1,onCancel:()=>K(null),children:(0,X.jsx)(pe.A,{data:L,onCancel:()=>K(null),refreshOrders:ge})}),(0,X.jsx)(O.A,{click:()=>{oe(!0);const e={...Object.assign({},...ee.map(((e,t)=>({[`ids[${t}]`]:e}))))};_.A.delete(e).then((()=>{D((0,f.gw)()),M.oR.success(P("successfully.deleted")),J(!1),ge({status:Z}),ne(null)})).finally((()=>oe(!1)))},text:P(ae?"delete":"all.delete"),loading:le,setText:te})]})}},73041:(e,t,a)=>{a.d(t,{A:()=>s});var n=a(23263),l=a(74522),o=(a(9950),a(44414));const s=e=>{let{loading:t}=e;return(0,o.jsx)(n.A,{className:"order-card",children:(0,o.jsx)(l.A,{loading:t,avatar:!0,active:!0})})}},91258:(e,t,a)=>{a.d(t,{A:()=>d});var n=a(17811),l=(a(9950),a(29949)),o=a(42935),s=a(13564),i=a(44414);const r=[{value:"orders-board",title:"Board",icon:(0,i.jsx)(o.oeo,{size:20})},{value:"orders",title:"List",icon:(0,i.jsx)(l.AyK,{size:20})}],d=e=>{let{listType:t}=e;const{type:a}=(0,s.g)(),l=(0,s.Zp)();return(0,i.jsx)(n.Ay.Group,{value:t,onChange:e=>{l(`/${e.target.value}${a?`/${a}`:""}`)},className:"float-right",buttonStyle:"solid",children:null===r||void 0===r?void 0:r.map((e=>(0,i.jsx)(n.Ay.Button,{value:e.value,children:(0,i.jsxs)("div",{className:"d-flex align-items-center",style:{gap:"10px"},children:[e.icon,e.title]})},e.value)))})}}}]);