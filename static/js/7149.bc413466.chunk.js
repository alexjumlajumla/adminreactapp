"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[7149],{97149:(t,e,i)=>{i.r(e),i.d(e,{default:()=>b});var a=i(47313),n=i(97890),l=i(23560),s=i(83999),o=i(10976),r=i(77181),c=i(72652),d=i(97421),u=i(2717),v=i(90954),g=i(24511),m=i(73431),p=i(65436),h=i(14241),_=i(46417);const{Step:f}=s.Z,b=()=>{var t,e,i;const{t:b}=(0,g.$)(),{activeMenu:y}=(0,u.v9)((t=>t.menu),u.wU),{id:j}=(0,n.UO)(),x=(0,u.I0)(),{defaultLang:k,languages:S}=(0,u.v9)((t=>t.formLang),u.wU),[Z,w]=(0,a.useState)((null===(t=y.data)||void 0===t?void 0:t.step)||0),[N,F]=(0,a.useState)(null!==(e=y.data)&&void 0!==e&&e.image?[null===(i=y.data)||void 0===i?void 0:i.image]:[]),O=()=>{w(Z+1)},U=()=>{w(Z-1)},[V]=o.Z.useForm(),I=(0,n.s0)(),[M,$]=(0,a.useState)(!1),[q,A]=(0,a.useState)(!1);(0,a.useEffect)((()=>()=>{const t=V.getFieldsValue(!0);x((0,v.nc)({activeMenu:y,data:t}))}),[]);return(0,a.useEffect)((()=>{y.refetch&&(t=>{$(!0),h.Z.getById(t).then((t=>{var e;let i=t.data;var a;console.log("recept",i),V.setFieldsValue({...i,active_time:Number(i.active_time),total_time:Number(i.total_time),title:{[k]:i.translation.title},description:{[k]:i.translation.description},instruction:Object.assign({},...i.instructions.map((t=>({[t.locale]:t.title})))),ingredient:Object.assign({},...i.ingredients.map((t=>({[t.locale]:t.title})))),nutrition:null===(e=i.nutritions)||void 0===e?void 0:e.map((t=>({percentage:Number(null===t||void 0===t?void 0:t.percentage),weight:Number(null===t||void 0===t?void 0:t.weight),...Object.assign({},...t.translations.flatMap((t=>({[t.locale]:t.title}))))}))),category_id:{value:i.category.id,label:i.category.translation.title},stocks:i.stocks.map((t=>({stock_id:{value:t.id,label:t.product.translation.title},...t})))}),F([(a=i.img,{name:a,url:d.bV+a})])})).finally((()=>{$(!1),x((0,v.A_)(y))}))})(j)}),[y.refetch]),(0,_.jsx)(r.Z,{title:b("edit.recepe"),extra:(0,_.jsx)(m.Z,{}),children:M?(0,_.jsx)("div",{className:"d-flex justify-content-center align-items-center",children:(0,_.jsx)(c.Z,{size:"large",className:"py-5"})}):(0,_.jsxs)(o.Z,{layout:"vertical",onFinish:t=>{var e;V.validateFields();const i={...t,total_time:t.total_time.toString(),active_time:t.active_time.toString(),category_id:t.category_id.value,images:null===N||void 0===N?void 0:N.map((t=>t.name)),stocks:t.stocks.map((t=>({min_quantity:t.min_quantity,stock_id:t.stock_id.value}))),nutrition:null===(e=t.nutrition)||void 0===e?void 0:e.map((t=>{var e;return{...t,percentage:null===t||void 0===t||null===(e=t.percentage)||void 0===e?void 0:e.toString(),weight:t.weight.toString()}}))};A(!0);const a="seller/recept";h.Z.update(j,i).then((()=>{l.Am.success(b("successfully.updated")),I(`/${a}`),x((0,v.ph)({...y,nextUrl:a}))})).finally((()=>A(!1)))},form:V,initialValues:{active:!0,...y.data},children:[(0,_.jsx)(s.Z,{current:Z,children:p.S.map((t=>(0,_.jsx)(f,{title:b(t.title)},t.title)))}),p.S.map((t=>{const e=t.content;return(0,_.jsx)("div",{className:`steps-content ${t.step!==Z+1&&"hidden"}`,children:(0,_.jsx)(e,{next:O,prev:U,loading:q,image:N,setImage:F})},t.title)}))]})})}}}]);