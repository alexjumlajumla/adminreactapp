"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[1553],{20776:(e,l,a)=>{a.d(l,{o:()=>d});var s=a(47313),i=a(84762),n=a(72652),t=a(12279),r=a.n(t),o=a(46417);const d=e=>{let{fetchOptions:l,refetch:a=!1,debounceTimeout:t=400,...d}=e;const[u,c]=(0,s.useState)(!1),[m,v]=(0,s.useState)([]),h=(0,s.useMemo)((()=>r()((e=>{v([]),c(!0),l(e).then((e=>{v(e),c(!1)}))}),t)),[]);return(0,o.jsx)(i.Z,{showSearch:!0,labelInValue:!0,filterTreeNode:(e,l)=>{var a;if(l)return null===l||void 0===l||null===(a=l.label)||void 0===a?void 0:a.localeCompare(e)},treeLine:!0,onSearch:e=>{console.log("value",e),h(e)},filterOption:!1,treeData:u?[]:m,treeDefaultExpandAll:!0,onFocus:()=>{m.length&&!a||(c(!0),l().then((e=>{v(e),c(!1)})))},notFoundContent:u?(0,o.jsx)(n.Z,{size:"small"}):"no results",...d})}},98501:(e,l,a)=>{a.d(l,{CM:()=>n,Km:()=>d,OT:()=>r,Q1:()=>s,Sp:()=>o,a5:()=>u,gN:()=>i,qO:()=>t});const s={new:[1,2,3,4,5],accepted:[1,2,3,4,5],ready:[1,2,3,4,5],on_a_way:[1,2,3,4,5],delivered:[1,2,3,4,5],canceled:[1,2,3,4,5],cooking:[1,2,3,4,5]},i=["progress","paid","canceled","rejected","refund"],n=["before","after"],t=["blue","red","gold","volcano","cyan","lime"],r=["new","accepted","cooking","ready","ended"],o=["new","accepted","cooking","ready","on_a_way","delivered","canceled"],d=["dine_in","delivery","pickup"],u=["male","female"]},19107:(e,l,a)=>{a.d(l,{Z:()=>t});var s=a(31881),i=a.n(s),n=a(97421);async function t(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.kr,a={address:e,key:l};return i().get("https://maps.googleapis.com/maps/api/geocode/json",{params:a}).then((e=>{let{data:l}=e;return l.results[0]})).catch((e=>"not found"))}},30008:(e,l,a)=>{a.d(l,{Z:()=>Y});var s=a(47313),i=a(10976),n=a(45705),t=a(59491),r=a(97890),o=a(2717),d=a(90954),u=a(49067),c=a(24511),m=a(17649),v=a(84762),h=a(66204),p=a(68197),g=a(59624),j=a(77181),Z=a(66672),x=a(86345),f=a(16124),b=a(46155),y=a(74294),_=a(52421),w=a(97388),I=a(75868),k=a(98447),S=a(96207),q=a(13622),P=a(61197),F=a(30763),N=a(49986),O=a(74551),C=a(45005),L=a(20776),E=a(97421),M=a(52838),V=a(19107),D=a(98501),$=a(46417);const{SHOW_ALL:H}=v.Z,A=e=>{var l;let{backImage:a,setBackImage:r,logoImage:d,setLogoImage:u,form:m,user:v,setLocation:A,location:Y,emailStatusOptions:B}=e;const{t:U}=(0,c.$)(),{activeMenu:R}=(0,o.v9)((e=>e.menu),o.wU),T=i.Z.useWatch("categories",m),[J,K]=(0,s.useState)(null),[W,z]=(0,s.useState)(null),[Q,G]=(0,s.useState)(null),{defaultLang:X,languages:ee}=(0,o.v9)((e=>e.formLang),o.wU),[le,ae]=(0,s.useState)(""),se=(null===R||void 0===R||null===(l=R.data)||void 0===l?void 0:l.documents)||[],{placePredictions:ie,getPlacePredictions:ne,isPlacePredictionsLoading:te}=(0,M.Z)({apiKey:E.kr,libraries:["places","geocode"]}),re=D.CM.map((e=>({label:U(e),value:e,key:e})));const oe=()=>{K(!0),G(!0)},de=()=>{K(!1),z(!1)},ue=e=>{if(e.children)if(T.some((l=>l.value===e.value))){const l=T.filter((l=>l.value!==e.value)),a=l.filter((l=>!e.children.some((e=>e.value===l.value))));m.setFieldsValue({categories:a})}else m.setFieldsValue({categories:T.concat([{label:e.label,value:e.value},...e.children.map((e=>({label:e.label,value:e.value})))])});else null!==T&&void 0!==T&&T.some((l=>l.value===e.value))?m.setFieldsValue({categories:T.filter((l=>l.value!==e.value))}):m.setFieldsValue({categories:T.concat([e.parent,{label:e.label,value:e.value}])})};return(0,$.jsxs)(p.Z,{gutter:12,children:[(0,$.jsx)(g.Z,{span:24,children:(0,$.jsx)(j.Z,{children:(0,$.jsxs)(p.Z,{gutter:12,children:[(0,$.jsx)(g.Z,{span:4,children:(0,$.jsx)(i.Z.Item,{label:U("logo.image"),name:"logo_img",rules:[{validator:(e,l)=>0===(null===d||void 0===d?void 0:d.length)?Promise.reject(new Error(U("required"))):Promise.resolve()}],children:(0,$.jsx)(I.Z,{type:"shops/logo",imageList:d,setImageList:u,form:m,multiple:!1,name:"logo_img"})})}),(0,$.jsx)(g.Z,{span:4,children:(0,$.jsx)(i.Z.Item,{label:U("background.image"),name:"background_img",rules:[{validator:(e,l)=>0===(null===a||void 0===a?void 0:a.length)?Promise.reject(new Error(U("required"))):Promise.resolve()}],children:(0,$.jsx)(I.Z,{type:"shops/background",imageList:a,setImageList:r,form:m,multiple:!1,name:"background_img"})})}),(0,$.jsx)(g.Z,{span:10,children:(0,$.jsx)(i.Z.Item,{label:U("status.note"),name:"status_note",rules:[{validator:(e,l)=>l?l&&""===(null===l||void 0===l?void 0:l.trim())?Promise.reject(new Error(U("no.empty.space"))):l&&(null===l||void 0===l?void 0:l.length)<5?Promise.reject(new Error(U("must.be.at.least.5"))):Promise.resolve():Promise.reject(new Error(U("required")))}],children:(0,$.jsx)(_.Z,{rows:4})})}),(0,$.jsx)(g.Z,{span:4,children:(0,$.jsx)(i.Z.Item,{name:"status",label:U("status"),children:(0,$.jsx)(Z.Z,{disabled:!0})})}),(0,$.jsx)(g.Z,{span:2,children:(0,$.jsx)(i.Z.Item,{label:U("open"),name:"open",valuePropName:"checked",initialValue:!1,children:(0,$.jsx)(x.Z,{})})})]})})}),(0,$.jsx)(g.Z,{span:24,children:(0,$.jsx)(j.Z,{title:U("general"),children:(0,$.jsxs)(p.Z,{gutter:12,children:[(0,$.jsx)(g.Z,{span:12,children:(0,$.jsxs)(p.Z,{gutter:12,children:[(0,$.jsx)(g.Z,{span:24,children:ee.map(((e,l)=>(0,$.jsx)(i.Z.Item,{label:U("title"),name:`title[${e.locale}]`,rules:[{validator:(l,a)=>a||(null===e||void 0===e?void 0:e.locale)!==X?a&&""===(null===a||void 0===a?void 0:a.trim())?Promise.reject(new Error(U("no.empty.space"))):a&&(null===a||void 0===a?void 0:a.length)<2?Promise.reject(new Error(U("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(U("required")))}],hidden:e.locale!==X,children:(0,$.jsx)(Z.Z,{})},"title"+l)))}),(0,$.jsx)(g.Z,{span:24,children:(0,$.jsx)(i.Z.Item,{label:U("phone"),name:"phone",rules:[{required:!0,message:U("required")}],children:(0,$.jsx)(f.Z,{min:0,className:"w-100"})})})]})}),(0,$.jsx)(g.Z,{span:12,children:ee.map(((e,l)=>(0,$.jsx)(i.Z.Item,{label:U("description"),name:`description[${e.locale}]`,rules:[{validator:(l,a)=>a||(null===e||void 0===e?void 0:e.locale)!==X?a&&""===(null===a||void 0===a?void 0:a.trim())?Promise.reject(new Error(U("no.empty.space"))):a&&(null===a||void 0===a?void 0:a.length)<5?Promise.reject(new Error(U("must.be.at.least.5"))):Promise.resolve():Promise.reject(new Error(U("required")))}],hidden:e.locale!==X,children:(0,$.jsx)(_.Z,{rows:4})},"desc"+l)))}),(0,$.jsx)(g.Z,{span:12,children:(0,$.jsx)(i.Z.Item,{label:U("seller"),name:"user",rules:[{required:!0,message:U("required")}],children:(0,$.jsx)(q.R,{disabled:!v,fetchOptions:async function(e){const l={search:e,roles:"user","empty-shop":1};return G(!1),N.Z.search(l).then((e=>e.data.map((e=>({label:e.firstname+" "+(e.lastname||""),value:e.id})))))},refetch:Q,dropdownRender:e=>(0,$.jsxs)($.Fragment,{children:[e,(0,$.jsx)(b.Z,{style:{margin:"8px 0"}}),(0,$.jsx)(t.Z,{className:"w-100",icon:(0,$.jsx)(k.Z,{}),onClick:oe,children:U("add.user")})]})})})}),!(null===se||void 0===se||!se.length)&&(0,$.jsx)(g.Z,{span:12,children:(0,$.jsx)(i.Z.Item,{label:U("uploaded.documents.for.verification"),children:(0,$.jsx)(n.Z,{gap:"4px 0",wrap:!0,children:null===se||void 0===se?void 0:se.map((e=>(0,$.jsx)("a",{href:null===e||void 0===e?void 0:e.path,target:"_blank",rel:"noopener noreferrer",children:(0,$.jsx)(h.Z,{icon:(0,$.jsx)(S.Z,{}),children:null===e||void 0===e?void 0:e.title})})))})})}),(0,$.jsx)(g.Z,{span:6,children:(0,$.jsx)(i.Z.Item,{label:U("shop.tags"),name:"tags",rules:[{required:!0,message:U("required")}],children:(0,$.jsx)(q.R,{mode:"multiple",fetchOptions:async function(e){G(!1);const l={search:e};return P.Z.getAll(l).then((e=>{let{data:l}=e;return l.map((e=>{var l;return{label:(null===(l=e.translation)||void 0===l?void 0:l.title)||"no name",value:e.id}}))}))},refetch:Q})})}),(0,$.jsx)(g.Z,{span:6,children:(0,$.jsx)(i.Z.Item,{label:U("categories"),name:"categories",rules:[{required:!0,message:U("required")}],children:(0,$.jsx)(L.o,{treeCheckable:!0,tagRender:e=>{const{label:l,onClose:a}=e;return(0,$.jsx)(h.Z,{onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},onClose:a,style:{marginRight:3},children:l})},showCheckedStrategy:H,treeCheckStrictly:!0,refetch:!0,onSelect:(e,l)=>ue(l),onDeselect:(e,l)=>ue(l),fetchOptions:async function(e){const l={search:e,type:"shop",active:1,lang:X};return G(!1),F.Z.getAll(l).then((e=>{let{data:l}=e;return l.map((e=>{var l,a;return{label:(null===(l=e.translation)||void 0===l?void 0:l.title)||"no name",value:e.id,disabled:0===(null===(a=e.children)||void 0===a?void 0:a.length),children:e.children.map((l=>{var a,s;return{label:null===(a=l.translation)||void 0===a?void 0:a.title,value:l.id,parent:{label:(null===(s=e.translation)||void 0===s?void 0:s.title)||"no name",value:e.id}}}))}}))}))}})})}),(0,$.jsx)(g.Z,{span:12,children:(0,$.jsx)(i.Z.Item,{name:"emailStatuses",label:U("order.statuses.for.email.notifications"),children:(0,$.jsx)(y.Z,{mode:"multiple",options:B})})})]})})}),(0,$.jsx)(g.Z,{span:8,children:(0,$.jsx)(j.Z,{title:U("delivery"),children:(0,$.jsxs)(p.Z,{gutter:8,children:[(0,$.jsx)(g.Z,{span:12,children:(0,$.jsx)(i.Z.Item,{name:"price",label:U("min.price"),rules:[{required:!0,message:U("required")}],children:(0,$.jsx)(f.Z,{min:0,className:"w-100"})})}),(0,$.jsx)(g.Z,{span:12,children:(0,$.jsx)(i.Z.Item,{name:"price_per_km",label:U("price.per.km"),rules:[{required:!0,message:U("required")}],children:(0,$.jsx)(f.Z,{min:0,className:"w-100"})})})]})})}),(0,$.jsx)(g.Z,{span:8,children:(0,$.jsx)(j.Z,{title:U("delivery.time"),children:(0,$.jsxs)(p.Z,{gutter:12,children:[(0,$.jsx)(g.Z,{span:12,children:(0,$.jsx)(i.Z.Item,{name:"delivery_time_type",label:U("delivery_time_type"),rules:[{required:!0,message:U("required")}],children:(0,$.jsxs)(y.Z,{className:"w-100",children:[(0,$.jsx)(y.Z.Option,{value:"minute",label:U("minutes")}),(0,$.jsx)(y.Z.Option,{value:"hour",label:U("hour")})]})})}),(0,$.jsx)(g.Z,{span:12,children:(0,$.jsx)(i.Z.Item,{name:"delivery_time_from",label:U("delivery_time_from"),rules:[{required:!0,message:U("required")}],children:(0,$.jsx)(f.Z,{min:0,className:"w-100"})})}),(0,$.jsx)(g.Z,{span:12,children:(0,$.jsx)(i.Z.Item,{name:"delivery_time_to",label:U("delivery_time_to"),rules:[{required:!0,message:U("required")}],children:(0,$.jsx)(f.Z,{min:0,className:"w-100"})})})]})})}),(0,$.jsx)(g.Z,{span:8,children:(0,$.jsx)(j.Z,{title:U("order.info"),children:(0,$.jsxs)(p.Z,{gutter:12,children:[(0,$.jsx)(g.Z,{span:12,children:(0,$.jsx)(i.Z.Item,{label:U("min.amount"),name:"min_amount",rules:[{required:!0,message:U("required")}],children:(0,$.jsx)(f.Z,{min:0,className:"w-100"})})}),(0,$.jsx)(g.Z,{span:12,children:(0,$.jsx)(i.Z.Item,{label:U("tax"),name:"tax",rules:[{required:!0,message:U("required")}],children:(0,$.jsx)(f.Z,{min:0,max:100,addonAfter:"%",className:"w-100"})})}),(0,$.jsx)(g.Z,{span:12,children:(0,$.jsx)(i.Z.Item,{label:U("admin.comission"),name:"percentage",rules:[{required:!0,message:U("required")}],children:(0,$.jsx)(f.Z,{min:0,max:100,className:"w-100",addonAfter:"%"})})})]})})}),(0,$.jsx)(g.Z,{span:24,children:(0,$.jsx)(j.Z,{title:U("qr.menu.settings"),children:(0,$.jsxs)(p.Z,{gutter:12,children:[(0,$.jsx)(g.Z,{span:6,children:(0,$.jsx)(i.Z.Item,{name:"wifi_name",label:U("shop.wifi.name"),children:(0,$.jsx)(Z.Z,{className:"w-100"})})}),(0,$.jsx)(g.Z,{span:6,children:(0,$.jsx)(i.Z.Item,{name:"wifi_password",label:U("shop.wifi.password"),children:(0,$.jsx)(Z.Z,{className:"w-100"})})}),(0,$.jsx)(g.Z,{span:6,children:(0,$.jsx)(i.Z.Item,{label:U("order.payment"),name:"order_payment",rules:[{required:!0,message:U("required")}],children:(0,$.jsx)(y.Z,{options:re})})}),(0,$.jsx)(g.Z,{span:6,children:(0,$.jsx)(i.Z.Item,{name:"new_order_after_payment",label:U("new.order.after.payment"),valuePropName:"checked",children:(0,$.jsx)(x.Z,{})})})]})})}),(0,$.jsx)(g.Z,{span:24,children:(0,$.jsx)(j.Z,{title:U("address"),children:(0,$.jsxs)(p.Z,{gutter:12,children:[(0,$.jsx)(g.Z,{span:12,children:ee.map(((e,l)=>(0,$.jsx)(i.Z.Item,{label:U("address"),name:`address[${e.locale}]`,rules:[{required:e.locale===X,message:U("required")}],hidden:e.locale!==X,children:(0,$.jsx)(y.Z,{allowClear:!0,searchValue:le,showSearch:!0,autoClearSearchValue:!0,loading:te,options:null===ie||void 0===ie?void 0:ie.map((e=>({label:e.description,value:e.description}))),onSearch:e=>{ae(e),e.length>0&&ne({input:e})},onSelect:async e=>{const l=await(0,V.Z)(e);A({lat:null===l||void 0===l?void 0:l.geometry.location.lat,lng:null===l||void 0===l?void 0:l.geometry.location.lng})}})},"address"+l)))}),(0,$.jsx)(g.Z,{span:24,children:(0,$.jsx)(w.Z,{location:Y,setLocation:A,setAddress:e=>m.setFieldsValue({[`address[${X}]`]:e})})})]})})}),J&&(0,$.jsx)(O.Z,{visible:J,handleCancel:()=>de()}),W&&(0,$.jsx)(C.Z,{visible:W,handleCancel:()=>de()})]})},Y=e=>{var l,a,v,h,p,g,j,Z,x;let{next:f,action_type:b="",user:y}=e;const{t:_}=(0,c.$)(),[w]=i.Z.useForm(),I=(0,r.s0)(),k=(0,o.I0)(),{uuid:S}=(0,r.UO)(),{activeMenu:q}=(0,o.v9)((e=>e.menu),o.wU),{settings:P}=(0,o.v9)((e=>e.globalSettings),o.wU),[F,N]=(0,s.useState)(null!==q&&void 0!==q&&null!==(l=q.data)&&void 0!==l&&l.location?{lat:parseFloat(null===q||void 0===q||null===(a=q.data)||void 0===a||null===(v=a.location)||void 0===v?void 0:v.latitude),lng:parseFloat(null===q||void 0===q||null===(h=q.data)||void 0===h||null===(p=h.location)||void 0===p?void 0:p.longitude)}:(0,m.Z)(P)),[O,C]=(0,s.useState)(!1),[L,E]=(0,s.useState)(null!==(g=q.data)&&void 0!==g&&g.logo_img?[null===(j=q.data)||void 0===j?void 0:j.logo_img]:[]),[M,V]=(0,s.useState)(null!==(Z=q.data)&&void 0!==Z&&Z.background_img?[null===(x=q.data)||void 0===x?void 0:x.background_img]:[]),H=(0,s.useMemo)((()=>D.Sp.map((e=>({label:_(e),value:e,key:e})))),[S]);(0,s.useEffect)((()=>()=>{const e=w.getFieldsValue(!0);e.open_time=JSON.stringify(null===e||void 0===e?void 0:e.open_time),e.close_time=JSON.stringify(null===e||void 0===e?void 0:e.close_time),e.open=!!e.open,k((0,d.nc)({activeMenu:q,data:{...q.data,...e}}))}),[]);return(0,$.jsx)($.Fragment,{children:(0,$.jsxs)(i.Z,{form:w,name:"basic",layout:"vertical",onFinish:e=>{var l,a,s,i,n,t;C(!0);const r=null!==e&&void 0!==e&&null!==(l=e.emailStatuses)&&void 0!==l&&l.length?Object.assign({},...null===e||void 0===e||null===(a=e.emailStatuses)||void 0===a?void 0:a.map(((e,l)=>({[`email_statuses[${l}]`]:(null===e||void 0===e?void 0:e.value)||e})))):[],o={...e,"images[0]":null===(s=L[0])||void 0===s?void 0:s.name,"images[1]":null===(i=M[0])||void 0===i?void 0:i.name,delivery_time_type:e.delivery_time_type,delivery_time_to:e.delivery_time_to,delivery_time_from:e.delivery_time_from,categories:e.categories.map((e=>e.value)),tags:null===e||void 0===e||null===(n=e.tags)||void 0===n?void 0:n.map((e=>e.value)),user_id:e.user.value,open:e.open?1:0,wifi_name:(null===e||void 0===e?void 0:e.wifi_name)||"",wifi_password:(null===e||void 0===e?void 0:e.wifi_password)||"","location[latitude]":F.lat,"location[longitude]":F.lng,user:void 0,delivery_time:0,order_payment:(null===e||void 0===e||null===(t=e.order_payment)||void 0===t?void 0:t.value)||(null===e||void 0===e?void 0:e.order_payment)||void 0,...r,emailStatuses:void 0,new_order_after_payment:null!==e&&void 0!==e&&e.new_order_after_payment?1:0};null===o||void 0===o||delete o.background_img,null===o||void 0===o||delete o.logo_img,"edit"===b?function(e,l){u.Z.update(S,l).then((()=>{k((0,d.nc)({activeMenu:q,data:e})),f()})).catch((e=>console.error(e.response.data.params))).finally((()=>C(!1)))}(e,o):function(e,l){u.Z.create(l).then((l=>{let{data:a}=l;k((0,d.SS)({id:`shop-${a.uuid}`,url:`shop/${a.uuid}`,name:_("add.shop"),data:{...e,id:null===a||void 0===a?void 0:a.id,seller:null===a||void 0===a?void 0:a.seller},refetch:!1})),I(`/shop/${a.uuid}?step=1`)})).catch((e=>console.error(e.response.data.params))).finally((()=>C(!1)))}(e,o)},initialValues:{open:!1,status:"new",...q.data},children:[(0,$.jsx)(A,{form:w,user:y,backImage:M,setBackImage:V,logoImage:L,setLogoImage:E,location:F,setLocation:N,emailStatusOptions:H}),(0,$.jsx)(n.Z,{children:(0,$.jsx)(t.Z,{type:"primary",htmlType:"submit",loading:O,children:_("next")})})]})})}},20131:(e,l,a)=>{a.d(l,{Z:()=>h});var s=a(47313),i=a(51282),n=a(70816),t=a.n(n),r=a(78790),o=a(49682),d=a(97890),u=a(21429),c=a(22899),m=a(10976),v=a(46417);const h=e=>{let{next:l,prev:a}=e;const[n]=m.Z.useForm(),[h,p]=(0,s.useState)([]),[g,j]=(0,s.useState)(new Array(7).fill(!1)),[Z,x]=(0,s.useState)(!1),[f,b]=(0,s.useState)(!1),{uuid:y}=(0,d.UO)();return(0,s.useEffect)((()=>(n.setFieldsValue({working_days:u.P}),y&&(b(!0),o.Z.getById(y).then((e=>{p(e.data.closed_dates.filter((e=>e.day>t()(new Date).format("YYYY-MM-DD"))).map((e=>new Date(e.day))))})),r.Z.getById(y).then((e=>{j(0!==e.data.dates.length?e.data.dates.map((e=>e.disabled)):[]),0!==e.data.dates.length&&n.setFieldsValue({working_days:e.data.dates.map((e=>({title:e.day,from:t()(e.from,"HH:mm:ss"),to:t()(e.to,"HH:mm:ss"),disabled:Boolean(e.disabled)})))})})).finally((()=>b(!1)))),()=>{b(!1),x(!1)})),[]),(0,v.jsx)(v.Fragment,{children:f?(0,v.jsx)(i.Z,{}):(0,v.jsx)(c.Z,{onFinish:e=>{x(!0);const a={dates:h?h.map((e=>t()(e).format("YYYY-MM-DD"))):void 0},s={dates:e.working_days.map((e=>({day:e.title,from:t()(e.from?e.from:"00").format("HH-mm"),to:t()(e.to?e.to:"00").format("HH-mm"),disabled:e.disabled})))};o.Z.update(y,a).then((()=>{l()})).finally((()=>x(!1))),0!==e.working_days.length&&r.Z.update(y,s).then((()=>{l()})).finally((()=>x(!1)))},prev:a,form:n,lines:g,loadingBtn:Z,days:h,setDays:p,setLines:j,weeks:u.P})})}}}]);