"use strict";(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[8157],{88157:(e,t,o)=>{o.r(t),o.d(t,{default:()=>j});var l=o(47313),n=o(83999),a=o(10976),i=o(77181),d=o(97890),s=o(2717),r=o(24511),u=o(29395),c=o(53456),v=o(35233),m=o(69096),_=o(33834),f=o(90954),h=o(17649),p=o(70816),g=o.n(p),y=o(90486),S=o(70250),x=o(23560),F=o(46417);const{Step:Z}=n.Z;function j(){var e,t,o,p,j,b,N,w,k,C,H,M;const{t:U}=(0,r.$)(),[Y]=a.Z.useForm(),E=(0,_.K)(),L=(0,s.I0)(),A=(0,d.s0)(),{activeMenu:D}=(0,s.v9)((e=>e.menu),s.wU),{settings:I}=(0,s.v9)((e=>e.globalSettings),s.wU),{defaultCurrency:J}=(0,s.v9)((e=>e.currency),s.wU),O=Number((null===(e=E.values)||void 0===e?void 0:e.step)||0),[T,V]=(0,l.useState)(!1),[$,K]=(0,l.useState)((null===D||void 0===D||null===(t=D.data)||void 0===t?void 0:t.images)||[]),[q,z]=(0,l.useState)(null!==D&&void 0!==D&&null!==(o=D.data)&&void 0!==o&&o.location_from?{lat:parseFloat(null===D||void 0===D||null===(p=D.data)||void 0===p||null===(j=p.location_from)||void 0===j?void 0:j.latitude),lng:parseFloat(null===D||void 0===D||null===(b=D.data)||void 0===b||null===(N=b.location_from)||void 0===N?void 0:N.longitude)}:(0,h.Z)(I)),[B,G]=(0,l.useState)(null!==D&&void 0!==D&&null!==(w=D.data)&&void 0!==w&&w.location_to?{lat:parseFloat(null===D||void 0===D||null===(k=D.data)||void 0===k||null===(C=k.location_to)||void 0===C?void 0:C.latitude),lng:parseFloat(null===D||void 0===D||null===(H=D.data)||void 0===H||null===(M=H.location_to)||void 0===M?void 0:M.longitude)}:(0,h.Z)(I));(0,l.useEffect)((()=>()=>{const e=Y.getFieldsValue(!0),t=JSON.stringify(e.delivery_date),o=JSON.stringify(e.delivery_time),l={...e,date:t,time:o};L((0,f.nc)({activeMenu:D,data:l}))}),[]);const P=()=>{const e=O+1;E.set("step",e)},Q=()=>{const e=O-1;E.set("step",e)};return(0,F.jsxs)(i.Z,{title:U("add.parcel.order"),children:[(0,F.jsx)(n.Z,{current:O,onChange:e=>{E.set("step",e)},children:u.S.map((e=>(0,F.jsx)(Z,{title:U(e.title)},e.title)))}),(0,F.jsx)("div",{className:"steps-content",children:(0,F.jsxs)(a.Z,{form:Y,name:"parcel-create",layout:"vertical",onFinish:e=>{var t,o;console.log("values => ",e),V(!0);const l={user_id:null===(t=e.user_from)||void 0===t?void 0:t.value,currency_id:null===J||void 0===J?void 0:J.id,type_id:null===(o=e.type)||void 0===o?void 0:o.value,rate:null===J||void 0===J?void 0:J.rate,phone_from:e.phone_from.toString(),username_from:e.username_from,address_from:{longitude:null===q||void 0===q?void 0:q.lng,latitude:null===q||void 0===q?void 0:q.lat,address:e.address_from,house:e.house_from,stage:e.stage_from,room:e.room_from},phone_to:e.phone_to.toString(),username_to:e.username_to,address_to:{longitude:null===B||void 0===B?void 0:B.lng,latitude:null===B||void 0===B?void 0:B.lat,address:e.address_to,house:e.house_to,stage:e.stage_to,room:e.room_to},delivery_date:g()(e.delivery_date).format("YYYY-MM-DD"),delivery_time:g()(e.delivery_time,"HH:mm").format("HH:mm"),note:e.note,images:$.map((e=>e.name))},n={payment_sys_id:e.payment_type.value};y.Z.create(l).then((e=>function(e,t){const o="parcel-orders";y.Z.transaction(e,t).then((()=>{L((0,S.LF)()),x.Am.success(U("successfully.created")),L((0,f.ph)({...D,nextUrl:o})),A(`/${o}`)})).finally((()=>V(!1)))}(e.data.id,n))).catch((()=>V(!1)))},initialValues:{...D.data},onFinishFailed:e=>{const t=["","",""];e.errorFields.map((e=>e.name[0])).forEach((e=>{e.includes("_from")?t[0]="sender.details.invalid":e.includes("_to")?t[1]="receiver.details.invalid":t[2]="parcel.details.invalid"})),t.forEach((e=>{e&&x.Am.error(U(e))}))},children:[(0,F.jsx)("div",{className:"First-content"===u.S[O].content?"":"d-none",children:(0,F.jsx)(c.Z,{form:Y,next:P,location:q,setLocation:z})}),(0,F.jsx)("div",{className:"Second-content"===u.S[O].content?"":"d-none",children:(0,F.jsx)(v.Z,{form:Y,next:P,prev:Q,location:B,setLocation:G})}),(0,F.jsx)("div",{className:"Third-content"===u.S[O].content?"":"d-none",children:(0,F.jsx)(m.Z,{form:Y,loading:T,prev:Q,locationFrom:q,locationTo:B,image:$,setImage:K})})]})})]})}}}]);