(self.webpackChunkgithubit_dashboard=self.webpackChunkgithubit_dashboard||[]).push([[6978],{68221:(e,l,i)=>{"use strict";i.d(l,{Z:()=>m});var n=i(16609),a=i(47313),t=i(59392),o=i(307),s=i(67968),r=i(97421);const d=()=>{var e,l,i;const n=null===(e=s.h.getState())||void 0===e||null===(l=e.globalSettings)||void 0===l||null===(i=l.settings)||void 0===i?void 0:i.location;if(null!==n&&void 0!==n&&n.length){const e=null===n||void 0===n?void 0:n.split(",");return{lat:parseFloat(null===e||void 0===e?void 0:e[0]),lng:parseFloat(null===e||void 0===e?void 0:e[1])}}return{lat:r.Yg,lng:r.Ly}};var u=i(46417);const v=(0,o.Z)(),c=d(),m=(0,n.GoogleApiWrapper)({apiKey:v,libraries:["places"]})((e=>{var l,i;const[o,s]=(0,a.useState)(c),[r,d]=(0,a.useState)(e.triangleCoords?e.triangleCoords:[]),[v,m]=(0,a.useState)(!!e.triangleCoords),[g,h]=(0,a.useState)(null);e.setMerge(v);(0,a.useEffect)((()=>{h(!0)}),[]);const p=e.triangleCoords.map((e=>({lat:Number(e.lat||"0"),lng:Number(e.lng||"0")})));for(var b=new e.google.maps.LatLngBounds(o),x=0;x<p.length;x++)b.extend(p[x]);return(0,u.jsxs)("div",{className:"map-container",style:{height:500,width:"100%"},children:[(0,u.jsx)("button",{className:"map-button",type:"button",onClick:()=>{navigator.geolocation.getCurrentPosition((function(e){s({lat:e.coords.latitude,lng:e.coords.longitude})}))},children:(0,u.jsx)(t.nDs,{})}),(0,u.jsxs)(n.Map,{options:{minZoom:15,maxZoom:15},cursor:"pointer",onClick:(l,i,n)=>{h(!1);const{latLng:a}=n,t=a.lat(),o=a.lng();v?(d([]),e.settriangleCoords([{lat:t,lng:o}]),s({lat:t,lng:o}),m(!1)):e.settriangleCoords((e=>[...e,{lat:t,lng:o}]))},maxZoom:16,minZoom:2,google:e.google,initialCenter:c,center:o,onReady:function(e,l){l.setOptions({draggableCursor:"crosshair",draggingCursor:"grab"})},bounds:g&&b,className:"clickable",children:[null===(l=e.triangleCoords)||void 0===l?void 0:l.map(((l,i)=>(0,u.jsx)(n.Marker,{onClick:l=>(l=>{var i,n;m(!(null===e||void 0===e||!e.triangleCoords)),(null===(i=e.triangleCoords[0])||void 0===i?void 0:i.lat)===(null===(n=l.position)||void 0===n?void 0:n.lat)&&e.triangleCoords.length>1&&(d(e.triangleCoords),e.setLocation(e.triangleCoords),m(!0),h(!0))})(l),position:l,icon:{url:"https://upload.wikimedia.org/wikipedia/commons/9/94/Circle-image.svg",scaledSize:new e.google.maps.Size(10,10)},className:"marker"},i))),null!==r&&void 0!==r&&r.length?(0,u.jsx)(n.Polygon,{path:e.triangleCoords,strokeColor:"black",strokeOpacity:.8,strokeWeight:3,fillColor:"black",fillOpacity:.35},null===r||void 0===r?void 0:r.length):(0,u.jsx)(n.Polyline,{path:e.triangleCoords,strokeColor:"black",strokeOpacity:.8,strokeWeight:3,fillColor:"black",fillOpacity:.35},null===(i=e.triangleCoords)||void 0===i?void 0:i.length)]})]})}))},89281:(e,l,i)=>{"use strict";i.d(l,{h:()=>d});var n=i(47313),a=i(12279),t=i.n(a),o=i(74294),s=i(72652),r=i(46417);const d=e=>{let{fetchOptions:l,debounceTimeout:i=400,onClear:a,...d}=e;const[u,v]=(0,n.useState)(!1),[c,m]=(0,n.useState)([]),g=(0,n.useMemo)((()=>t()((e=>{m([]),v(!0),l(e).then((e=>{m(e),v(!1)}))}),i)),[l,i]);return(0,r.jsx)(o.Z,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:g,onClear:()=>{g(""),a&&a()},notFoundContent:u?(0,r.jsx)(s.Z,{size:"small"}):"no results",...d,options:c,onFocus:()=>{g("")}})}},307:(e,l,i)=>{"use strict";i.d(l,{Z:()=>t});var n=i(67968),a=i(97421);const t=()=>{var e,l;const{google_map_key:i}=null===(e=n.h.getState())||void 0===e||null===(l=e.globalSettings)||void 0===l?void 0:l.settings;return i||a.kr}},33834:(e,l,i)=>{"use strict";i.d(l,{K:()=>o});var n=i(97890),a=i(74776),t=i.n(a);const o=()=>{const e=(0,n.s0)(),l=(0,n.TH)(),i=t().parse(l.search,{ignoreQueryPrefix:!0});return{values:i,set:(l,n)=>e({search:t().stringify({...i,[l]:n})}),reset:l=>{const n={...i};n[l]&&delete n[l],e({search:t().stringify({...n})})},clear:()=>e({search:t().stringify({})}),merge:l=>e({search:t().stringify({...i,...l})}),get:e=>i[e],setMultiple:l=>{const n={...i,...l};e({search:t().stringify(n)})},resetMultiple:l=>{const n={...i};l.forEach((e=>{n[e]&&delete n[e]})),e({search:t().stringify(n)})}}}},21114:(e,l,i)=>{"use strict";i.r(l),i.d(l,{default:()=>L});var n=i(73591),a=i(77181),t=i(24511),o=i(47313),s=i(33834),r=i(58328),d=i(8550),u=i(2717),v=i(97890),c=i(80314),m=i(90954),g=i(70816),h=i.n(g),p=i(10976),b=i(68197),x=i(59624),y=i(66672),Z=i(16124),j=i(99096),f=i(74294),k=i(86345),C=i(59491),S=i(75868),w=i(79492),I=i(23560),_=i(89281),q=i(4067),M=i(16895),A=i(46417);const N=e=>{var l,i,n,a,s,d,v;let{data:c}=e;const[m]=p.Z.useForm(),{t:g}=(0,t.$)(),{isDemo:N}=(0,w.Z)(),{myShop:O}=(0,u.v9)((e=>e.myShop),u.wU),[P,z]=(0,o.useState)((null===c||void 0===c?void 0:c.avatar)||[]),[F,W]=(0,o.useState)(!1),L={...c,kitchen:null!==c&&void 0!==c&&c.kitchen?{label:null===c||void 0===c||null===(l=c.kitchen)||void 0===l||null===(i=l.translation)||void 0===i?void 0:i.title,value:null===c||void 0===c||null===(n=c.kitchen)||void 0===n?void 0:n.id,key:null===c||void 0===c||null===(a=c.kitchen)||void 0===a?void 0:a.id}:null,table:null!==c&&void 0!==c&&c.table?{label:null===c||void 0===c||null===(s=c.table)||void 0===s?void 0:s.name,value:null===c||void 0===c||null===(d=c.table)||void 0===d?void 0:d.id,key:null===c||void 0===c||null===(v=c.table)||void 0===v?void 0:v.id}:null,isWork:!(null===c||void 0===c||!c.isWork)};return(0,A.jsx)(p.Z,{form:m,layout:"vertical",initialValues:L,onFinish:e=>{var l,i,n,a;const t={images:null!==P&&void 0!==P&&P[0]?[null===P||void 0===P||null===(l=P[0])||void 0===l?void 0:l.name]:void 0,firstname:null===e||void 0===e?void 0:e.firstname,lastname:null===e||void 0===e?void 0:e.lastname,email:N||null===e||void 0===e?void 0:e.email,phone:N||null===e||void 0===e?void 0:e.phone,birthday:null!==e&&void 0!==e&&e.birthday?h()(null===e||void 0===e?void 0:e.birthday).format("YYYY-MM-DD"):void 0,gender:null===e||void 0===e||null===(i=e.gender)||void 0===i?void 0:i.value,role:null===c||void 0===c?void 0:c.role,shop_id:[null===O||void 0===O?void 0:O.id],kitchen_id:"cook"===(null===c||void 0===c?void 0:c.role)?null===e||void 0===e||null===(n=e.kitchen)||void 0===n?void 0:n.value:void 0,table_id:"deliveryman"===(null===c||void 0===c?void 0:c.role)?null===e||void 0===e||null===(a=e.table)||void 0===a?void 0:a.value:void 0,isWork:"waiter"===(null===c||void 0===c?void 0:c.role)?!(null===e||void 0===e||!e.isWork):void 0};W(!0),r.Z.update(null===c||void 0===c?void 0:c.uuid,t).then((()=>{I.Am.success(g("successfully.updated"))})).finally((()=>{W(!1)}))},children:(0,A.jsxs)(b.Z,{gutter:12,children:[(0,A.jsx)(x.Z,{span:24,children:(0,A.jsx)(p.Z.Item,{name:"avatar",label:g("avatar"),rules:[{required:!(null!==P&&void 0!==P&&P.length),message:g("required")}],children:(0,A.jsx)(S.Z,{type:"restaurant/logo",imageList:P,setImageList:z,form:m,multiple:!1,name:"avatar"})})}),(0,A.jsx)(x.Z,{span:12,children:(0,A.jsx)(p.Z.Item,{name:"firstname",label:g("firstname"),rules:[{required:!0,message:g("required")},{type:"string",min:2,max:200,message:g("min.2.max.200.chars")}],children:(0,A.jsx)(y.Z,{})})}),(0,A.jsx)(x.Z,{span:12,children:(0,A.jsx)(p.Z.Item,{name:"lastname",label:g("lastname"),rules:[{required:!0,message:g("required")},{type:"string",min:2,max:200,message:g("min.2.max.200.chars")}],children:(0,A.jsx)(y.Z,{})})}),(0,A.jsx)(x.Z,{span:12,children:(0,A.jsx)(p.Z.Item,{label:g("phone"),name:"phone",rules:[{required:!N,message:g("required")}],children:(0,A.jsx)(Z.Z,{min:0,className:"w-100"})})}),(0,A.jsx)(x.Z,{span:12,children:(0,A.jsx)(p.Z.Item,{label:g("birthday"),name:"birthday",rules:[{required:!0,message:g("required")}],children:(0,A.jsx)(j.Z,{className:"w-100",disabledDate:e=>h()().add(-18,"years")<=e,defaultPickerValue:h()().add(-18,"years")})})}),(0,A.jsx)(x.Z,{span:12,children:(0,A.jsx)(p.Z.Item,{label:g("gender"),name:"gender",rules:[{required:!0,message:g("required")}],children:(0,A.jsx)(f.Z,{options:[{label:g("male"),value:"male",key:"male"},{label:g("female"),value:"female",key:"female"}],labelInValue:!0})})}),(0,A.jsx)(x.Z,{span:12,children:(0,A.jsx)(p.Z.Item,{label:g("email"),name:"email",rules:[{required:!N,message:g("required")},{type:"email",message:g("invalid.email")}],children:(0,A.jsx)(y.Z,{type:"email",disabled:N})})}),"cook"===(null===c||void 0===c?void 0:c.role)&&(0,A.jsx)(x.Z,{span:12,children:(0,A.jsx)(p.Z.Item,{name:"kitchen",label:g("kitchen"),children:(0,A.jsx)(_.h,{fetchOptions:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const l={search:null!==e&&void 0!==e&&e.length?e:void 0,page:1,perPage:20,active:1};return q.Z.getAll(l).then((e=>{var l;return null===e||void 0===e||null===(l=e.data)||void 0===l?void 0:l.map((e=>{var l;return{label:null===e||void 0===e||null===(l=e.translation)||void 0===l?void 0:l.title,value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id}}))}))},placeholder:g("select.kitchen")})})}),"deliveryman"===(null===c||void 0===c?void 0:c.role)&&(0,A.jsx)(x.Z,{span:12,children:(0,A.jsx)(p.Z.Item,{name:"table",label:g("table"),children:(0,A.jsx)(_.h,{fetchOptions:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const l={search:null!==e&&void 0!==e&&e.length?e:void 0,page:1,perPage:20,active:1};return M.Z.getAll(l).then((e=>{var l;return null===e||void 0===e||null===(l=e.data)||void 0===l?void 0:l.map((e=>({label:null===e||void 0===e?void 0:e.name,value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id})))}))},placeholder:g("select.table")})})}),"waiter"===(null===c||void 0===c?void 0:c.role)&&(0,A.jsx)(x.Z,{children:(0,A.jsx)(p.Z.Item,{name:"isWork",label:g("is.work"),valuePropName:"checked",children:(0,A.jsx)(k.Z,{})})}),(0,A.jsx)(x.Z,{span:24,children:(0,A.jsx)(C.Z,{type:"primary",htmlType:"submit",loading:F,children:g("save")})})]})})};var O=i(44207),P=i(68221);const z=e=>{var l,i;let{data:n}=e;const[a]=p.Z.useForm(),{t:s}=(0,t.$)(),d=(0,u.I0)(),{activeMenu:v}=(0,u.v9)((e=>e.menu),u.wU),[c,g]=(0,o.useState)(null!==n&&void 0!==n&&null!==(l=n.delivery_man_delivery_zone)&&void 0!==l&&l.length?null===n||void 0===n||null===(i=n.delivery_man_delivery_zone)||void 0===i?void 0:i.map((e=>({lat:null===e||void 0===e?void 0:e[0],lng:null===e||void 0===e?void 0:e[1]}))):[]),[h,y]=(0,o.useState)(null),[Z,j]=(0,o.useState)(!1);return(0,A.jsxs)(p.Z,{layout:"vertical",form:a,onFinish:()=>{if(null===n||void 0===n||!n.id)return void I.Am.error(s("no.user.id"));if(c.length<3)return void I.Am.warning(s("place.selected.map"));if(!h)return void I.Am.warning(s("place.selected.map"));const e={user_id:null===n||void 0===n?void 0:n.id,address:c.map((e=>({0:e.lat,1:e.lng})))};j(!0),r.Z.createAndUpdateDeliverymanZone(e).then((()=>{d((0,m.xo)(v)),I.Am.success(s("successfully.updated"))})).finally((()=>{j(!1)}))},children:[(0,A.jsxs)(b.Z,{gutter:12,children:[(0,A.jsx)(x.Z,{span:12,children:(0,A.jsx)("img",{src:O,alt:s("map.gif"),style:{object:"contain"}})}),(0,A.jsx)(x.Z,{span:24,children:(0,A.jsx)(P.Z,{triangleCoords:c,settriangleCoords:g,setMerge:y})})]}),(0,A.jsx)(C.Z,{type:"primary",htmlType:"submit",loading:Z,className:"mt-4",children:s("save")})]})},{TabPane:F}=n.Z,W=()=>{const{t:e}=(0,t.$)(),l=(0,s.K)(),i=(0,u.I0)(),{uuid:g}=(0,v.UO)(),{activeMenu:p}=(0,u.v9)((e=>e.menu),u.wU),[b,x]=(0,o.useState)(l.get("tab")||"details"),[y,Z]=(0,o.useState)({}),[j,f]=(0,o.useState)(!1);(0,o.useEffect)((()=>{k()}),[g]),(0,c.Z)((()=>{p.refetch&&k()}),[p.refetch]);const k=()=>{g&&((e=>{f(!0),r.Z.getById(e).then((e=>{var l,i,n,a;const t={...null===e||void 0===e?void 0:e.data,avatar:null!==e&&void 0!==e&&null!==(l=e.data)&&void 0!==l&&l.img?[(0,d.Z)(null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i.img)]:[],birthday:null!==e&&void 0!==e&&null!==(n=e.data)&&void 0!==n&&n.birthday?h()(null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.birthday):null};Z(t)})).finally((()=>{f(!1)}))})(g),i((0,m.A_)(p)))};return(0,A.jsx)(a.Z,{title:e("edit.user"),children:(0,A.jsxs)(n.Z,{activeKey:b,onChange:e=>{x(e),l.set("tab",e)},tabPosition:"left",size:"small",children:[(0,A.jsx)(F,{tab:e("edit.user"),children:(0,A.jsx)(a.Z,{loading:j,children:(0,A.jsx)(N,{data:y})})},"details"),"deliveryman"===(null===y||void 0===y?void 0:y.role)&&(0,A.jsx)(F,{tab:e("deliveryman.zone"),children:(0,A.jsx)(a.Z,{loading:j,children:(0,A.jsx)(z,{data:y})})},"deliverymanzone")]})})},L=()=>(0,A.jsx)(W,{})},44207:(e,l,i)=>{"use strict";e.exports=i.p+"static/media/map.f2e0b3013d676ba09c88.gif"},24654:()=>{}}]);